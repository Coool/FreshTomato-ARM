/***************************************************************************/
/*                     ChangeLog of Apcupsd 3.14.x                         */
/*                                                                         */
/*               Adam Kropelin <adam@kroptech.com>                         */
/*                                                                         */
/*               http://www.apcupsd.com/                                   */
/*               http://sourceforge.net/projects/apcupsd                   */
/***************************************************************************/

------------------------------------------------------------------------
r2376 | adk0212 | 2016-05-04 09:57:08 -0400 (Wed, 04 May 2016) | 2 lines

Add battery constant for SU3000NET (h/t David Harrison <dave.h@softhome.net>)

------------------------------------------------------------------------
r2375 | adk0212 | 2016-05-04 09:51:57 -0400 (Wed, 04 May 2016) | 2 lines

Update build notes to call out need for libusb patch

------------------------------------------------------------------------
r2374 | adk0212 | 2016-05-04 09:46:02 -0400 (Wed, 04 May 2016) | 2 lines

Fix successful interrupt transfers with timeout >= 1 second

------------------------------------------------------------------------
r2373 | adk0212 | 2016-05-03 16:04:58 -0400 (Tue, 03 May 2016) | 2 lines

More efficient handling of long timeouts

------------------------------------------------------------------------
r2372 | adk0212 | 2016-05-03 15:32:46 -0400 (Tue, 03 May 2016) | 3 lines

darwin libusb fixes for supporting timeouts on interrupt transfers
Required for MODBUS/USB reliability

------------------------------------------------------------------------
r2371 | adk0212 | 2016-04-18 16:56:43 -0400 (Mon, 18 Apr 2016) | 2 lines

Remove obsolete apcupsd binaries from /sbin

------------------------------------------------------------------------
r2370 | adk0212 | 2016-04-18 16:43:09 -0400 (Mon, 18 Apr 2016) | 2 lines

Remove temp file

------------------------------------------------------------------------
r2369 | adk0212 | 2016-04-18 16:26:31 -0400 (Mon, 18 Apr 2016) | 2 lines

Regenerate configure script with changes to preprocess additional darwin platform files

------------------------------------------------------------------------
r2368 | adk0212 | 2016-04-18 16:25:33 -0400 (Mon, 18 Apr 2016) | 6 lines

Fixes so Mac OS X builds obey sbindir
- Enables moving apcupsd executables from /sbin to /usr/local/sbin for compatibility with 10.11 System Integrity Protection (aka rootless)
- Autogen apcupsd-start, apcupsd-uninstall, org.apcupsd.apcupsd.plist scripts from configure so they have proper sbindir incorporated instead of hard coded /sbin
- Update darwin Makefile to obey sbindir
- Update darwin build notes to reflect use of --sbindir= argument to configure

------------------------------------------------------------------------
r2367 | adk0212 | 2016-04-18 16:20:27 -0400 (Mon, 18 Apr 2016) | 2 lines

Install signed copy of ApcupsdDummy.kext

------------------------------------------------------------------------
r2366 | adk0212 | 2016-01-29 16:28:07 -0500 (Fri, 29 Jan 2016) | 2 lines

Sign ApcupsdDummy.kext

------------------------------------------------------------------------
r2365 | adk0212 | 2016-01-19 12:28:52 -0500 (Tue, 19 Jan 2016) | 2 lines

Remove use of BSD USB driver; all platforms except Linux use generic-usb now

------------------------------------------------------------------------
r2364 | adk0212 | 2016-01-19 12:03:20 -0500 (Tue, 19 Jan 2016) | 3 lines

Remove use of pthread_setname_np.
Too many variants, not enough value.

------------------------------------------------------------------------
r2363 | adk0212 | 2016-01-19 10:04:37 -0500 (Tue, 19 Jan 2016) | 3 lines

test(1) uses "=" for string equality. "==" is a bashism.
Patch from Patrick Welche <prlw1@cam.ac.uk>

------------------------------------------------------------------------
r2362 | adk0212 | 2015-12-19 16:30:40 -0500 (Sat, 19 Dec 2015) | 3 lines

Fix shutdown failure on Windows when UPSNAME includes spaces
- Quote UPSNAME field when building apccontrol command line

------------------------------------------------------------------------
r2361 | adk0212 | 2015-10-05 18:29:56 -0400 (Mon, 05 Oct 2015) | 2 lines

Update apcupsd.spec for RHEL6 (from David Ranch <dranch@trinnet.net>)

------------------------------------------------------------------------
r2360 | adk0212 | 2015-09-24 16:14:16 -0400 (Thu, 24 Sep 2015) | 2 lines

Add apparent power measurement and nominal values

------------------------------------------------------------------------
r2359 | adk0212 | 2015-09-24 15:58:19 -0400 (Thu, 24 Sep 2015) | 2 lines

Increase resolution of OUTCURNT to 0.01 Amps as suggested by Manfred Schwarb <manfred99@gmx.ch>

------------------------------------------------------------------------
r2358 | adk0212 | 2015-09-21 11:02:18 -0400 (Mon, 21 Sep 2015) | 2 lines

Fixes for ModbusUsbComm::WaitIdle

------------------------------------------------------------------------
r2357 | adk0212 | 2015-09-20 11:01:39 -0400 (Sun, 20 Sep 2015) | 2 lines

Add output current to status display

------------------------------------------------------------------------
r2356 | adk0212 | 2015-09-20 11:01:17 -0400 (Sun, 20 Sep 2015) | 3 lines

Add support for displaying output currnent on MODBUS
- Also rename {REAL,APPARENT}_POWER usages to clarify that they represent percent-of-nominal

------------------------------------------------------------------------
r2355 | adk0212 | 2015-09-20 10:59:32 -0400 (Sun, 20 Sep 2015) | 2 lines

Move eeprom to static data section

------------------------------------------------------------------------
r2354 | adk0212 | 2015-06-24 22:29:14 -0400 (Wed, 24 Jun 2015) | 5 lines

Fix building bsd-usb driver
Correct link order when bsd-usb is enabled.
This was broken when modbus-usb support was added.
Reported by Kirill Bychkov <kirby@linklevel.net>

------------------------------------------------------------------------
r2352 | adk0212 | 2015-05-31 11:55:44 -0400 (Sun, 31 May 2015) | 2 lines

Update ChangeLog

------------------------------------------------------------------------
r2351 | adk0212 | 2015-05-31 11:54:57 -0400 (Sun, 31 May 2015) | 2 lines

Update ReleaseNotes

------------------------------------------------------------------------
r2350 | adk0212 | 2015-05-30 16:56:12 -0400 (Sat, 30 May 2015) | 2 lines

Prep for 3.14.14 release

------------------------------------------------------------------------
r2349 | adk0212 | 2015-05-09 11:33:29 -0400 (Sat, 09 May 2015) | 2 lines

Remove driver subdirs during uninstall

------------------------------------------------------------------------
r2348 | adk0212 | 2015-05-09 11:28:33 -0400 (Sat, 09 May 2015) | 3 lines

Fix missing DLLs when installing only apctray
Reported by keithg@pobox.com

------------------------------------------------------------------------
r2347 | adk0212 | 2015-03-25 15:55:46 -0400 (Wed, 25 Mar 2015) | 2 lines

Add 'svnclean' target to remove all files that show as unversioned in svn

------------------------------------------------------------------------
r2346 | adk0212 | 2015-03-24 23:53:39 -0400 (Tue, 24 Mar 2015) | 3 lines

Remove obsolete NET-SNMP driver
This has been replaced by the snmplite driver for many years now.

------------------------------------------------------------------------
r2345 | adk0212 | 2015-03-22 11:58:02 -0400 (Sun, 22 Mar 2015) | 2 lines

CID107690 Unchecked return value

------------------------------------------------------------------------
r2344 | adk0212 | 2015-03-22 11:51:42 -0400 (Sun, 22 Mar 2015) | 3 lines

CID107691 - Pointer to local outside scope
UPSINFO goes out of scope before use via 'host' pointer

------------------------------------------------------------------------
r2343 | adk0212 | 2015-03-21 23:21:42 -0400 (Sat, 21 Mar 2015) | 2 lines

Set thread names using pthread_setname_np() when available

------------------------------------------------------------------------
r2342 | adk0212 | 2015-03-21 22:06:46 -0400 (Sat, 21 Mar 2015) | 2 lines

Remove obsolete comments, add my copyright

------------------------------------------------------------------------
r2341 | adk0212 | 2015-03-21 22:03:30 -0400 (Sat, 21 Mar 2015) | 3 lines

Remove workaround for old BSD userspace pthreads bug
We have been closing fds after fork() for some time now and we now have CLOEXEC set properly

------------------------------------------------------------------------
r2340 | adk0212 | 2015-03-21 18:43:19 -0400 (Sat, 21 Mar 2015) | 2 lines

Explicitly ignore return value

------------------------------------------------------------------------
r2339 | adk0212 | 2015-03-21 18:30:29 -0400 (Sat, 21 Mar 2015) | 2 lines

Fix some unchecked returns

------------------------------------------------------------------------
r2338 | adk0212 | 2015-03-21 18:19:20 -0400 (Sat, 21 Mar 2015) | 2 lines

Quiet some Coverity errors by explicitly discarding return fgetc() return value

------------------------------------------------------------------------
r2337 | adk0212 | 2015-03-21 17:59:35 -0400 (Sat, 21 Mar 2015) | 2 lines

Improvements to hosts.conf parsing logic

------------------------------------------------------------------------
r2336 | adk0212 | 2015-03-21 11:42:50 -0400 (Sat, 21 Mar 2015) | 3 lines

CID17191 -  Uninitialized scalar field
Not reall a defect as _commlost_time is always set before being used, but initialize it in constructor anyway for cleanliness

------------------------------------------------------------------------
r2335 | adk0212 | 2015-03-21 11:39:46 -0400 (Sat, 21 Mar 2015) | 3 lines

Another shot at fixing CID 107532,107533
Coverity really wants you to check fcntl retval

------------------------------------------------------------------------
r2334 | adk0212 | 2015-03-20 22:26:04 -0400 (Fri, 20 Mar 2015) | 2 lines

CID107533 - Unchecked return value from library

------------------------------------------------------------------------
r2333 | adk0212 | 2015-03-20 21:47:16 -0400 (Fri, 20 Mar 2015) | 2 lines

Mark error_out_wrapper as noreturn to prevent bogus warnings

------------------------------------------------------------------------
r2332 | adk0212 | 2015-03-20 00:05:15 -0400 (Fri, 20 Mar 2015) | 2 lines

A couple more socket cloexec fixes

------------------------------------------------------------------------
r2331 | adk0212 | 2015-03-19 23:59:41 -0400 (Thu, 19 Mar 2015) | 3 lines

Fix open file descriptors leaking to exec'ed children
Use O_CLOEXEC and friends as necessary to ensure we don't leak fds to children across exec

------------------------------------------------------------------------
r2330 | adk0212 | 2015-03-19 23:58:11 -0400 (Thu, 19 Mar 2015) | 2 lines

Icon file for web site

------------------------------------------------------------------------
r2329 | adk0212 | 2015-03-06 14:05:24 -0500 (Fri, 06 Mar 2015) | 4 lines

Fixes for socket error handling 
Resolves apcaccess crash when connection fails as well
as several other theoretical issues.

------------------------------------------------------------------------
r2328 | adk0212 | 2015-02-17 15:18:17 -0500 (Tue, 17 Feb 2015) | 3 lines

Now that we are using the system tcpd.h exclusively, use <tcpd.h> not "tcpd.h" include form.
h/t Manfred Schwarb <manfred99@gmx.ch>

------------------------------------------------------------------------
r2327 | adk0212 | 2015-02-17 08:47:54 -0500 (Tue, 17 Feb 2015) | 3 lines

Stop shipping a hacked copy of tcpd.h and wrap the include of the system header with extern "C" instead.
RedHat's tcpd.h already has __{BEGIN,END}_DECL demarcation but SuSE's (for example) does not.

------------------------------------------------------------------------
r2326 | adk0212 | 2015-02-15 17:02:53 -0500 (Sun, 15 Feb 2015) | 2 lines

Discard unexpected messages when waiting for idle

------------------------------------------------------------------------
r2325 | adk0212 | 2015-02-15 16:59:04 -0500 (Sun, 15 Feb 2015) | 2 lines

Fix hiddev binding when usbfs is mounted on /dev/bus/usb instead of /proc/bus/usb

------------------------------------------------------------------------
r2324 | adk0212 | 2015-02-08 23:35:39 -0500 (Sun, 08 Feb 2015) | 2 lines

Include file/line info in hex_dump output to match Dmsg

------------------------------------------------------------------------
r2323 | adk0212 | 2015-02-08 19:45:45 -0500 (Sun, 08 Feb 2015) | 3 lines

Detect if compiler supports -Wno-unused-result instead of using it blindly
- Also use new AX_ADD_COMPILE_FLAG for -fno-exceptions and -fno-rtti

------------------------------------------------------------------------
r2322 | adk0212 | 2015-02-08 13:00:05 -0500 (Sun, 08 Feb 2015) | 2 lines

Update FSF address

------------------------------------------------------------------------
r2321 | adk0212 | 2015-02-08 12:49:27 -0500 (Sun, 08 Feb 2015) | 4 lines

Update GPLv2 text
- Same license, just minor updates to the text to match current FSF official copy
- Changes include FSF address and removal of '19xx' style year annotations

------------------------------------------------------------------------
r2320 | adk0212 | 2015-02-08 12:42:02 -0500 (Sun, 08 Feb 2015) | 2 lines

Remove unused file

------------------------------------------------------------------------
r2319 | adk0212 | 2015-02-08 12:01:31 -0500 (Sun, 08 Feb 2015) | 3 lines

Remove subsys directory from SuSE lock file location
Reported by Manfred Schwarb <manfred99@gmx.ch>

------------------------------------------------------------------------
r2318 | adk0212 | 2015-02-07 13:26:15 -0500 (Sat, 07 Feb 2015) | 3 lines

Add -Wno-unused-result to suppress "ignoring return value of..." warnings.
Prefer to track these via Coverity instead of inconsistent compile warnings.

------------------------------------------------------------------------
r2317 | adk0212 | 2015-02-06 19:31:18 -0500 (Fri, 06 Feb 2015) | 5 lines

Improve COMMLOST handling for MODBUS, esp. MODBUS/USB
- Fix ModbusUsbComm to handle Open() call when already open
- Fix ModbusUpsDriver to close the Comm class when declaring COMMLOST
- Fail register read/write calls at ModbusComm layer when underlying transport is not open

------------------------------------------------------------------------
r2315 | adk0212 | 2015-02-02 21:27:26 -0500 (Mon, 02 Feb 2015) | 2 lines

Final prep for 3.14.13 release

------------------------------------------------------------------------
r2314 | adk0212 | 2015-02-02 21:16:47 -0500 (Mon, 02 Feb 2015) | 2 lines

Correct some outdated information in the apctest section of the manual

------------------------------------------------------------------------
r2313 | adk0212 | 2015-02-02 20:47:30 -0500 (Mon, 02 Feb 2015) | 2 lines

Detect failure to modify RedHat halt script and display a message instead of failing the whole installation

------------------------------------------------------------------------
r2312 | adk0212 | 2015-01-31 11:38:09 -0500 (Sat, 31 Jan 2015) | 2 lines

Prep for 3.14.13 release

------------------------------------------------------------------------
r2311 | adk0212 | 2015-01-29 09:13:25 -0500 (Thu, 29 Jan 2015) | 5 lines

Place apcupsd lock file in /var/lock instead of /var/lock/subsys on Slackware
Slackware convention is to use /var/lock; /var/lock/subsys appears to be a Red Hat thing
Reported by Sebastian Arcus <s.arcus@open-t.co.uk>
Patch by Jonathan Woithe <jwoithe@atrad.com.au>

------------------------------------------------------------------------
r2310 | adk0212 | 2015-01-20 12:38:53 -0500 (Tue, 20 Jan 2015) | 3 lines

Add notes indicating that apcupsd must be restarted for config file changes to become active.
Although it might be considered "obvious", this wasn't actually written down anywhere that I could find.

------------------------------------------------------------------------
r2309 | adk0212 | 2015-01-20 12:15:04 -0500 (Tue, 20 Jan 2015) | 2 lines

Updated Windows USB driver signature, courtesy of Jernej Simončič <jernej|s@eternallybored.org>

------------------------------------------------------------------------
r2308 | adk0212 | 2015-01-19 21:45:44 -0500 (Mon, 19 Jan 2015) | 2 lines

Add debug to Tx side of modbus USB to match RS232

------------------------------------------------------------------------
r2307 | adk0212 | 2015-01-19 21:02:01 -0500 (Mon, 19 Jan 2015) | 2 lines

Remove unused a{m,re,c}alloc functions

------------------------------------------------------------------------
r2306 | adk0212 | 2015-01-19 20:58:51 -0500 (Mon, 19 Jan 2015) | 2 lines

Remove obsolete UPS list code

------------------------------------------------------------------------
r2305 | adk0212 | 2015-01-19 20:55:56 -0500 (Mon, 19 Jan 2015) | 2 lines

Remove obsolete references to myUPS

------------------------------------------------------------------------
r2304 | adk0212 | 2015-01-19 20:52:18 -0500 (Mon, 19 Jan 2015) | 2 lines

Remove obsolete file

------------------------------------------------------------------------
r2303 | adk0212 | 2015-01-19 20:48:49 -0500 (Mon, 19 Jan 2015) | 2 lines

Remove obsolete prototypes

------------------------------------------------------------------------
r2302 | adk0212 | 2015-01-19 20:38:19 -0500 (Mon, 19 Jan 2015) | 2 lines

Remove obsolete simple signaling cable info

------------------------------------------------------------------------
r2301 | adk0212 | 2015-01-19 19:09:42 -0500 (Mon, 19 Jan 2015) | 2 lines

Bump win32 usb driver date and rev

------------------------------------------------------------------------
r2300 | adk0212 | 2015-01-19 19:04:40 -0500 (Mon, 19 Jan 2015) | 2 lines

Fix typo

------------------------------------------------------------------------
r2299 | adk0212 | 2015-01-19 18:52:30 -0500 (Mon, 19 Jan 2015) | 2 lines

Fix typo

------------------------------------------------------------------------
r2298 | adk0212 | 2015-01-18 15:38:34 -0500 (Sun, 18 Jan 2015) | 2 lines

Add --enable-modbus-usb to Darwin build notes

------------------------------------------------------------------------
r2297 | adk0212 | 2015-01-18 11:41:26 -0500 (Sun, 18 Jan 2015) | 3 lines

Update supported USB VID/PID combinations in code and platform-specific drivers
- Includes several VID/PID tuples for future use as suggested by APC

------------------------------------------------------------------------
r2296 | adk0212 | 2015-01-12 11:56:25 -0500 (Mon, 12 Jan 2015) | 3 lines

Remove ancient unmaintained apcupsd.8 manpage from Debian platform directory.
The current manpage set for apcupsd is in doc/ and should be used by all platforms.

------------------------------------------------------------------------
r2295 | adk0212 | 2015-01-07 22:06:44 -0500 (Wed, 07 Jan 2015) | 2 lines

Fix handling of return value from USBDEVFS_CONNECT

------------------------------------------------------------------------
r2294 | adk0212 | 2015-01-07 21:31:27 -0500 (Wed, 07 Jan 2015) | 2 lines

Add MODBUS/USB info to apcupsd.conf comments

------------------------------------------------------------------------
r2293 | adk0212 | 2015-01-07 21:25:06 -0500 (Wed, 07 Jan 2015) | 2 lines

Add MODBUS USB setting info to apcupsd.conf(5) man page

------------------------------------------------------------------------
r2292 | adk0212 | 2015-01-07 20:54:03 -0500 (Wed, 07 Jan 2015) | 2 lines

Remove ETIMEDOUT workaround; this is no longer an issue

------------------------------------------------------------------------
r2291 | adk0212 | 2015-01-04 19:24:06 -0500 (Sun, 04 Jan 2015) | 2 lines

Update documentation for MODBUS USB.

------------------------------------------------------------------------
r2289 | adk0212 | 2015-01-04 15:41:14 -0500 (Sun, 04 Jan 2015) | 2 lines

Update ChangeLog for 3.14.13-test2

------------------------------------------------------------------------
r2288 | adk0212 | 2015-01-04 15:39:58 -0500 (Sun, 04 Jan 2015) | 2 lines

Bump version to 3.14.13-test2

------------------------------------------------------------------------
r2287 | adk0212 | 2015-01-04 15:35:43 -0500 (Sun, 04 Jan 2015) | 3 lines

Fix link error on BSD systems due to use of --{start,end}-group which only works on GNU ld
Move HidUps.cpp into libusbhid (since it is a wrapper for that library) which resolves dependency issue so we can eliminate use of --{start,end}-group

------------------------------------------------------------------------
r2285 | adk0212 | 2015-01-04 13:14:22 -0500 (Sun, 04 Jan 2015) | 2 lines

Update ChangeLog for 3.14.13-test1

------------------------------------------------------------------------
r2284 | adk0212 | 2015-01-04 13:08:07 -0500 (Sun, 04 Jan 2015) | 2 lines

Bump version for 3.14.13-test1 release

------------------------------------------------------------------------
r2283 | adk0212 | 2015-01-04 13:06:40 -0500 (Sun, 04 Jan 2015) | 4 lines

Fix WriteRegister on MODBUS USB
Response messages need to be treated individually to determine length of live data.
Previously code was assuming READ_HOLDING_REGS format which fails for WRITE_MULTIPLE_REGS.

------------------------------------------------------------------------
r2282 | adk0212 | 2015-01-03 11:26:55 -0500 (Sat, 03 Jan 2015) | 2 lines

Allow cable type of USB for MODBUS driver

------------------------------------------------------------------------
r2281 | adk0212 | 2015-01-03 11:26:33 -0500 (Sat, 03 Jan 2015) | 2 lines

Update file header comment

------------------------------------------------------------------------
r2280 | adk0212 | 2015-01-03 00:07:49 -0500 (Sat, 03 Jan 2015) | 2 lines

Add usb_interrupt_write() to winusb translation layer to support MODBUS USB

------------------------------------------------------------------------
r2279 | adk0212 | 2015-01-03 00:02:51 -0500 (Sat, 03 Jan 2015) | 2 lines

Add MODBUS USB support

------------------------------------------------------------------------
r2278 | adk0212 | 2015-01-03 00:00:58 -0500 (Sat, 03 Jan 2015) | 2 lines

Remove unused _{new,old}tio variables

------------------------------------------------------------------------
r2277 | adk0212 | 2015-01-02 23:59:59 -0500 (Fri, 02 Jan 2015) | 2 lines

Remove hidutils.c as its functionality has been subsumed into HidUps.cpp

------------------------------------------------------------------------
r2276 | adk0212 | 2015-01-02 23:50:36 -0500 (Fri, 02 Jan 2015) | 2 lines

Build drivers into separate libs to eliminate rule duplication in src/driver/Makefile

------------------------------------------------------------------------
r2275 | adk0212 | 2015-01-02 16:34:23 -0500 (Fri, 02 Jan 2015) | 3 lines

Break libusb and libusbhid interfacing code out into HidUps class.
This will allow reuse with MODBUS USB capability.

------------------------------------------------------------------------
r2274 | adk0212 | 2015-01-02 12:12:47 -0500 (Fri, 02 Jan 2015) | 2 lines

Configure support for MODBUS/USB

------------------------------------------------------------------------
r2273 | adk0212 | 2014-12-02 16:10:47 -0500 (Tue, 02 Dec 2014) | 3 lines

CID75626 Uninitialized scalar field
Remove _oldtio and _newtio members, they are not necessary

------------------------------------------------------------------------
r2272 | adk0212 | 2014-12-02 16:06:57 -0500 (Tue, 02 Dec 2014) | 3 lines

CID75625 Unchecked return value from library
Check return value from fcntl(F_GETFL) and explicitly ignore retval from fcntl(F_SETFL)

------------------------------------------------------------------------
r2271 | adk0212 | 2014-12-01 14:38:54 -0500 (Mon, 01 Dec 2014) | 2 lines

Refactor MODBUS RS232 into base and derived class

------------------------------------------------------------------------
r2270 | adk0212 | 2014-11-25 16:33:23 -0500 (Tue, 25 Nov 2014) | 3 lines

Fix apcsmart calibration on win32
Need to poll for UPS commands and keyboard input since win32 select only works with sockets

------------------------------------------------------------------------
r2269 | adk0212 | 2014-11-25 08:17:20 -0500 (Tue, 25 Nov 2014) | 2 lines

Update comment on LOCKFILE directive to resolve confusion over whether it is a FILE as the name would imply, or a DIRECTORY, which is the truth

------------------------------------------------------------------------
r2268 | adk0212 | 2014-11-24 13:25:49 -0500 (Mon, 24 Nov 2014) | 3 lines

Check for setup_device failure and exit with an error instead of continuing on.
Reported by Laurent Blume <laurent@opencsw.org>

------------------------------------------------------------------------
r2267 | adk0212 | 2014-11-12 12:30:33 -0500 (Wed, 12 Nov 2014) | 2 lines

Fix libsupc++fix.cpp filename in configure

------------------------------------------------------------------------
r2266 | adk0212 | 2014-11-06 22:12:59 -0500 (Thu, 06 Nov 2014) | 2 lines

Add missing copyright banners

------------------------------------------------------------------------
r2265 | adk0212 | 2014-11-06 22:00:43 -0500 (Thu, 06 Nov 2014) | 2 lines

Use PTHREAD_MUTEX_INITIALIZER to init mutex

------------------------------------------------------------------------
r2264 | adk0212 | 2014-11-06 21:42:11 -0500 (Thu, 06 Nov 2014) | 2 lines

Bring back compat/pwd.h and move getpwuid() to it

------------------------------------------------------------------------
r2263 | adk0212 | 2014-11-06 21:28:57 -0500 (Thu, 06 Nov 2014) | 2 lines

Remove FREEBSD_SUPCPP_FIX, this file is now compiled only when needed so content can be unconditional

------------------------------------------------------------------------
r2262 | adk0212 | 2014-11-06 17:01:12 -0500 (Thu, 06 Nov 2014) | 2 lines

smtp needs pwd.h

------------------------------------------------------------------------
r2261 | adk0212 | 2014-11-06 16:51:13 -0500 (Thu, 06 Nov 2014) | 2 lines

Only build libsupc++fix.cpp when needed and in the process clean up LIBEXTRAOBJ handling

------------------------------------------------------------------------
r2260 | adk0212 | 2014-11-06 16:34:20 -0500 (Thu, 06 Nov 2014) | 2 lines

Remove unused file

------------------------------------------------------------------------
r2259 | adk0212 | 2014-11-06 16:32:25 -0500 (Thu, 06 Nov 2014) | 2 lines

Rename sleep.c to nanosleep.c since that's what it is

------------------------------------------------------------------------
r2258 | adk0212 | 2014-11-06 16:28:45 -0500 (Thu, 06 Nov 2014) | 2 lines

Remove unused file

------------------------------------------------------------------------
r2257 | adk0212 | 2014-11-06 16:26:32 -0500 (Thu, 06 Nov 2014) | 2 lines

gethostbyname is in winsock2.h on win32, so netdb.h is yet another alias for winsock2.h

------------------------------------------------------------------------
r2256 | adk0212 | 2014-11-06 16:25:54 -0500 (Thu, 06 Nov 2014) | 2 lines

Remove more unused win32/compat headers

------------------------------------------------------------------------
r2255 | adk0212 | 2014-11-06 16:11:50 -0500 (Thu, 06 Nov 2014) | 2 lines

Remove unused compat/features.h

------------------------------------------------------------------------
r2254 | adk0212 | 2014-11-06 16:10:55 -0500 (Thu, 06 Nov 2014) | 2 lines

Remove unused compat/grp.h

------------------------------------------------------------------------
r2253 | adk0212 | 2014-11-06 16:09:19 -0500 (Thu, 06 Nov 2014) | 2 lines

Rename netcompat.c -> inet_aton.c since that's the only thing in it now

------------------------------------------------------------------------
r2252 | adk0212 | 2014-11-06 16:06:50 -0500 (Thu, 06 Nov 2014) | 2 lines

More win32 compat include file cleanup

------------------------------------------------------------------------
r2251 | adk0212 | 2014-11-06 15:50:07 -0500 (Thu, 06 Nov 2014) | 2 lines

Move inet_aton() prototype to arpa/inet.h

------------------------------------------------------------------------
r2250 | adk0212 | 2014-11-06 15:31:45 -0500 (Thu, 06 Nov 2014) | 2 lines

Remove obsolete manually-written config.h for win32 builds

------------------------------------------------------------------------
r2249 | adk0212 | 2014-11-05 10:45:28 -0500 (Wed, 05 Nov 2014) | 2 lines

List libwin32compat.a as a dependency so exes are relinked when it changes

------------------------------------------------------------------------
r2248 | adk0212 | 2014-11-05 10:32:56 -0500 (Wed, 05 Nov 2014) | 2 lines

Remove USBTYPE define; it is not longer used

------------------------------------------------------------------------
r2247 | adk0212 | 2014-11-05 10:28:16 -0500 (Wed, 05 Nov 2014) | 6 lines

Big win32 compat cleanup
- Eliminate unnecessary compat functions
- Split useful functions out into individual files to reduce linking of unnecessary compats
- Move prototypes and defines to proper header files instead of jamming them all in compat.h
- Remove 90% of the includes from compat.h

------------------------------------------------------------------------
r2246 | adk0212 | 2014-11-04 21:06:09 -0500 (Tue, 04 Nov 2014) | 2 lines

Make bind_upses() a no-op if USBDEVFS_CONNECT is not available

------------------------------------------------------------------------
r2245 | adk0212 | 2014-11-04 20:58:45 -0500 (Tue, 04 Nov 2014) | 3 lines

Eliminate use of sprintf in digest2ascii
Code was fine but audits for sprintf keep tripping here so change it

------------------------------------------------------------------------
r2244 | adk0212 | 2014-11-04 20:56:46 -0500 (Tue, 04 Nov 2014) | 3 lines

Rewrite hex_dump to make it clearer that no buffers are being overrun here.
Audits for uses of sprintf and strcpy keep tripping over this code, so give in and change it even though there is no bug.

------------------------------------------------------------------------
r2243 | adk0212 | 2014-11-04 18:49:24 -0500 (Tue, 04 Nov 2014) | 2 lines

Quiet warning from insufficiently clueful compiler

------------------------------------------------------------------------
r2242 | adk0212 | 2014-11-04 18:47:16 -0500 (Tue, 04 Nov 2014) | 2 lines

Braces initializer on struct sigaction is not portable, use memset instead

------------------------------------------------------------------------
r2241 | adk0212 | 2014-11-04 16:54:07 -0500 (Tue, 04 Nov 2014) | 2 lines

Remove executable property from Makefile

------------------------------------------------------------------------
r2240 | adk0212 | 2014-11-04 16:17:53 -0500 (Tue, 04 Nov 2014) | 2 lines

Remove hiddex.txt as this is an obsolete copy from Linux docs

------------------------------------------------------------------------
r2239 | adk0212 | 2014-11-04 16:13:06 -0500 (Tue, 04 Nov 2014) | 2 lines

Exclude gapcmon with --enable-all when cross-building for mingw32

------------------------------------------------------------------------
r2238 | adk0212 | 2014-11-04 16:02:15 -0500 (Tue, 04 Nov 2014) | 2 lines

Fix TOPDIR

------------------------------------------------------------------------
r2237 | adk0212 | 2014-11-04 15:36:35 -0500 (Tue, 04 Nov 2014) | 2 lines

Move build-win32-cross-tools script to platforms/mingw

------------------------------------------------------------------------
r2236 | adk0212 | 2014-11-04 15:35:24 -0500 (Tue, 04 Nov 2014) | 2 lines

Kill off the old win32 Makefile.in ... Yay!

------------------------------------------------------------------------
r2235 | adk0212 | 2014-11-04 15:34:00 -0500 (Tue, 04 Nov 2014) | 2 lines

Remove obsolete readme

------------------------------------------------------------------------
r2234 | adk0212 | 2014-11-04 15:27:08 -0500 (Tue, 04 Nov 2014) | 2 lines

Move win32 install package creation to platforms/mingw similar to how OS X is done and update for new file locations

------------------------------------------------------------------------
r2233 | adk0212 | 2014-11-04 14:34:52 -0500 (Tue, 04 Nov 2014) | 3 lines

Test for dir existence before blindly adding /usr/local paths to {CPP,LD}FLAGS
Darwin LLVM ld complains about non-existent lib directories on the command line

------------------------------------------------------------------------
r2232 | adk0212 | 2014-11-04 14:25:05 -0500 (Tue, 04 Nov 2014) | 2 lines

Rebuild configure to incorporate BG variable for win32 background mode processes

------------------------------------------------------------------------
r2231 | adk0212 | 2014-11-04 14:17:43 -0500 (Tue, 04 Nov 2014) | 6 lines

Ability to build for win32 via normal make system instead of hardcoded src/win32/Makefile.in
Planned to do this many years ago, finally done!
Windows build is enabled via normal autoconf cross-compile "./configure --host=mingw32".
During configure, CROSSTOOLS env var selects location of mingw32 toolchain (built via build-win32-cross-tools script), default is $(topdir)/../cross-tools
Similarly, DEPKGS var points to win32 dependency package directory, default is $(topdir)/../depkgs-win32

------------------------------------------------------------------------
r2230 | adk0212 | 2014-11-04 08:30:37 -0500 (Tue, 04 Nov 2014) | 2 lines

Eliminate apc_config.h by pulling useful pieces into defines.h

------------------------------------------------------------------------
r2229 | adk0212 | 2014-11-04 08:12:56 -0500 (Tue, 04 Nov 2014) | 3 lines

Rename config.h to apcconfig.h since config.h is dangerously vague.
Win32 pthreads, for example, provides a config.h.

------------------------------------------------------------------------
r2228 | adk0212 | 2014-11-04 07:41:35 -0500 (Tue, 04 Nov 2014) | 2 lines

More warning fixes for win32 builds

------------------------------------------------------------------------
r2227 | adk0212 | 2014-11-04 07:19:09 -0500 (Tue, 04 Nov 2014) | 3 lines

CID74720 Uninitialized scalar field
Initialize _fd to INVALID_SOCKET

------------------------------------------------------------------------
r2226 | adk0212 | 2014-11-03 22:26:04 -0500 (Mon, 03 Nov 2014) | 3 lines

Remove unused and buggy strncasecmp() function
Remove unused variable from conv_unix_to_win32_path()

------------------------------------------------------------------------
r2225 | adk0212 | 2014-11-03 22:12:11 -0500 (Mon, 03 Nov 2014) | 2 lines

Fix strict alising issue in apclibnis by implementing FIONBIO ioctl in compat instead of using macro

------------------------------------------------------------------------
r2224 | adk0212 | 2014-11-03 21:44:54 -0500 (Mon, 03 Nov 2014) | 3 lines

Replace use of 'int' as socket type with sock_t, which maps to 'SOCKET' on Windows and 'int' everywhere else.
Also use INVALID_SOCKET instead of -1 for socket failure case. This fixes a bunch of warnings on Windows.

------------------------------------------------------------------------
r2223 | adk0212 | 2014-11-03 21:18:56 -0500 (Mon, 03 Nov 2014) | 3 lines

Fix a few warnings when building for win32
Many more to go...

------------------------------------------------------------------------
r2222 | adk0212 | 2014-11-03 17:35:36 -0500 (Mon, 03 Nov 2014) | 2 lines

Add <stdio.h>

------------------------------------------------------------------------
r2221 | adk0212 | 2014-11-03 17:33:22 -0500 (Mon, 03 Nov 2014) | 2 lines

Change balloonmgr to use alib containers instead of STL

------------------------------------------------------------------------
r2220 | adk0212 | 2014-11-03 09:54:57 -0500 (Mon, 03 Nov 2014) | 2 lines

Remove unnecessary header overrides; mingw versions are fine

------------------------------------------------------------------------
r2219 | adk0212 | 2014-11-03 09:47:55 -0500 (Mon, 03 Nov 2014) | 2 lines

Remove stat replacement; mingw stat seems fine

------------------------------------------------------------------------
r2218 | adk0212 | 2014-11-03 09:32:31 -0500 (Mon, 03 Nov 2014) | 2 lines

Remove manual definition of integer types; mingw provides <stdint.h>

------------------------------------------------------------------------
r2217 | adk0212 | 2014-11-02 21:55:34 -0500 (Sun, 02 Nov 2014) | 2 lines

Remove obsolete SHM_RDONLY define

------------------------------------------------------------------------
r2216 | adk0212 | 2014-11-02 21:54:38 -0500 (Sun, 02 Nov 2014) | 2 lines

Use strlcpy for strftime replacement instead of strncpy

------------------------------------------------------------------------
r2215 | adk0212 | 2014-10-30 10:35:35 -0400 (Thu, 30 Oct 2014) | 2 lines

Disable PCNET TIMELEFT workaround, causing breakage on recent UPSes

------------------------------------------------------------------------
r2214 | adk0212 | 2014-10-28 14:17:23 -0400 (Tue, 28 Oct 2014) | 3 lines

Fix installation on older Mac OS X versions
Apparently the deprecated auth= attribute is needed on these systems

------------------------------------------------------------------------
r2213 | adk0212 | 2014-10-28 13:04:05 -0400 (Tue, 28 Oct 2014) | 2 lines

First pass at application and package signing for Mac OS X

------------------------------------------------------------------------
r2212 | adk0212 | 2014-10-27 18:46:12 -0400 (Mon, 27 Oct 2014) | 2 lines

Update copyright

------------------------------------------------------------------------
r2211 | adk0212 | 2014-10-27 18:24:35 -0400 (Mon, 27 Oct 2014) | 2 lines

Remove file used by old PackageMaker scripts

------------------------------------------------------------------------
r2210 | adk0212 | 2014-10-27 18:22:43 -0400 (Mon, 27 Oct 2014) | 2 lines

Updates for packaging using pkgbuild and productbuild instead of deprecated PackageMaker

------------------------------------------------------------------------
r2209 | adk0212 | 2014-10-27 11:46:19 -0400 (Mon, 27 Oct 2014) | 2 lines

Update Mac OS X build notes for newer dev tools and packages

------------------------------------------------------------------------
r2208 | adk0212 | 2014-10-27 11:37:20 -0400 (Mon, 27 Oct 2014) | 2 lines

Add patch for libusb-0.1.12 on newer Xcode tools

------------------------------------------------------------------------
r2207 | adk0212 | 2014-10-27 10:32:43 -0400 (Mon, 27 Oct 2014) | 2 lines

Remove Growl plist

------------------------------------------------------------------------
r2206 | adk0212 | 2014-10-27 10:23:15 -0400 (Mon, 27 Oct 2014) | 2 lines

Remove Growl references in config window, hide notification enable checkbox when Notification Center is not available

------------------------------------------------------------------------
r2205 | adk0212 | 2014-10-27 09:59:45 -0400 (Mon, 27 Oct 2014) | 6 lines

More validation improvements and code cleanup
Rename BetterNumberFormatter to ActiveNumberFormatter
Split ActiveNumberFormatter out into its own file
Fail validation if any field is blank
Switch input focus to the first blank control to give the user a clue as to why we refused to close the window

------------------------------------------------------------------------
r2204 | adk0212 | 2014-10-26 22:44:24 -0400 (Sun, 26 Oct 2014) | 2 lines

Clean up preferences validation; cell background coloring was not working right on newer systems

------------------------------------------------------------------------
r2203 | adk0212 | 2014-10-26 20:49:59 -0400 (Sun, 26 Oct 2014) | 2 lines

Check in the built NIB file to allow compiling apcagent with older XCode tools

------------------------------------------------------------------------
r2202 | adk0212 | 2014-10-26 18:18:28 -0400 (Sun, 26 Oct 2014) | 3 lines

Fix issue with config 'port' field displaying with thousands separator when built with newer XCode tools
Attach a NSNumberFormatter to the config port cell and set it for no formatting

------------------------------------------------------------------------
r2201 | adk0212 | 2014-10-26 17:15:21 -0400 (Sun, 26 Oct 2014) | 2 lines

Add comments

------------------------------------------------------------------------
r2200 | adk0212 | 2014-10-26 17:12:36 -0400 (Sun, 26 Oct 2014) | 2 lines

NSMenuDelete and NSUserNotificationCenterDelegate did not exist until 10.6 and 10.8, respectively

------------------------------------------------------------------------
r2199 | adk0212 | 2014-10-26 17:06:27 -0400 (Sun, 26 Oct 2014) | 4 lines

First pass at Notification Center support for apcagent
Little rough still, but working
All the ifdefs to allow compiling with pre-10.8 SDKs is annoying

------------------------------------------------------------------------
r2198 | adk0212 | 2014-10-26 15:27:50 -0400 (Sun, 26 Oct 2014) | 3 lines

Fix bug in getLoginItem() which caused crashes on 10.5
url is not written when LSSharedFileListItemResolve fails, need to set it to nil each time

------------------------------------------------------------------------
r2197 | adk0212 | 2014-10-26 15:25:53 -0400 (Sun, 26 Oct 2014) | 2 lines

Use numeric values instead of macros for OS X version checking so that we can successfully build when the SDK predates the version being tested for

------------------------------------------------------------------------
r2196 | adk0212 | 2014-10-24 15:42:48 -0400 (Fri, 24 Oct 2014) | 3 lines

Prefer instantiateWithOwner over instantiateNibWithOwner which was deprecated in 10.8
This makes memory management of the NIB top level object array cleaner

------------------------------------------------------------------------
r2195 | adk0212 | 2014-10-24 13:58:14 -0400 (Fri, 24 Oct 2014) | 2 lines

Prefer LSSharedFileListItemCopyResolvedURL over deprecated LSSharedFileListItemResolve when deployment target allows

------------------------------------------------------------------------
r2194 | adk0212 | 2014-10-23 21:32:38 -0400 (Thu, 23 Oct 2014) | 3 lines

Kill off LoginItemsAE (login item management via Apple Events) in favor of LSSharedFileList API
This is good on 10.5 and higher, so 10.4 support is now formally dropped (and PPC along with it)

------------------------------------------------------------------------
r2193 | adk0212 | 2014-10-22 11:59:06 -0400 (Wed, 22 Oct 2014) | 3 lines

Remove Growl support from apcagent
Will be adding Notification Center support to replace Growl

------------------------------------------------------------------------
r2192 | adk0212 | 2014-10-22 09:28:46 -0400 (Wed, 22 Oct 2014) | 2 lines

CID17181,17182 Argument cannot be negative

------------------------------------------------------------------------
r2191 | adk0212 | 2014-10-21 22:37:29 -0400 (Tue, 21 Oct 2014) | 4 lines

CID17162 Dereference after null check
Only an issue if CI_STATUS were not in the CiInfo table.
But this is unnecessary code anyway, so remove it.

------------------------------------------------------------------------
r2190 | adk0212 | 2014-10-21 22:30:44 -0400 (Tue, 21 Oct 2014) | 3 lines

CID17184 Out-of-bounds access (again)
Another attempt to address this non-issue in a way that makes it clear to Coverity that there is no buffer overrun

------------------------------------------------------------------------
r2189 | adk0212 | 2014-10-21 22:09:20 -0400 (Tue, 21 Oct 2014) | 4 lines

CID74325 Unchecked return value from library
Document why we're setting SO_BROADCAST and why we don't care if it fails.
Cast return to void to indicate that we don't care about return value.

------------------------------------------------------------------------
r2188 | adk0212 | 2014-10-21 16:40:23 -0400 (Tue, 21 Oct 2014) | 2 lines

Remove obsolete POWERFLUTE and POWERLIBS definitions

------------------------------------------------------------------------
r2187 | adk0212 | 2014-10-21 16:29:34 -0400 (Tue, 21 Oct 2014) | 3 lines

Be explicit about invoking compiler with C++ language
Fixes warnings from clang

------------------------------------------------------------------------
r2186 | adk0212 | 2014-10-21 16:22:20 -0400 (Tue, 21 Oct 2014) | 2 lines

Fix forward decl

------------------------------------------------------------------------
r2185 | adk0212 | 2014-10-21 15:10:59 -0400 (Tue, 21 Oct 2014) | 3 lines

Remove StartupItems scripts for OS X
launchd is supported as far back as 10.4, so no reason to keep StartupItems stuff around

------------------------------------------------------------------------
r2184 | adk0212 | 2014-10-21 14:59:18 -0400 (Tue, 21 Oct 2014) | 2 lines

Update Darwin installer welcome text for new email list URL

------------------------------------------------------------------------
r2183 | adk0212 | 2014-10-21 14:44:15 -0400 (Tue, 21 Oct 2014) | 2 lines

Update coverity model to mark error_out_wrapper() as no-return.

------------------------------------------------------------------------
r2182 | adk0212 | 2014-10-21 14:41:44 -0400 (Tue, 21 Oct 2014) | 2 lines

Wrap calls to error_out function pointer in actual function that can be modeled in Coverity as no-return. This should clean up a number of false positives in Coverity.

------------------------------------------------------------------------
r2181 | adk0212 | 2014-10-21 14:32:46 -0400 (Tue, 21 Oct 2014) | 2 lines

Kill off error_exit. It was identical to error_out except didn't have line number and there was only one user (apcconfig). Switch apcconfig over to error_out and remove error_exit.

------------------------------------------------------------------------
r2180 | adk0212 | 2014-10-21 12:09:41 -0400 (Tue, 21 Oct 2014) | 2 lines

Tie OS X launchd setup into install and uninstall

------------------------------------------------------------------------
r2179 | adk0212 | 2014-10-21 11:27:20 -0400 (Tue, 21 Oct 2014) | 3 lines

Add launchd startup files for OS X
Not tied into 'make install' yet but functional if manually installed

------------------------------------------------------------------------
r2178 | adk0212 | 2014-10-21 04:11:51 -0400 (Tue, 21 Oct 2014) | 2 lines

CID17183 Array compared against 0

------------------------------------------------------------------------
r2177 | adk0212 | 2014-10-21 00:10:53 -0400 (Tue, 21 Oct 2014) | 3 lines

Fix apcaccess failure when apcupsd.conf does not supply NISIP.
Reported by David Walser <luigiwalser@yahoo.com>

------------------------------------------------------------------------
r2176 | adk0212 | 2014-10-20 23:58:46 -0400 (Mon, 20 Oct 2014) | 4 lines

Fix errant 'fi' in Mandrake script
Reported by Graeme Gemmill <graeme@gemmill.name>
Patch by David Walser <luigiwalser@yahoo.com>

------------------------------------------------------------------------
r2175 | adk0212 | 2014-10-20 23:40:33 -0400 (Mon, 20 Oct 2014) | 8 lines

Make another attempt to fix startup/shutdown log level issues.
LOG_INFO is the obvious level to use, but as trev@sentry.org pointed out in a fix
a few years back, LOG_INFO is reserved for apcupsd data logging and is not allowed
thru the normal event log (syslog) mechanism. LOG_WARN will make it thru but is
too high a level, especially on Windows. Using LOG_NOTICE should work; it's lower
than WARN (and, importantly, maps to INFORMATION type on Windows) but it is higher
than INFO and therefore will make it thru to syslog.

------------------------------------------------------------------------
r2174 | adk0212 | 2014-10-20 23:13:50 -0400 (Mon, 20 Oct 2014) | 3 lines

Fix log level of apcupsd startup message: should be INFO not WARN
Reported by marvin@cbr125world.com

------------------------------------------------------------------------
r2173 | adk0212 | 2014-10-17 23:14:48 -0400 (Fri, 17 Oct 2014) | 2 lines

Update manual with license info for apcupsd itself as well as libusbhid

------------------------------------------------------------------------
r2172 | adk0212 | 2014-10-17 21:22:05 -0400 (Fri, 17 Oct 2014) | 2 lines

linux/usb/ch9.h does not exist on all distros...let's just define the device descriptor struct ourselves

------------------------------------------------------------------------
r2171 | adk0212 | 2014-10-17 21:06:23 -0400 (Fri, 17 Oct 2014) | 2 lines

Remove unnecessary assignment

------------------------------------------------------------------------
r2170 | adk0212 | 2014-10-17 18:24:18 -0400 (Fri, 17 Oct 2014) | 2 lines

Cleanup

------------------------------------------------------------------------
r2169 | adk0212 | 2014-10-17 18:21:21 -0400 (Fri, 17 Oct 2014) | 2 lines

On Linux, attempt to automatically attach USB UPSes to the kernel usbhid/hiddev driver in case they have been detached from it (typically due to running the apcupsd 'generic' USB driver)

------------------------------------------------------------------------
r2168 | adk0212 | 2014-10-16 22:28:17 -0400 (Thu, 16 Oct 2014) | 2 lines

Fix remaining compiler warnings in hid-ups.c

------------------------------------------------------------------------
r2167 | adk0212 | 2014-10-16 21:56:08 -0400 (Thu, 16 Oct 2014) | 2 lines

Fix the majority of the compiler warning flood in hid-ups.c

------------------------------------------------------------------------
r2166 | adk0212 | 2014-10-16 21:48:17 -0400 (Thu, 16 Oct 2014) | 2 lines

Correct units on PresentStatus usage

------------------------------------------------------------------------
r2165 | adk0212 | 2014-10-16 21:46:45 -0400 (Thu, 16 Oct 2014) | 2 lines

Convert tabs to spaces

------------------------------------------------------------------------
r2164 | adk0212 | 2014-10-16 21:42:13 -0400 (Thu, 16 Oct 2014) | 2 lines

Show logical usage for each field and add the PresentStatus standard usage

------------------------------------------------------------------------
r2163 | adk0212 | 2014-10-16 21:14:58 -0400 (Thu, 16 Oct 2014) | 2 lines

Add MODBUS RTU Tx/Rx usages to hid-ups

------------------------------------------------------------------------
r2162 | adk0212 | 2014-10-15 22:03:28 -0400 (Wed, 15 Oct 2014) | 2 lines

Update AN176

------------------------------------------------------------------------
r2161 | adk0212 | 2014-10-14 17:10:25 -0400 (Tue, 14 Oct 2014) | 3 lines

Add SYSADMIN and APCUPSD_MAIL setting to apccontrol scripts that were missing it
h/t Quick Fox <quickfox@abv.bg>

------------------------------------------------------------------------
r2160 | adk0212 | 2014-10-13 19:42:41 -0400 (Mon, 13 Oct 2014) | 3 lines

Fix possible use of uninitialized data in line[] buffer in handle_client_request()
- Issue reported by Kevin Cernekee <cernekee@gmail.com>

------------------------------------------------------------------------
r2159 | adk0212 | 2014-10-13 19:18:23 -0400 (Mon, 13 Oct 2014) | 3 lines

pktsiz should be unsigned (h/t Kevin Cernekee <cernekee@gmail.com>)
- Same as Kevin's patch plus change sizeof idiom

------------------------------------------------------------------------
r2158 | adk0212 | 2014-05-15 13:39:13 -0400 (Thu, 15 May 2014) | 3 lines

Fix apcaccess on (broken!) systems where -funsigned-char is the default behavior
Reported by Patrick Fallberg <patrick@fallberg.net>

------------------------------------------------------------------------
r2157 | adk0212 | 2014-04-20 16:36:29 -0400 (Sun, 20 Apr 2014) | 2 lines

Populate some additional columns in Windows Programs & Features control panel

------------------------------------------------------------------------
r2156 | adk0212 | 2014-04-20 16:14:52 -0400 (Sun, 20 Apr 2014) | 2 lines

V_UNKNOWN conflicts with win32 headers, as does V_NONE. V_DEFAULT it is, then.

------------------------------------------------------------------------
r2155 | adk0212 | 2014-04-09 18:18:29 -0400 (Wed, 09 Apr 2014) | 2 lines

Remove unused script

------------------------------------------------------------------------
r2154 | adk0212 | 2014-04-09 18:15:34 -0400 (Wed, 09 Apr 2014) | 2 lines

More svn:executable property removals

------------------------------------------------------------------------
r2153 | adk0212 | 2014-04-09 14:25:05 -0400 (Wed, 09 Apr 2014) | 2 lines

Remove a few more unnecessary svn:executable properties

------------------------------------------------------------------------
r2152 | adk0212 | 2014-04-09 14:20:29 -0400 (Wed, 09 Apr 2014) | 3 lines

Remove svn:executable property from many files that have no reason to be executable
Most of these are an artifact of creating new files remotely via samba share

------------------------------------------------------------------------
r2151 | adk0212 | 2014-04-09 14:04:46 -0400 (Wed, 09 Apr 2014) | 3 lines

Add model file for Coverity
Currently models error_out as static analysis can't tell error_out fnptr is plumbed thru to something that does exit(2)

------------------------------------------------------------------------
r2150 | adk0212 | 2014-04-09 13:57:57 -0400 (Wed, 09 Apr 2014) | 2 lines

Use variadic macro for Error_abort

------------------------------------------------------------------------
r2149 | adk0212 | 2014-04-09 12:26:42 -0400 (Wed, 09 Apr 2014) | 5 lines

CID 17184: Out-of-bounds access
Not really...unnecessary bounds check on 'n' is making Coverity believe n could be >= sizeof(buf)
In reality, n is limited to 0 < n < sizeof(buf) due to net_recv(..., sizeof(buf)-1)
Eliminate unnecessary bounds check on 'n'

------------------------------------------------------------------------
r2148 | adk0212 | 2014-04-09 12:18:09 -0400 (Wed, 09 Apr 2014) | 3 lines

CID 17187: String not null terminated
Missed the temp == 0 case

------------------------------------------------------------------------
r2147 | adk0212 | 2014-04-09 12:09:58 -0400 (Wed, 09 Apr 2014) | 4 lines

Filter out bogus ITEMP readings from SNMP
Error is on APC side, we will work around in apcupsd
Reported by Sergey <a_s_y@sama.ru>

------------------------------------------------------------------------
r2146 | adk0212 | 2014-04-06 12:21:40 -0400 (Sun, 06 Apr 2014) | 4 lines

CID 17187: String not null terminated
String was not being NUL terminated in the event of exactly filling the buffer
Rearrange loop to NUL terminate on every iteration and remove unnecessary memset

------------------------------------------------------------------------
r2145 | adk0212 | 2014-04-06 12:13:30 -0400 (Sun, 06 Apr 2014) | 3 lines

CID 17189: Uninitialized scalar variable
Properly initialize all fields of struct sigaction

------------------------------------------------------------------------
r2144 | adk0212 | 2014-04-06 12:10:10 -0400 (Sun, 06 Apr 2014) | 3 lines

CID 17190: Uninitialized scalar variable
Give s_usb_value a constructor to reset fields to sane values

------------------------------------------------------------------------
r2143 | adk0212 | 2014-04-06 11:40:11 -0400 (Sun, 06 Apr 2014) | 3 lines

CID 17198: Double free
Fix clear() and Append() to avoid potential double-free

------------------------------------------------------------------------
r2142 | adk0212 | 2014-04-06 11:32:58 -0400 (Sun, 06 Apr 2014) | 3 lines

CID 17139: Buffer not null terminated
Change strncpy to strlcpy

------------------------------------------------------------------------
r2141 | adk0212 | 2014-04-06 11:20:20 -0400 (Sun, 06 Apr 2014) | 3 lines

CID 17186: Resource leak
Close sockfd when returning early

------------------------------------------------------------------------
r2140 | adk0212 | 2014-04-06 11:07:02 -0400 (Sun, 06 Apr 2014) | 6 lines

CID 17199: Double free (not really)
Coverity thinks we have a double free because it doesn't realize Error_abort never returns
However we can easily rearrange the code to make it clearer (even to a human)
Also there is no reason to exit the process on a soft error; just notify client and close connection
Misc other cleanup in the same function

------------------------------------------------------------------------
r2139 | adk0212 | 2014-04-05 20:18:14 -0400 (Sat, 05 Apr 2014) | 2 lines

Update my email address globally

------------------------------------------------------------------------
r2138 | adk0212 | 2014-04-05 19:00:20 -0400 (Sat, 05 Apr 2014) | 2 lines

Remove ancient Linux kernel hiddev patches

------------------------------------------------------------------------
r2137 | adk0212 | 2014-04-05 18:40:59 -0400 (Sat, 05 Apr 2014) | 2 lines

Remove empty dirs

------------------------------------------------------------------------
r2136 | adk0212 | 2014-04-05 18:14:17 -0400 (Sat, 05 Apr 2014) | 2 lines

Add my copyright to configure.in as I've definitely played with it enough now to justify it

------------------------------------------------------------------------
r2135 | adk0212 | 2014-04-05 18:12:23 -0400 (Sat, 05 Apr 2014) | 2 lines

Remove old todo list

------------------------------------------------------------------------
r2134 | adk0212 | 2014-04-05 15:21:37 -0400 (Sat, 05 Apr 2014) | 2 lines

Remove unused script

------------------------------------------------------------------------
r2133 | adk0212 | 2014-04-05 15:20:12 -0400 (Sat, 05 Apr 2014) | 2 lines

Run autoheader automatically when running autoconf

------------------------------------------------------------------------
r2132 | adk0212 | 2014-04-05 15:19:31 -0400 (Sat, 05 Apr 2014) | 5 lines

Autoconf cleanup
- Add description info to AC_DEFINEs (replaces acconfig.h)
- Regen config.h.in using autoheader
- Misc other cleanup

------------------------------------------------------------------------
r2131 | adk0212 | 2014-04-01 23:44:52 -0400 (Tue, 01 Apr 2014) | 2 lines

Update config.guess, config.sub to latest from git.savannah.gnu.org

------------------------------------------------------------------------
r2130 | adk0212 | 2014-04-01 23:41:40 -0400 (Tue, 01 Apr 2014) | 2 lines

Remove some unused scripts

------------------------------------------------------------------------
r2129 | adk0212 | 2014-03-31 11:47:46 -0400 (Mon, 31 Mar 2014) | 2 lines

Remove old static web site

------------------------------------------------------------------------
r2128 | adk0212 | 2014-03-30 10:55:19 -0400 (Sun, 30 Mar 2014) | 3 lines

Remove debug print of ASN types
This code is pretty thoroughly tested at this point, debug is no longer necessary

------------------------------------------------------------------------
r2124 | adk0212 | 2014-03-28 23:51:10 -0400 (Fri, 28 Mar 2014) | 2 lines

Prep for 3.14.12 release

------------------------------------------------------------------------
r2123 | adk0212 | 2014-03-28 23:36:33 -0400 (Fri, 28 Mar 2014) | 2 lines

Remove reference to CHARGING as possible STATUS output

------------------------------------------------------------------------
r2122 | adk0212 | 2014-03-28 22:51:54 -0400 (Fri, 28 Mar 2014) | 3 lines

Remove value normalization from apcaccess and eliminate -u dependency on -p (again)
apcupsd will no longer zero-pad values so normalization is unnecessary

------------------------------------------------------------------------
r2121 | adk0212 | 2014-03-28 22:51:02 -0400 (Fri, 28 Mar 2014) | 3 lines

Remove field width specifiers to eliminate space- and zero-padding
This makes parsing status output easier for scripts at a very small cost to human readability

------------------------------------------------------------------------
r2120 | adk0212 | 2014-03-28 22:31:45 -0400 (Fri, 28 Mar 2014) | 3 lines

Workaround for UPS firmware bug causing killpower to execute repeatedly in a loop
Thanks to Neil Robinson <neil@nezil.com> for very clearly documenting the issue and running many, many tests to help track down a solution.

------------------------------------------------------------------------
r2119 | adk0212 | 2014-03-28 17:08:28 -0400 (Fri, 28 Mar 2014) | 3 lines

Make apcaccess -u dependent on -p again but with a runtime check to fail if user violates this dependency.
Man page update for the same.

------------------------------------------------------------------------
r2118 | adk0212 | 2014-03-28 16:14:29 -0400 (Fri, 28 Mar 2014) | 3 lines

Update apcaccess man page
From Timothe Litt <litt@acm.org>

------------------------------------------------------------------------
r2117 | adk0212 | 2014-03-28 16:02:05 -0400 (Fri, 28 Mar 2014) | 2 lines

Improve usage info, fix comment

------------------------------------------------------------------------
r2116 | adk0212 | 2014-03-28 15:17:14 -0400 (Fri, 28 Mar 2014) | 2 lines

Use strtok() as strtok_r() on MinGW

------------------------------------------------------------------------
r2115 | adk0212 | 2014-03-28 14:41:26 -0400 (Fri, 28 Mar 2014) | 3 lines

Move leading zero suppression to -p handler instead of -u
Also allow solitary 0 to pass unaffected

------------------------------------------------------------------------
r2114 | adk0212 | 2014-03-28 14:10:59 -0400 (Fri, 28 Mar 2014) | 3 lines

Add support for stripping units off of values
From Timothe Litt <litt@acm.org>, modified a little

------------------------------------------------------------------------
r2113 | adk0212 | 2014-03-28 13:42:07 -0400 (Fri, 28 Mar 2014) | 2 lines

Fix apcupsd.conf NISIP overriding command line -h in apcaccess

------------------------------------------------------------------------
r2112 | adk0212 | 2014-03-28 13:08:29 -0400 (Fri, 28 Mar 2014) | 3 lines

Command line should override config file settings
From Timothe Litt <litt@acm.org>

------------------------------------------------------------------------
r2111 | adk0212 | 2014-03-28 13:04:20 -0400 (Fri, 28 Mar 2014) | 4 lines

Status output "units" cleanup
Eliminate unnecessary text after values where that text is redundant with the field name
Regularize names of units to use same capitalization

------------------------------------------------------------------------
r2110 | adk0212 | 2014-03-27 22:36:41 -0400 (Thu, 27 Mar 2014) | 4 lines

Add support for pattern matching and apcupsd.conf parsing in apcaccess
Also some code cleanup. 
Idea and most of the code courtesty of Timothe Litt <litt@acm.org>

------------------------------------------------------------------------
r2109 | adk0212 | 2014-03-26 19:01:57 -0400 (Wed, 26 Mar 2014) | 2 lines

Firmware rev usages are string indices

------------------------------------------------------------------------
r2108 | adk0212 | 2014-03-24 23:03:25 -0400 (Mon, 24 Mar 2014) | 2 lines

Add usb_release_interface stub now that generic USB driver needs it

------------------------------------------------------------------------
r2107 | adk0212 | 2014-03-24 23:03:00 -0400 (Mon, 24 Mar 2014) | 2 lines

One last astrncpy conversion

------------------------------------------------------------------------
r2106 | adk0212 | 2014-03-24 22:55:41 -0400 (Mon, 24 Mar 2014) | 3 lines

Global replace of atrncat with strlcat
All uses of astrncat were incorrect (passing full buffer size instead of remaining size as limit)

------------------------------------------------------------------------
r2105 | adk0212 | 2014-03-24 22:52:10 -0400 (Mon, 24 Mar 2014) | 3 lines

Global replace of astrcpy with strlcpy
Same behavor (aside from return value) but strlcpy is standardized

------------------------------------------------------------------------
r2104 | adk0212 | 2014-03-24 22:47:47 -0400 (Mon, 24 Mar 2014) | 4 lines

Fix misuse of astrncat in apcstatus by replacing with strlcat
strlcpy/strlcat implemented internally if libc does not provide
Thanks to Timothe Litt <litt@acm.org> for pointing out this long-standing error

------------------------------------------------------------------------
r2103 | adk0212 | 2014-03-22 13:06:22 -0400 (Sat, 22 Mar 2014) | 2 lines

Update udev info in manual with tips from Timothe Litt <litt@acm.org>

------------------------------------------------------------------------
r2102 | adk0212 | 2014-03-22 12:55:26 -0400 (Sat, 22 Mar 2014) | 3 lines

Add UPS name to subject line of event emails and allow one-stop override of SYSADMIN and APCUPSD_MAIL via config file in SCRIPTDIR
Contributed by Timothe Litt <litt@acm.org>

------------------------------------------------------------------------
r2101 | adk0212 | 2014-03-22 12:47:53 -0400 (Sat, 22 Mar 2014) | 4 lines

Fix compiler warning
Implicit narrowing within {} is not allowed in C++11
h/t Timothe Litt <litt@acm.org>

------------------------------------------------------------------------
r2100 | adk0212 | 2014-03-22 12:34:18 -0400 (Sat, 22 Mar 2014) | 3 lines

Remove references to --with-css-dir configure option
This option hasn't existed since 2004

------------------------------------------------------------------------
r2099 | adk0212 | 2014-03-22 12:27:55 -0400 (Sat, 22 Mar 2014) | 3 lines

Fix display of battery level during MODBUS calibration
(h/t Timothe Litt <litt@acm.org> for pointing out the compiler warning that indicated an issue here.)

------------------------------------------------------------------------
r2098 | adk0212 | 2014-03-08 10:57:56 -0500 (Sat, 08 Mar 2014) | 2 lines

Update some URLs (h/t  Ted Mittelstaedt <tedm@mittelstaedt.us>)

------------------------------------------------------------------------
r2097 | adk0212 | 2014-02-26 10:08:09 -0500 (Wed, 26 Feb 2014) | 2 lines

Fix driver program_eeprom() and entry_point() function naming

------------------------------------------------------------------------
r2096 | adk0212 | 2014-02-18 14:36:51 -0500 (Tue, 18 Feb 2014) | 2 lines

Close and re-open serial port during extended COMMLOST in apcsmart driver

------------------------------------------------------------------------
r2095 | adk0212 | 2014-02-17 23:13:43 -0500 (Mon, 17 Feb 2014) | 2 lines

Make COMMLOST_EVENT_GRACE_PERIOD of type time_t to quiet signed/unsigned comparison warnings

------------------------------------------------------------------------
r2094 | adk0212 | 2014-02-16 11:42:59 -0500 (Sun, 16 Feb 2014) | 2 lines

Fix compilation with 10.4 SDK -- NSTableViewDataSource was not a formal protocol until 10.6

------------------------------------------------------------------------
r2093 | adk0212 | 2014-02-16 11:29:26 -0500 (Sun, 16 Feb 2014) | 2 lines

Fix indentation and comment on lastStatus

------------------------------------------------------------------------
r2092 | adk0212 | 2014-02-16 11:28:52 -0500 (Sun, 16 Feb 2014) | 3 lines

Indicate that StatusTableDataSource and EventsTableDataSource adhere to the NSTableViewDataSource protocol
This eliminates compiler warning about incompatible pointers when data source is passed to NSTableView

------------------------------------------------------------------------
r2091 | adk0212 | 2014-02-16 11:08:26 -0500 (Sun, 16 Feb 2014) | 4 lines

Remove definition of bool/true/false for non-C++ environments
Causes warnings in Objective C code since OBJC has bool
Regular C should not be using bool and friends in the first place

------------------------------------------------------------------------
r2090 | adk0212 | 2014-02-15 21:03:01 -0500 (Sat, 15 Feb 2014) | 2 lines

Replace deprecated stringWithCString with stringWithUTF8String

------------------------------------------------------------------------
r2089 | adk0212 | 2014-02-15 19:05:50 -0500 (Sat, 15 Feb 2014) | 3 lines

Remove 'eprominfo' command
Same information is available via 'status' along with a lot more

------------------------------------------------------------------------
r2088 | adk0212 | 2014-02-15 19:04:43 -0500 (Sat, 15 Feb 2014) | 4 lines

Remove 'rawupsinfo' command
This was useful many, many years ago when UPSINFO was a shmem structure
Not so much any more.

------------------------------------------------------------------------
r2087 | adk0212 | 2014-02-15 19:02:20 -0500 (Sat, 15 Feb 2014) | 3 lines

Remove techlogs
- Interesting historical artifacts, but not something we need to keep shipping in every tarball

------------------------------------------------------------------------
r2086 | adk0212 | 2014-02-12 22:46:38 -0500 (Wed, 12 Feb 2014) | 2 lines

Fix use of bool as integer in net driver

------------------------------------------------------------------------
r2085 | adk0212 | 2014-02-12 22:28:00 -0500 (Wed, 12 Feb 2014) | 2 lines

int to bool cleanup in USB drivers

------------------------------------------------------------------------
r2084 | adk0212 | 2014-02-12 11:18:56 -0500 (Wed, 12 Feb 2014) | 2 lines

Add section on NIS network protocol to the manual

------------------------------------------------------------------------
r2083 | adk0212 | 2014-02-10 21:40:00 -0500 (Mon, 10 Feb 2014) | 2 lines

Remove unused MGE VID

------------------------------------------------------------------------
r2082 | adk0212 | 2014-02-10 21:39:42 -0500 (Mon, 10 Feb 2014) | 2 lines

Avoid probing non-APC devices as they may not like it

------------------------------------------------------------------------
r2081 | adk0212 | 2014-02-10 21:25:47 -0500 (Mon, 10 Feb 2014) | 2 lines

Release interface in generic usb driver when probe fails

------------------------------------------------------------------------
r2080 | adk0212 | 2014-02-09 19:25:31 -0500 (Sun, 09 Feb 2014) | 3 lines

Fix spelling of 'exhausted' in apccontrol
Contributed by Paul Keusemann <pkeusem@visi.com>

------------------------------------------------------------------------
r2079 | adk0212 | 2014-02-09 13:00:52 -0500 (Sun, 09 Feb 2014) | 6 lines

Fix issue with service failing to start on Windows during boot with USB UPS
- UPS is not found on USB bus until a little while after service starts up
- Make USB driver Open method return failure instead of exiting the daemon
- Treat Open failure as COMMLOST when starting up
- Normal COMMLOST event is suppressed for 60 seconds to avoid needless log spam when UPS becomes available in short order

------------------------------------------------------------------------
r2078 | adk0212 | 2014-02-09 12:49:06 -0500 (Sun, 09 Feb 2014) | 2 lines

Regen html manual with updated docutils

------------------------------------------------------------------------
r2077 | adk0212 | 2014-02-05 21:35:20 -0500 (Wed, 05 Feb 2014) | 2 lines

Update the link to David Ranch's TrinityOS page

------------------------------------------------------------------------
r2076 | adk0212 | 2014-02-05 12:50:19 -0500 (Wed, 05 Feb 2014) | 2 lines

Fix bogus lock file error when config file error forces early termination

------------------------------------------------------------------------
r2075 | adk0212 | 2014-02-04 22:22:42 -0500 (Tue, 04 Feb 2014) | 2 lines

Fix spelling error in APC app note comment and clarify origin of app notes

------------------------------------------------------------------------
r2074 | adk0212 | 2014-02-04 22:16:42 -0500 (Tue, 04 Feb 2014) | 2 lines

Update MODBUS NOMOUTV mapping for voltages other than 120VAC

------------------------------------------------------------------------
r2073 | adk0212 | 2014-02-04 09:51:54 -0500 (Tue, 04 Feb 2014) | 4 lines

Fix LOADPCT (CI_LOAD) on MODBUS driver
- Missing break on CI_LowBattery case caused us to fall through and overwrite CI_LOAD
- Reported by Sash Ulrich <babyporch@gmail.com>

------------------------------------------------------------------------
r2072 | adk0212 | 2014-02-03 18:30:10 -0500 (Mon, 03 Feb 2014) | 2 lines

Support rst2html in addition to rst2html.py

------------------------------------------------------------------------
r2071 | adk0212 | 2014-02-03 18:28:18 -0500 (Mon, 03 Feb 2014) | 2 lines

Remove net-snmp from enable-all

------------------------------------------------------------------------
r2070 | adk0212 | 2014-02-01 12:53:59 -0500 (Sat, 01 Feb 2014) | 2 lines

Test commit 2

------------------------------------------------------------------------
r2069 | adk0212 | 2014-02-01 12:22:12 -0500 (Sat, 01 Feb 2014) | 2 lines

Test commit

------------------------------------------------------------------------
r2068 | adk0212 | 2014-02-01 12:17:55 -0500 (Sat, 01 Feb 2014) | 3 lines

Fix issue with net driver not reporting MODEL value
Reported by Chris Dallimore <panda@pigstrough.co.uk>

------------------------------------------------------------------------
r2067 | adk0212 | 2014-01-31 20:59:13 -0500 (Fri, 31 Jan 2014) | 2 lines

Fix 3.14.11 info that got clobbered in last update

------------------------------------------------------------------------
r2066 | adk0212 | 2014-01-31 20:25:15 -0500 (Fri, 31 Jan 2014) | 2 lines

Update web site with SVN link

------------------------------------------------------------------------
r2065 | adk0212 | 2014-01-31 11:52:13 -0500 (Fri, 31 Jan 2014) | 2 lines

Update web site with 3.14.11 release info

------------------------------------------------------------------------
r2063 | adk0212 | 2014-01-31 10:45:36 -0500 (Fri, 31 Jan 2014) | 2 lines

Update ChangeLog (again)

------------------------------------------------------------------------
r2062 | adk0212 | 2014-01-31 10:44:48 -0500 (Fri, 31 Jan 2014) | 2 lines

Bump release date

------------------------------------------------------------------------
r2061 | adk0212 | 2014-01-31 10:43:24 -0500 (Fri, 31 Jan 2014) | 2 lines

Update ReleaseNotes for 3.14.11

------------------------------------------------------------------------
r2060 | adk0212 | 2014-01-31 10:33:38 -0500 (Fri, 31 Jan 2014) | 2 lines

Minor update to win32 USB driver installation notes

------------------------------------------------------------------------
r2059 | adk0212 | 2014-01-29 17:58:16 -0500 (Wed, 29 Jan 2014) | 2 lines

Final prep for 3.14.11

------------------------------------------------------------------------
r2058 | adk0212 | 2014-01-29 17:56:36 -0500 (Wed, 29 Jan 2014) | 2 lines

Add apcupsd.cat signature file to USB driver installation

------------------------------------------------------------------------
r2057 | adk0212 | 2014-01-29 17:54:21 -0500 (Wed, 29 Jan 2014) | 2 lines

Commit signed winusb driver courtesy of Jernej Simoncic <jernej's-sflist@eternallybored.org>

------------------------------------------------------------------------
r2056 | adk0212 | 2013-11-20 19:14:12 -0500 (Wed, 20 Nov 2013) | 2 lines

Update ChangeLog for 3.14.11

------------------------------------------------------------------------
r2055 | adk0212 | 2013-11-20 19:13:31 -0500 (Wed, 20 Nov 2013) | 2 lines

Update version info for 3.14.11 release

------------------------------------------------------------------------
r2054 | adk0212 | 2013-11-20 19:12:21 -0500 (Wed, 20 Nov 2013) | 2 lines

Add modbus info to DEVICE section

------------------------------------------------------------------------
r2053 | adk0212 | 2013-11-20 19:08:50 -0500 (Wed, 20 Nov 2013) | 2 lines

Add modbus information to the manual

------------------------------------------------------------------------
r2052 | adk0212 | 2013-11-20 18:28:13 -0500 (Wed, 20 Nov 2013) | 2 lines

Update cached copy of AN176, add AN177, AN178

------------------------------------------------------------------------
r2051 | adk0212 | 2013-11-20 18:21:31 -0500 (Wed, 20 Nov 2013) | 2 lines

Add pointers to relevant APC app notes in modbus driver source files.

------------------------------------------------------------------------
r2050 | adk0212 | 2013-08-19 21:23:12 -0400 (Mon, 19 Aug 2013) | 4 lines

Implement the modbus killpower test in apctest. Comment out the other
modbus tests that are not implemented (due to lack of MODBUS mappings in
the UPS for the relevant controls)

------------------------------------------------------------------------
r2049 | adk0212 | 2013-08-19 21:18:58 -0400 (Mon, 19 Aug 2013) | 3 lines

Add current rev of App Note 176 (June 2013) describing the MODBUS
implementation on APC UPSes

------------------------------------------------------------------------
r2048 | adk0212 | 2013-08-05 10:05:17 -0400 (Mon, 05 Aug 2013) | 2 lines

Initial rev of MODBUS support

------------------------------------------------------------------------
r2047 | adk0212 | 2013-04-18 21:12:46 -0400 (Thu, 18 Apr 2013) | 2 lines

Build fixes for gcc-4.2.4

------------------------------------------------------------------------
r2046 | adk0212 | 2013-04-18 21:12:11 -0400 (Thu, 18 Apr 2013) | 7 lines

Upgrade cross-tools to more recent versions
gcc-4.2.4 (latest version which is easily built on RHEL5 due to gmp and mpfr dependencies)
binutils-2.23.1 (latest)
mingw-3.20 (latest, aside from 3.20-2 which is buggy)
w32api-3.17-2 (latest)
nsis-2.46 (latest, unchanged)

------------------------------------------------------------------------
r2045 | adk0212 | 2013-02-18 19:25:43 -0500 (Mon, 18 Feb 2013) | 2 lines

Add lock file creation to apctest main()

------------------------------------------------------------------------
r2044 | adk0212 | 2013-02-18 19:24:38 -0500 (Mon, 18 Feb 2013) | 2 lines

Fix copy-paste error in main()

------------------------------------------------------------------------
r2043 | adk0212 | 2013-02-18 19:22:08 -0500 (Mon, 18 Feb 2013) | 4 lines

Remove redundant creation of lock file from setup_device(). Lock file was
already being created in main(). Change error message in main() to match
the one we are removing because it is more informative.

------------------------------------------------------------------------
r2042 | adk0212 | 2013-02-18 19:18:17 -0500 (Mon, 18 Feb 2013) | 3 lines

Get rid of UPS setup flag. This was a holdover from back when the UPSINFO
structure was held in sysv shmem.

------------------------------------------------------------------------
r2041 | adk0212 | 2013-02-11 10:21:51 -0500 (Mon, 11 Feb 2013) | 2 lines

Use variadic macros for Dmsg since we pretty much require gcc at this point

------------------------------------------------------------------------
r2040 | adk0212 | 2012-08-19 22:29:28 -0400 (Sun, 19 Aug 2012) | 3 lines

If SNMP trap catching cannot be enabled, log a warning and fall back to
polling instead of crashing.

------------------------------------------------------------------------
r2039 | adk0212 | 2012-08-19 22:07:12 -0400 (Sun, 19 Aug 2012) | 2 lines

Revert notch/spike LASTXFER change; UPS reporting is too ambiguous.

------------------------------------------------------------------------
r2038 | adk0212 | 2012-08-17 15:53:45 -0400 (Fri, 17 Aug 2012) | 2 lines

Add info about disabling INF signature enforcement in Windows 8

------------------------------------------------------------------------
r2037 | adk0212 | 2012-08-10 13:40:01 -0400 (Fri, 10 Aug 2012) | 2 lines

Recategorize notch/spike related LASTXFER values appropriately.

------------------------------------------------------------------------
r2036 | adk0212 | 2012-06-18 21:47:08 -0400 (Mon, 18 Jun 2012) | 2 lines

Make MIB (vendor) name search case insensitive in snmplite driver

------------------------------------------------------------------------
r2035 | adk0212 | 2012-03-30 23:48:58 -0400 (Fri, 30 Mar 2012) | 2 lines

Rename known_info -> _known_info

------------------------------------------------------------------------
r2034 | adk0212 | 2012-03-30 23:40:59 -0400 (Fri, 30 Mar 2012) | 2 lines

Convert BSD USB driver to UpsDriver derivative

------------------------------------------------------------------------
r2033 | adk0212 | 2012-03-30 19:47:08 -0400 (Fri, 30 Mar 2012) | 2 lines

Convert drivers to C++ classes derived from UpsDriver

------------------------------------------------------------------------
r2032 | adk0212 | 2012-03-26 20:48:22 -0400 (Mon, 26 Mar 2012) | 2 lines

Break out of getline() if read() returns an error

------------------------------------------------------------------------
r2031 | adk0212 | 2012-03-06 12:04:27 -0500 (Tue, 06 Mar 2012) | 2 lines

Fix PCNET runtime remaining on Smart-UPS X and RT models.

------------------------------------------------------------------------
r2030 | adk0212 | 2012-03-04 22:40:40 -0500 (Sun, 04 Mar 2012) | 2 lines

Add missing debug for REG2

------------------------------------------------------------------------
r2029 | adk0212 | 2012-01-26 21:23:44 -0500 (Thu, 26 Jan 2012) | 4 lines

Apply some Mandrake patches, thanks to David Walser <luigiwalser@yahoo.com>
- http://svn.mandriva.com/svn/packages/cooker/apcupsd/current/SOURCES/apcupsd-3.10.16-staleusb.patch
- http://svn.mandriva.com/svn/packages/cooker/apcupsd/current/SOURCES/apcupsd-3.14.4-mdv_conf.diff

------------------------------------------------------------------------
r2028 | adk0212 | 2011-12-09 10:23:33 -0500 (Fri, 09 Dec 2011) | 2 lines

Fix missing DATATIME report info for SNMPLITE_UPS

------------------------------------------------------------------------
r2027 | adk0212 | 2011-12-09 10:20:08 -0500 (Fri, 09 Dec 2011) | 3 lines

Fix missing DATATIME report info for PCNET UPSes. Contributed by
Dan Swartzendruber <dswartz@druber.com>.

------------------------------------------------------------------------
r2026 | adk0212 | 2011-11-21 22:05:26 -0500 (Mon, 21 Nov 2011) | 2 lines

Fix quoting around AC_LANG_PROGRAM to eliminate warning with autoconf-2.68

------------------------------------------------------------------------
r2025 | adk0212 | 2011-11-21 22:03:53 -0500 (Mon, 21 Nov 2011) | 4 lines

Fix failure to compile when libsupc++ is not available. Need to link using
g++ when not linking libsupc++. If linking with libsupc++ use gcc to avoid
gettting libstdc++ linked by default. Fixes build on stock Mandriva 2011.

------------------------------------------------------------------------
r2024 | adk0212 | 2011-11-21 21:23:39 -0500 (Mon, 21 Nov 2011) | 2 lines

Remove set-but-unused variables pointed out by g++-4.6.1

------------------------------------------------------------------------
r2023 | adk0212 | 2011-11-21 13:23:53 -0500 (Mon, 21 Nov 2011) | 3 lines

Fix smartups configuration example. "UPSTYPE smartups" should be
"UPSTYPE apcsmart". Reported by Moray Henderson <moray.henderson@om.org>

------------------------------------------------------------------------
r2022 | adk0212 | 2011-11-10 08:06:36 -0500 (Thu, 10 Nov 2011) | 5 lines

Fix ability to detect SNMP GET failures by adding a 'valid' flag to data
variables. Flag is defaulted to false when a GET is performed and set to
true when valid data is assigned to the variable. This allows the caller
to know if any of the OIDs did not fetch successfully.

------------------------------------------------------------------------
r2021 | adk0212 | 2011-11-09 22:58:51 -0500 (Wed, 09 Nov 2011) | 3 lines

Tighten restriction to screen out bad CI_NOMBATTV. Add check for invalid
CI_BADBATTS.

------------------------------------------------------------------------
r2020 | adk0212 | 2011-11-09 15:12:01 -0500 (Wed, 09 Nov 2011) | 3 lines

Fix handling of UPS calibration by adding a dedicated state for when UPS
is performing calibration.

------------------------------------------------------------------------
r2019 | adk0212 | 2011-11-09 15:10:49 -0500 (Wed, 09 Nov 2011) | 3 lines

Fix self test detection in snmplite driver by implementing
snmplite_ups_entry_point() and adding support for DEVICE_CMD_CHECK_SELFTEST

------------------------------------------------------------------------
r2018 | adk0212 | 2011-11-09 15:08:55 -0500 (Wed, 09 Nov 2011) | 2 lines

Add missing debug print for C_WHY_BATT

------------------------------------------------------------------------
r2017 | adk0212 | 2011-11-07 22:02:51 -0500 (Mon, 07 Nov 2011) | 4 lines

Fix crash when snmplite_ups_open() fails due to SnmpEngine::Open() failure.
We need to exit directly rather than returning failure code since caller
stupidly ignores the return code and will blindly continue on.

------------------------------------------------------------------------
r2016 | adk0212 | 2011-11-07 21:58:59 -0500 (Mon, 07 Nov 2011) | 2 lines

Fix socket leaks on SnmpEngine::Open() failure paths

------------------------------------------------------------------------
r2015 | adk0212 | 2011-11-07 21:57:48 -0500 (Mon, 07 Nov 2011) | 2 lines

Remove NLS textdomain call since NLS has been removed long ago.

------------------------------------------------------------------------
r2014 | adk0212 | 2011-11-07 21:36:20 -0500 (Mon, 07 Nov 2011) | 4 lines

Strip unprintable characters from UPS model string. Pointed out by Peter
Henn <peter_henn@gmx.de> in the PCNET driver. Fix applied globally since
this issue could affect any driver.

------------------------------------------------------------------------
r2013 | adk0212 | 2011-11-07 21:23:19 -0500 (Mon, 07 Nov 2011) | 3 lines

Fix compatibility with mdoc(7) on OpenBSDD. From Ingo Schwarze
<schwarze@openbsd.org> via Kirill Bychkov <yason@linklevel.net>.

------------------------------------------------------------------------
r2012 | adk0212 | 2011-10-14 23:41:07 -0400 (Fri, 14 Oct 2011) | 2 lines

Add VID/PID for HP T1500 G3 UPS which is a rebadged APC unit

------------------------------------------------------------------------
r2011 | adk0212 | 2011-10-12 09:00:15 -0400 (Wed, 12 Oct 2011) | 6 lines

Remove vendor check from BSD and Generic USB drivers. HP OEMed some UPSes
from APC so they are compatible with apcupsd in spite of carrying an HP
vendor id. We might as well try to talk to anything a user connects. We
will still fail if the required UPS application collection is not found
and that is a better indicator of potential compatiblity.

------------------------------------------------------------------------
r2010 | fleetworks | 2011-10-02 09:51:45 -0400 (Sun, 02 Oct 2011) | 2 lines

Release 3.14.10

------------------------------------------------------------------------
r2009 | adk0212 | 2011-09-27 23:33:21 -0400 (Tue, 27 Sep 2011) | 3 lines

Fix compile issue with newer net-snmp on CentOS 6. 'MIB' is apparently a
macro now, so need to avoid using it.

------------------------------------------------------------------------
r2008 | adk0212 | 2011-09-26 08:56:08 -0400 (Mon, 26 Sep 2011) | 5 lines

Filter out SNMP query results that have zero-length sequences. This
prevents a crash in the event that the SNMP request times out, as it
appears to do very occasionally on certain hardware. Thanks to Lars Tauber
<taeuber@bbaw.de> for reporting the issue and testing the fix.

------------------------------------------------------------------------
r2007 | adk0212 | 2011-09-22 18:22:41 -0400 (Thu, 22 Sep 2011) | 2 lines

Add list of UPSes to avoid

------------------------------------------------------------------------
r2006 | adk0212 | 2011-09-15 22:16:14 -0400 (Thu, 15 Sep 2011) | 2 lines

Fix MODEL reporting

------------------------------------------------------------------------
r2005 | adk0212 | 2011-09-13 22:57:16 -0400 (Tue, 13 Sep 2011) | 2 lines

Update home page for 3.14.10 release

------------------------------------------------------------------------
r2003 | adk0212 | 2011-09-13 22:34:31 -0400 (Tue, 13 Sep 2011) | 2 lines

Prep for 3.14.10 release

------------------------------------------------------------------------
r2002 | adk0212 | 2011-09-02 15:17:13 -0400 (Fri, 02 Sep 2011) | 5 lines

Add PID 5 for SMX750 (at least that's what mine uses). Also change
com.apple.kernel.iokit to com.apple.kpi.iokit in OS X plist as suggested
in an apple dev list posting. It's unclear this does anything but it might
help resolve issues with the kext not being selected on certain systems.

------------------------------------------------------------------------
r2001 | adk0212 | 2011-09-02 11:44:41 -0400 (Fri, 02 Sep 2011) | 2 lines

Report proper error numbers, not just -1.

------------------------------------------------------------------------
r2000 | adk0212 | 2011-09-02 11:44:14 -0400 (Fri, 02 Sep 2011) | 7 lines

Switch USB drivers to prefer FEATURE reports over INPUT reports. This
fixes issues with a number of newer UPS models where they advertise INPUT
reports but fail to send them when you query for them. Also check report
length when processing an interrupt report and ignore it if the length is
wrong. This fixes an issue where some UPSes sporadically send truncated
interrupt reports.

------------------------------------------------------------------------
r1999 | adk0212 | 2011-08-12 19:01:38 -0400 (Fri, 12 Aug 2011) | 6 lines

Ignore transitions to battery because of calibration. This can happen if
user initiates calibration in apctest, then exits apctest and starts
apcupsd before the calibration has completed. In this case we do not want
to shut down the machine, so treat onbattery+cal as not on battery at all.
Reported by Sergey <a_s_y@sama.ru>.

------------------------------------------------------------------------
r1998 | adk0212 | 2011-08-05 16:31:40 -0400 (Fri, 05 Aug 2011) | 3 lines

Use astrncpy instead of strncpy to avoid leaving strings without NUL
termination in the overflow case

------------------------------------------------------------------------
r1997 | adk0212 | 2011-08-05 16:30:37 -0400 (Fri, 05 Aug 2011) | 3 lines

Enlarge upsmodel buffer to handle longer model strings. Needed for
"Smart-UPS RT 5000 XL" as reported by Sergey <a_s_y@sama.ru>

------------------------------------------------------------------------
r1996 | adk0212 | 2011-08-05 16:29:21 -0400 (Fri, 05 Aug 2011) | 2 lines

Add missing function prototype

------------------------------------------------------------------------
r1995 | adk0212 | 2011-08-05 16:15:29 -0400 (Fri, 05 Aug 2011) | 2 lines

Regen manual for 3.14.9 release

------------------------------------------------------------------------
r1994 | adk0212 | 2011-08-05 16:14:29 -0400 (Fri, 05 Aug 2011) | 6 lines

Fix MODEL vs. APCMODEL confusion
Remove APCMODEL, rename old MODEL aka mode to DRIVER. Update apcsmart
driver to put model string into upsmodel field. Remove PCNET workaround
for CI_UPSMODEL that is no longer needed. Change USB driver to leave
mode field alone.

------------------------------------------------------------------------
r1993 | adk0212 | 2011-08-04 19:19:32 -0400 (Thu, 04 Aug 2011) | 2 lines

Add link to OS X binary for 3.14.9 now that it's been released

------------------------------------------------------------------------
r1992 | adk0212 | 2011-08-04 19:17:38 -0400 (Thu, 04 Aug 2011) | 3 lines

Work around PackageMaker bug that causes apcagent.app to be relocated at
install time in spite of --no-relocate flag

------------------------------------------------------------------------
r1991 | adk0212 | 2011-07-22 23:41:40 -0400 (Fri, 22 Jul 2011) | 2 lines

Update web site for 3.14.9 release

------------------------------------------------------------------------
r1989 | adk0212 | 2011-07-22 12:27:54 -0400 (Fri, 22 Jul 2011) | 2 lines

Prep for 3.14.9 release

------------------------------------------------------------------------
r1988 | adk0212 | 2011-05-19 18:55:25 -0400 (Thu, 19 May 2011) | 2 lines

Add support for changing PCNET port in apcupsd.conf

------------------------------------------------------------------------
r1987 | adk0212 | 2011-05-15 19:07:31 -0400 (Sun, 15 May 2011) | 2 lines

Add PIDs for AP9620 LCC

------------------------------------------------------------------------
r1986 | adk0212 | 2011-05-15 19:04:29 -0400 (Sun, 15 May 2011) | 2 lines

Fix community probing, misc cleanup

------------------------------------------------------------------------
r1985 | adk0212 | 2011-01-06 10:24:43 -0500 (Thu, 06 Jan 2011) | 2 lines

Fix download links on web site; sf.net change the page format again so dl.php no longer works

------------------------------------------------------------------------
r1984 | adk0212 | 2010-09-17 08:44:51 -0400 (Fri, 17 Sep 2010) | 6 lines

Change back so we no longer wait for threads to exit. This is necessary
because pthread_cancel on OS X does not interrupt blocking calls, even
those defined as cancellation points by SuSv3. Argh. Someday we need to
fix apcupsd thread shutdown correctly, but for now this is no worse than
before.

------------------------------------------------------------------------
r1983 | adk0212 | 2010-09-10 10:50:12 -0400 (Fri, 10 Sep 2010) | 7 lines

Rework signal handling to eliminate crashes and hangs. Old signal handler
was doing many things wrong: calling unsafe functions in signal context,
freeing memory before ensuring users were gone, invoking functions that
lock the UPSINFO mutex resulting in deadlock if it's already locked, etc.
FIx all this by using a signal handling thread waiting on sigwait() in
place of raw handler.

------------------------------------------------------------------------
r1982 | adk0212 | 2010-09-10 08:32:19 -0400 (Fri, 10 Sep 2010) | 2 lines

Use "iter->" instead of "(*iter)."

------------------------------------------------------------------------
r1981 | adk0212 | 2010-09-10 08:30:53 -0400 (Fri, 10 Sep 2010) | 3 lines

Update MGE MIB handler for SNMP sequence support.
Contributed by Lars Taeuber <taeuber@bbaw.de>

------------------------------------------------------------------------
r1980 | adk0212 | 2010-09-09 09:40:51 -0400 (Thu, 09 Sep 2010) | 3 lines

Fix shutdown command when utility power has been restored. Contributed
by Michal Soltys <soltys@ziu.info>

------------------------------------------------------------------------
r1979 | adk0212 | 2010-09-09 09:17:13 -0400 (Thu, 09 Sep 2010) | 3 lines

Prevent apctest from locking up on UPSes that do not respond (at all) to
the 'a' command. Contributed by Michal Soltys <soltys@ziu.info>

------------------------------------------------------------------------
r1978 | adk0212 | 2010-09-09 09:12:49 -0400 (Thu, 09 Sep 2010) | 2 lines

Remove remaining NLS artifacts

------------------------------------------------------------------------
r1977 | adk0212 | 2010-09-08 19:25:07 -0400 (Wed, 08 Sep 2010) | 4 lines

Remove obsolete mode types and simplify cable vs. mode disambiguation
logic. UPSTYPE wins. UPSCABLE is only used for dumb driver. Remove a bit
of screwy BackUPS Pro and v/s logic that is long obsolete.

------------------------------------------------------------------------
r1976 | adk0212 | 2010-09-08 19:23:34 -0400 (Wed, 08 Sep 2010) | 2 lines

Minor update to K command

------------------------------------------------------------------------
r1975 | adk0212 | 2010-09-08 15:06:21 -0400 (Wed, 08 Sep 2010) | 3 lines

Average LOADPCT across all lines rather than summing them since mfgrs
appear to not be adhering to the spec very closely.

------------------------------------------------------------------------
r1974 | adk0212 | 2010-09-08 14:44:30 -0400 (Wed, 08 Sep 2010) | 2 lines

Use GETNEXT instead of GET so OIDs no longer need trailing zero.

------------------------------------------------------------------------
r1973 | adk0212 | 2010-09-07 11:35:13 -0400 (Tue, 07 Sep 2010) | 3 lines

Add support for fetching SNMP table columns as sequences and use it in
RFC1628 MIB support.

------------------------------------------------------------------------
r1972 | adk0212 | 2010-09-03 16:36:08 -0400 (Fri, 03 Sep 2010) | 2 lines

Fix misformatted path due to missing back-tick

------------------------------------------------------------------------
r1971 | adk0212 | 2010-09-03 16:33:59 -0400 (Fri, 03 Sep 2010) | 2 lines

Update manual for Ed Dondlinger's Windows email scripts

------------------------------------------------------------------------
r1970 | adk0212 | 2010-09-03 16:18:58 -0400 (Fri, 03 Sep 2010) | 2 lines

More updates for new winusb driver

------------------------------------------------------------------------
r1969 | adk0212 | 2010-09-03 16:13:41 -0400 (Fri, 03 Sep 2010) | 3 lines

Update supported OSes list...USB on x86_64 Windows is now supported. USB on
Win98/ME/2000 is no longer supported.

------------------------------------------------------------------------
r1968 | adk0212 | 2010-09-03 14:41:46 -0400 (Fri, 03 Sep 2010) | 2 lines

Fix snmplite build on win32 by adding missing mge-mib

------------------------------------------------------------------------
r1967 | adk0212 | 2010-09-03 14:40:59 -0400 (Fri, 03 Sep 2010) | 3 lines

Add Windows email scripts and include them in win32 installs as examples
Contributed by Ed Dondlinger <edondlinger@thepylegroup.com>

------------------------------------------------------------------------
r1966 | adk0212 | 2010-09-02 15:31:39 -0400 (Thu, 02 Sep 2010) | 2 lines

Reorder cases so they are in numerical order

------------------------------------------------------------------------
r1965 | adk0212 | 2010-09-02 15:29:34 -0400 (Thu, 02 Sep 2010) | 2 lines

Add missing break

------------------------------------------------------------------------
r1964 | adk0212 | 2010-09-02 15:26:35 -0400 (Thu, 02 Sep 2010) | 2 lines

Minor correction to low battery logic: Depleted also counts as low.

------------------------------------------------------------------------
r1963 | adk0212 | 2010-09-02 15:05:41 -0400 (Thu, 02 Sep 2010) | 2 lines

Missed a couple with table workaround

------------------------------------------------------------------------
r1962 | adk0212 | 2010-09-02 14:51:53 -0400 (Thu, 02 Sep 2010) | 3 lines

Workaround for line in and line out data on RFC MIB. Blindly use first
index in table.

------------------------------------------------------------------------
r1961 | adk0212 | 2010-09-02 10:23:39 -0400 (Thu, 02 Sep 2010) | 3 lines

docutils appears to no longer include a rst2html wrapper for rst2html.py.
Update configure accordingly.

------------------------------------------------------------------------
r1960 | adk0212 | 2010-09-02 10:22:26 -0400 (Thu, 02 Sep 2010) | 2 lines

Enable generation of footnotes at the bottom of the page in rst2pdf.

------------------------------------------------------------------------
r1959 | adk0212 | 2010-09-02 09:26:12 -0400 (Thu, 02 Sep 2010) | 2 lines

Update SNMP section

------------------------------------------------------------------------
r1958 | adk0212 | 2010-09-02 08:27:35 -0400 (Thu, 02 Sep 2010) | 2 lines

Add community probing

------------------------------------------------------------------------
r1957 | adk0212 | 2010-09-01 13:14:04 -0400 (Wed, 01 Sep 2010) | 3 lines

Screen out LTRANS, HTRANS, NOMOUTV, NOMINV, NOMPOWER which are reading zero
via an RFC1628 Generex CS121 on a Newave Conceptpower DPA UPS.

------------------------------------------------------------------------
r1956 | adk0212 | 2010-09-01 08:41:27 -0400 (Wed, 01 Sep 2010) | 4 lines

Fix compile error on newer glibc. Passing a const for the first argument
of strstr() causes the return value to be const. This is Correct (TM) but
annoying in this case. So just cast away the constness of the first arg.

------------------------------------------------------------------------
r1955 | adk0212 | 2010-08-31 19:17:33 -0400 (Tue, 31 Aug 2010) | 3 lines

Remove unnecessary checks for NULL oid. Verify returned data type matches
expectation.

------------------------------------------------------------------------
r1954 | adk0212 | 2010-08-31 14:57:44 -0400 (Tue, 31 Aug 2010) | 3 lines

Remove strategy-specific probe hook. We don't need it now and probably will
never need it.

------------------------------------------------------------------------
r1953 | adk0212 | 2010-08-31 14:06:44 -0400 (Tue, 31 Aug 2010) | 4 lines

Add support for MIB autodetection by probing for CI_STATUS OID. Also
rework NOTRAP handling to not require a special notrap MibStrategy for
each MIB.

------------------------------------------------------------------------
r1952 | adk0212 | 2010-08-30 14:41:04 -0400 (Mon, 30 Aug 2010) | 3 lines

Allow user to omit one or more subsections of SNMP DEVICE string.
Contributed by Lars Täer <taeuber@bbaw.de>

------------------------------------------------------------------------
r1951 | adk0212 | 2010-08-30 14:18:47 -0400 (Mon, 30 Aug 2010) | 2 lines

Fix typo. Contributed by Lars Täer <taeuber@bbaw.de>

------------------------------------------------------------------------
r1950 | adk0212 | 2010-08-30 14:18:23 -0400 (Mon, 30 Aug 2010) | 2 lines

Add support for MGE SNMP MIB. Contributed by Lars Täer <taeuber@bbaw.de>

------------------------------------------------------------------------
r1949 | adk0212 | 2010-08-20 20:34:48 -0400 (Fri, 20 Aug 2010) | 2 lines

Add SU1000INET battery constant

------------------------------------------------------------------------
r1947 | adk0212 | 2010-08-17 14:24:15 -0400 (Tue, 17 Aug 2010) | 2 lines

Update for 3.14.9-test1 release

------------------------------------------------------------------------
r1946 | adk0212 | 2010-08-16 19:18:35 -0400 (Mon, 16 Aug 2010) | 2 lines

Default to winusb driver

------------------------------------------------------------------------
r1945 | adk0212 | 2010-08-16 19:15:28 -0400 (Mon, 16 Aug 2010) | 2 lines

Update for new files in snmplite

------------------------------------------------------------------------
r1944 | adk0212 | 2010-08-13 14:52:15 -0400 (Fri, 13 Aug 2010) | 3 lines

Take another guess at RFC1628 killpower/shutdown based on TrippLite's
interpretation of upsAutoRestart.

------------------------------------------------------------------------
r1943 | adk0212 | 2010-08-13 14:40:37 -0400 (Fri, 13 Aug 2010) | 3 lines

Attempt to implement shutdown/killpower for RFC1628 SNMP MIB. MIB docs are
somewhat unclear so this is a best guess.

------------------------------------------------------------------------
r1942 | adk0212 | 2010-08-13 14:03:28 -0400 (Fri, 13 Aug 2010) | 2 lines

Add missing file.

------------------------------------------------------------------------
r1941 | adk0212 | 2010-08-13 14:00:15 -0400 (Fri, 13 Aug 2010) | 4 lines

Reorganize multiple MIB support. Vendor names are now associated with MIB
strategies directly. killpower and shutdown operations are deferred to the
strategy as is trap waiting. Other general cleanup.

------------------------------------------------------------------------
r1940 | adk0212 | 2010-07-30 18:04:13 -0400 (Fri, 30 Jul 2010) | 4 lines

Add support for RFC1628 SNMP MIB. Refactor APC MIB and create MibStrategy
struct for associating MIB/CI mapping with corresponding processing
function. RFC1628 strategy is coded per the MIB but untested.

------------------------------------------------------------------------
r1939 | adk0212 | 2010-07-10 11:32:53 -0400 (Sat, 10 Jul 2010) | 2 lines

Update Windows *.inf files for LCC PIDs

------------------------------------------------------------------------
r1938 | adk0212 | 2010-05-16 18:11:39 -0400 (Sun, 16 May 2010) | 2 lines

Remove unused variable shm_OK

------------------------------------------------------------------------
r1937 | adk0212 | 2010-05-16 18:09:43 -0400 (Sun, 16 May 2010) | 4 lines

When logging events, convert LOG_CRIT to a WARNING on Win32 rather than an
ERROR since apcupsd uses it for power events which aren't really daemon
errors. LOG_ERR is still converted to ERROR for use in true error cases.

------------------------------------------------------------------------
r1936 | adk0212 | 2010-05-16 17:57:34 -0400 (Sun, 16 May 2010) | 6 lines

Fix bug where pid file was overwritten even when lock file indicates
another instance is running. Now we only write the pid file after writing
the lock file successfully. Also automatically remove pid file on
termination if we created it in the first place. Reported by Justin Killen
<jkillen@allamericanasphalt.com>

------------------------------------------------------------------------
r1935 | adk0212 | 2010-04-29 19:25:25 -0400 (Thu, 29 Apr 2010) | 3 lines

When running uninstaller in silent mode, always remove config and events
files without prompting. Reported by Zdenek Jirous <jirous@tmv.cz>

------------------------------------------------------------------------
r1934 | adk0212 | 2010-04-29 19:20:04 -0400 (Thu, 29 Apr 2010) | 3 lines

Honor INSTDIR specified on command line via /D.
Reported by Zdenek Jirous <jirous@tmv.cz>

------------------------------------------------------------------------
r1933 | adk0212 | 2010-02-20 10:09:23 -0500 (Sat, 20 Feb 2010) | 8 lines

Variable largebuf may be overflowed by the buf data, which can cause
overwriting of subsequent variables.
I: Statement might be overflowing a buffer in strncat. Common mistake:
   BAD: strncat(buffer,charptr,sizeof(buffer)) is wrong, it takes the left over size as 3rd argument
   GOOD: strncat(buffer,charptr,sizeof(buffer)-strlen(buffer)-1)
E: apcupsd bufferoverflowstrncat reports.c:110
Reported by Stanislav Brabec <sbrabec@suse.cz>

------------------------------------------------------------------------
r1932 | adk0212 | 2010-01-31 12:16:18 -0500 (Sun, 31 Jan 2010) | 2 lines

Update SmartUPS protocol register 2 bit 5. This is supported on SmartUPSes.

------------------------------------------------------------------------
r1931 | adk0212 | 2010-01-31 11:10:59 -0500 (Sun, 31 Jan 2010) | 5 lines

Add missing handling for DALARM. Also PWSUM is a LOGICAL collection, not a
PYSICAL collection, so add support for checking LOGICAL collection and
update known_info table appropriately. This fixes BATTV and MANDATE on
certain newer APC models.

------------------------------------------------------------------------
r1930 | adk0212 | 2010-01-24 08:19:37 -0500 (Sun, 24 Jan 2010) | 2 lines

Remove unnecessary debug print

------------------------------------------------------------------------
r1929 | adk0212 | 2010-01-17 19:12:02 -0500 (Sun, 17 Jan 2010) | 5 lines

When using generic-usb driver, interpret DEVICE setting as the serial
number of the UPS to monitor. This allows the user to control which UPS is
monitored if more than one is connected. A blank DEVICE setting continues
to mean autodetect.

------------------------------------------------------------------------
r1928 | adk0212 | 2010-01-17 13:58:32 -0500 (Sun, 17 Jan 2010) | 2 lines

Fix define

------------------------------------------------------------------------
r1927 | adk0212 | 2010-01-17 13:38:10 -0500 (Sun, 17 Jan 2010) | 3 lines

Add workaround for FreeBSD libsupc++.a issue (FreeBSD PR #99702)
This will allow snmplite driver to compile/link on FreeBSD 5.x

------------------------------------------------------------------------
r1926 | adk0212 | 2010-01-17 10:58:34 -0500 (Sun, 17 Jan 2010) | 3 lines

Force use of generic_usb on FreeBSD 8.0 and higher. FreeBSD USB API was
changed in 8.0, so from now on we will use libusb.

------------------------------------------------------------------------
r1925 | adk0212 | 2010-01-17 10:38:43 -0500 (Sun, 17 Jan 2010) | 2 lines

Fix compile warning

------------------------------------------------------------------------
r1924 | adk0212 | 2010-01-17 10:30:05 -0500 (Sun, 17 Jan 2010) | 2 lines

Fix comment

------------------------------------------------------------------------
r1923 | adk0212 | 2010-01-17 10:29:20 -0500 (Sun, 17 Jan 2010) | 3 lines

If libusb-config is not found, fall back on a plain old AC_CHECK_LIB. This
will allow building against the new libusb-1.x with compatibility API.

------------------------------------------------------------------------
r1922 | adk0212 | 2010-01-17 10:26:47 -0500 (Sun, 17 Jan 2010) | 2 lines

Regen manual for release

------------------------------------------------------------------------
r1921 | adk0212 | 2010-01-16 15:17:05 -0500 (Sat, 16 Jan 2010) | 2 lines

Update for 3.14.8 release

------------------------------------------------------------------------
r1919 | adk0212 | 2010-01-16 11:09:47 -0500 (Sat, 16 Jan 2010) | 2 lines

Prep for 3.14.8 release

------------------------------------------------------------------------
r1918 | adk0212 | 2010-01-16 11:01:38 -0500 (Sat, 16 Jan 2010) | 2 lines

Update apctest manpage for USB changes

------------------------------------------------------------------------
r1917 | adk0212 | 2010-01-16 10:19:20 -0500 (Sat, 16 Jan 2010) | 2 lines

Move winusb coinstallers to depkgs-win32 so they do not bloat the source tree.

------------------------------------------------------------------------
r1916 | adk0212 | 2010-01-12 18:08:18 -0500 (Tue, 12 Jan 2010) | 3 lines

Fix compiler warnings. Also remove whitespace at the end of lines.
Contributed by Andy O'Shaughnessy <andrewjoshaughnessy@gmail.com>

------------------------------------------------------------------------
r1915 | adk0212 | 2010-01-10 16:50:56 -0500 (Sun, 10 Jan 2010) | 2 lines

Remove apcagent application in darwin uninstall script

------------------------------------------------------------------------
r1914 | adk0212 | 2010-01-10 16:45:45 -0500 (Sun, 10 Jan 2010) | 2 lines

spec updates for new SNMP driver

------------------------------------------------------------------------
r1913 | adk0212 | 2010-01-10 16:44:59 -0500 (Sun, 10 Jan 2010) | 2 lines

Minor style changes

------------------------------------------------------------------------
r1912 | adk0212 | 2010-01-10 16:31:02 -0500 (Sun, 10 Jan 2010) | 2 lines

Minor updates for SNMP. Also add gapcmon and apcagent configure options.

------------------------------------------------------------------------
r1911 | adk0212 | 2010-01-10 15:32:21 -0500 (Sun, 10 Jan 2010) | 3 lines

Fix bug that caused key/value columns to become mismatched if a row was
removed from the list.

------------------------------------------------------------------------
r1910 | adk0212 | 2010-01-10 15:14:13 -0500 (Sun, 10 Jan 2010) | 3 lines

Increase SNMP query timeout to prevent false failures when UPS is being
hit by two SNMP clients at once.

------------------------------------------------------------------------
r1909 | adk0212 | 2010-01-10 15:05:34 -0500 (Sun, 10 Jan 2010) | 3 lines

Fix up SNMP driver selection. Config file "snmp" selects snmplite, while
old driver remains available as 'netsnmp'. Same for ./configure script.

------------------------------------------------------------------------
r1908 | adk0212 | 2010-01-10 15:02:40 -0500 (Sun, 10 Jan 2010) | 2 lines

Fix DALARM (depends on alarm timer setting from upsAdvConfigAlarmTimer)

------------------------------------------------------------------------
r1907 | adk0212 | 2010-01-10 15:00:46 -0500 (Sun, 10 Jan 2010) | 2 lines

Improve warning message for USB driver install failure

------------------------------------------------------------------------
r1906 | adk0212 | 2010-01-10 12:59:48 -0500 (Sun, 10 Jan 2010) | 3 lines

Add a troubleshooting section describing that the common cause of failure
with "Error Code 10" is that the driver was installed on the wrong device.

------------------------------------------------------------------------
r1905 | adk0212 | 2010-01-10 12:58:33 -0500 (Sun, 10 Jan 2010) | 2 lines

Add a driver version to assist with upgrading.

------------------------------------------------------------------------
r1904 | adk0212 | 2010-01-10 10:39:02 -0500 (Sun, 10 Jan 2010) | 3 lines

Consolidate get/set USB options. Since all 'set' operations allow you to
bail out without changing anything, they also serve as 'get'.

------------------------------------------------------------------------
r1903 | adk0212 | 2010-01-10 10:29:00 -0500 (Sun, 10 Jan 2010) | 4 lines

Add apctest support for reading/setting self-test interval on USB. Also
show current setting in UPS status. Contributed by James Belleau
<jpbelleau@gmail.com>

------------------------------------------------------------------------
r1902 | adk0212 | 2010-01-10 10:02:13 -0500 (Sun, 10 Jan 2010) | 3 lines

Use 'Q' to exit menus instead of the last number which is always changing.
Contributed by James Belleau <jpbelleau@gmail.com>

------------------------------------------------------------------------
r1901 | adk0212 | 2010-01-09 13:35:16 -0500 (Sat, 09 Jan 2010) | 4 lines

Consolidate win-usb driver back into generic-usb by writing a simple libusb
API adapter for winusb (libusb-winusb-bridge). This eliminates the code
duplication between win-usb and generic-usb.

------------------------------------------------------------------------
r1900 | adk0212 | 2010-01-08 19:23:27 -0500 (Fri, 08 Jan 2010) | 5 lines

Update detail text while waiting for apps to exit so user knows why we're
sitting here for a few seconds. Also skip apctray exit wait if we've
installed the main apcupsd package since that means we've already ensured
apctray is not running.

------------------------------------------------------------------------
r1899 | adk0212 | 2010-01-08 19:11:28 -0500 (Fri, 08 Jan 2010) | 2 lines

Update installer to automatically install WinUSB driver when possible.

------------------------------------------------------------------------
r1898 | adk0212 | 2010-01-03 20:51:54 -0500 (Sun, 03 Jan 2010) | 4 lines

Win2k3 has an extra icon in shell32.dll which throws off the numbering
causing the manpages to have the wrong icon. Just use the same icon for
manpages and user manual.

------------------------------------------------------------------------
r1897 | adk0212 | 2010-01-03 20:19:56 -0500 (Sun, 03 Jan 2010) | 3 lines

Set icons for start menu shortcuts. For now, just use common icons from
shell32.dll.

------------------------------------------------------------------------
r1896 | adk0212 | 2010-01-03 17:02:23 -0500 (Sun, 03 Jan 2010) | 2 lines

Include driver install instructions text file

------------------------------------------------------------------------
r1895 | adk0212 | 2010-01-03 17:01:19 -0500 (Sun, 03 Jan 2010) | 2 lines

Cleanup INF naming, class, etc.

------------------------------------------------------------------------
r1894 | adk0212 | 2010-01-03 17:00:53 -0500 (Sun, 03 Jan 2010) | 2 lines

Initial rev of winusb driver install instructions.

------------------------------------------------------------------------
r1893 | adk0212 | 2010-01-03 13:08:26 -0500 (Sun, 03 Jan 2010) | 3 lines

Update VERSION munging for resource script to accomodate version strings
with a -foo extension.

------------------------------------------------------------------------
r1892 | adk0212 | 2010-01-03 12:46:49 -0500 (Sun, 03 Jan 2010) | 2 lines

Fix build order so libusb.h is created before it is needed.

------------------------------------------------------------------------
r1891 | adk0212 | 2010-01-03 12:33:41 -0500 (Sun, 03 Jan 2010) | 3 lines

Add support for building and installing WinUSB. Default remains as
generic-usb. To build for WinUSB set USBTYPE=winusb.

------------------------------------------------------------------------
r1890 | adk0212 | 2010-01-03 12:32:26 -0500 (Sun, 03 Jan 2010) | 3 lines

Move StrReplace to its own file. Remove unused version functions now that
we're using the built-in WinVer.nsh.

------------------------------------------------------------------------
r1889 | adk0212 | 2010-01-03 12:27:54 -0500 (Sun, 03 Jan 2010) | 2 lines

Enable building the NSIS System plugin.

------------------------------------------------------------------------
r1888 | adk0212 | 2010-01-03 10:29:16 -0500 (Sun, 03 Jan 2010) | 3 lines

WinUsb-based INF file customized for APCUPSD and driver coinstallers from
Win7 DDK.

------------------------------------------------------------------------
r1887 | adk0212 | 2010-01-03 10:22:22 -0500 (Sun, 03 Jan 2010) | 3 lines

First rev of Windows-specific USB driver based on Microsoft's WinUsb
framework for user mode USB drivers.

------------------------------------------------------------------------
r1886 | adk0212 | 2010-01-02 16:28:28 -0500 (Sat, 02 Jan 2010) | 2 lines

Revert previous change: Locks are already held by snmp.c wrapper funcs.

------------------------------------------------------------------------
r1885 | adk0212 | 2010-01-02 14:58:00 -0500 (Sat, 02 Jan 2010) | 3 lines

Remove old non-txt files so they do not get stuck around after an
install-in-place.

------------------------------------------------------------------------
r1884 | adk0212 | 2010-01-02 14:50:14 -0500 (Sat, 02 Jan 2010) | 7 lines

Convert win32 config and doc files to DOS line endings so they can be
viewed and edited in notepad. This is necessary because the workaround of
using write.exe for UNIX format files does not work well on Win7 due to it
using wide margins that unpleasantly word-wraps all the text. Use a *.txt
extension on filenames where possible and use default 'open' behavior so
if user has configured an alternate editor for *.txt it will be used.

------------------------------------------------------------------------
r1883 | adk0212 | 2010-01-02 14:47:43 -0500 (Sat, 02 Jan 2010) | 2 lines

Update to nsis-2.46 and w32api-3.14

------------------------------------------------------------------------
r1882 | adk0212 | 2010-01-02 13:42:07 -0500 (Sat, 02 Jan 2010) | 5 lines

Update installer to use /kill switch to shutdown apps again. This will
provide more reliable shutdowns, especially on Vista/Win7 where apcupsd
service is running in another session and therefore is inaccessible by the
window message mechanism. Remove old window message based shutdown logic.

------------------------------------------------------------------------
r1881 | adk0212 | 2010-01-01 12:02:06 -0500 (Fri, 01 Jan 2010) | 2 lines

Add support for APC_NOTRAP vendor which disabled trap catching.

------------------------------------------------------------------------
r1880 | adk0212 | 2010-01-01 11:41:36 -0500 (Fri, 01 Jan 2010) | 3 lines

Hold the write lock while updating UPSINFO state variables. This is
necessary to prevent NIS clients from seeing partially-updated state.

------------------------------------------------------------------------
r1879 | adk0212 | 2010-01-01 11:16:50 -0500 (Fri, 01 Jan 2010) | 2 lines

Remove cygwin platform. This has been unused for years.

------------------------------------------------------------------------
r1878 | adk0212 | 2010-01-01 11:13:39 -0500 (Fri, 01 Jan 2010) | 3 lines

Only do popups on Win95/98/ME/NT. Newer OSes will run apctray which shows
events in a balloon notification.

------------------------------------------------------------------------
r1877 | adk0212 | 2010-01-01 11:12:16 -0500 (Fri, 01 Jan 2010) | 2 lines

Bring back /kill support. Registry change detection no longer needed.

------------------------------------------------------------------------
r1876 | adk0212 | 2010-01-01 11:11:37 -0500 (Fri, 01 Jan 2010) | 2 lines

Remove conditionals; always display a popup.

------------------------------------------------------------------------
r1875 | adk0212 | 2009-11-21 12:34:10 -0500 (Sat, 21 Nov 2009) | 2 lines

Center date field now that sf.net is not reporting time info.

------------------------------------------------------------------------
r1874 | adk0212 | 2009-11-21 12:32:06 -0500 (Sat, 21 Nov 2009) | 5 lines

Fix issue with displaying DMG .sig info for 3.14.7 source code link.
Something at the top of the source is messing up the regexp, but can't
figure out exactly what. So just chop off the top of the page completely.
We only want the data in the All Files section anyway.

------------------------------------------------------------------------
r1873 | adk0212 | 2009-11-15 12:57:00 -0500 (Sun, 15 Nov 2009) | 2 lines

Remove obsolete image files.

------------------------------------------------------------------------
r1872 | adk0212 | 2009-11-15 10:05:42 -0500 (Sun, 15 Nov 2009) | 2 lines

Update for change in sf.net HTML (data format changed)

------------------------------------------------------------------------
r1871 | adk0212 | 2009-11-15 09:18:43 -0500 (Sun, 15 Nov 2009) | 5 lines

Add support for reading battery voltage from the PowerSummary instead of
the Battery physical usage. At least one Back-UPS model appears to place
its battery readout there instead of the normal place.
Back-UPS 500 FW: 6.3.I USB FW: c1

------------------------------------------------------------------------
r1870 | adk0212 | 2009-11-09 21:19:23 -0500 (Mon, 09 Nov 2009) | 2 lines

Fix timezone on Windows. This has always been wrong.

------------------------------------------------------------------------
r1869 | adk0212 | 2009-11-09 21:05:14 -0500 (Mon, 09 Nov 2009) | 2 lines

Switch time/date output format to simplified ISO "YYYY-MM-DD HH:MM:SS +/-UTC"

------------------------------------------------------------------------
r1868 | adk0212 | 2009-11-09 21:03:40 -0500 (Mon, 09 Nov 2009) | 2 lines

Fix compile error.

------------------------------------------------------------------------
r1867 | adk0212 | 2009-10-31 11:32:53 -0400 (Sat, 31 Oct 2009) | 2 lines

Sync alib with gelogger project

------------------------------------------------------------------------
r1866 | adk0212 | 2009-10-31 10:04:32 -0400 (Sat, 31 Oct 2009) | 2 lines

Fix compile warning

------------------------------------------------------------------------
r1865 | adk0212 | 2009-10-31 09:31:42 -0400 (Sat, 31 Oct 2009) | 2 lines

Move INADDR_NONE define to common header

------------------------------------------------------------------------
r1864 | adk0212 | 2009-10-31 09:28:57 -0400 (Sat, 31 Oct 2009) | 2 lines

Fix signed/unsigned comparison warning

------------------------------------------------------------------------
r1863 | adk0212 | 2009-10-31 09:24:31 -0400 (Sat, 31 Oct 2009) | 2 lines

Fix compile error on Solaris 10

------------------------------------------------------------------------
r1862 | adk0212 | 2009-10-31 08:55:17 -0400 (Sat, 31 Oct 2009) | 2 lines

win32 build fixes

------------------------------------------------------------------------
r1861 | adk0212 | 2009-10-31 08:42:17 -0400 (Sat, 31 Oct 2009) | 2 lines

Fix comment

------------------------------------------------------------------------
r1860 | adk0212 | 2009-10-31 08:37:32 -0400 (Sat, 31 Oct 2009) | 2 lines

Switch libnis to thread-safe gethostname_re()

------------------------------------------------------------------------
r1859 | adk0212 | 2009-10-27 20:31:12 -0400 (Tue, 27 Oct 2009) | 2 lines

Updates so win32 will build with gethostbyname_r

------------------------------------------------------------------------
r1858 | adk0212 | 2009-10-27 20:24:29 -0400 (Tue, 27 Oct 2009) | 2 lines

Switch SnmpEngine to thread-safe resolver, gethostbyname_r()

------------------------------------------------------------------------
r1857 | adk0212 | 2009-10-27 19:28:48 -0400 (Tue, 27 Oct 2009) | 2 lines

Misc cleanup

------------------------------------------------------------------------
r1856 | adk0212 | 2009-10-27 19:19:41 -0400 (Tue, 27 Oct 2009) | 2 lines

Make lengths universally unsigned

------------------------------------------------------------------------
r1855 | adk0212 | 2009-10-27 19:11:40 -0400 (Tue, 27 Oct 2009) | 5 lines

Add ability to calculate marshalled size of each data type without actually
marshalling the data. This allows Sequence to precalculate its size which
in turn allows us to encode length fields in the minimum possible number of
octets instead of always using 4. This reduces packet size substantially.

------------------------------------------------------------------------
r1854 | adk0212 | 2009-10-26 19:37:27 -0400 (Mon, 26 Oct 2009) | 2 lines

Definitions for APC UPS traps. Not used yet, but may be handy someday.

------------------------------------------------------------------------
r1853 | adk0212 | 2009-10-26 19:36:52 -0400 (Mon, 26 Oct 2009) | 2 lines

Spacing changes

------------------------------------------------------------------------
r1852 | adk0212 | 2009-10-26 19:36:31 -0400 (Mon, 26 Oct 2009) | 2 lines

Add support for SNMP trap catching

------------------------------------------------------------------------
r1851 | adk0212 | 2009-10-25 21:30:59 -0400 (Sun, 25 Oct 2009) | 2 lines

Toy with spacing

------------------------------------------------------------------------
r1850 | adk0212 | 2009-10-25 21:07:50 -0400 (Sun, 25 Oct 2009) | 2 lines

Add snmplite support for shutdown and killpower

------------------------------------------------------------------------
r1849 | adk0212 | 2009-10-25 21:07:08 -0400 (Sun, 25 Oct 2009) | 2 lines

Add SET command support to SnmpEngine and support classes

------------------------------------------------------------------------
r1848 | adk0212 | 2009-10-25 18:00:04 -0400 (Sun, 25 Oct 2009) | 2 lines

Update comments

------------------------------------------------------------------------
r1847 | adk0212 | 2009-10-25 17:48:13 -0400 (Sun, 25 Oct 2009) | 2 lines

Add units to ambient humidity and temp status lines

------------------------------------------------------------------------
r1846 | adk0212 | 2009-10-25 17:45:39 -0400 (Sun, 25 Oct 2009) | 4 lines

Remove sanity filter on ambient temp and humidity readings. These both read
zero if your MeasureUPS probe is not connected, so we don't want to exclude
them in that case.

------------------------------------------------------------------------
r1845 | adk0212 | 2009-10-25 17:37:04 -0400 (Sun, 25 Oct 2009) | 2 lines

Add support for detecting and recovering from network errors

------------------------------------------------------------------------
r1844 | adk0212 | 2009-10-25 16:47:43 -0400 (Sun, 25 Oct 2009) | 2 lines

Misc cleanup

------------------------------------------------------------------------
r1843 | adk0212 | 2009-10-25 16:31:08 -0400 (Sun, 25 Oct 2009) | 2 lines

Bump version string

------------------------------------------------------------------------
r1842 | adk0212 | 2009-10-25 15:56:37 -0400 (Sun, 25 Oct 2009) | 2 lines

Reorder function

------------------------------------------------------------------------
r1841 | adk0212 | 2009-10-25 15:53:57 -0400 (Sun, 25 Oct 2009) | 3 lines

Spit OID arrays out into their own file so they're not cluttering mib.cpp.
Also wrap gcc-specific attribute.

------------------------------------------------------------------------
r1840 | adk0212 | 2009-10-25 15:41:55 -0400 (Sun, 25 Oct 2009) | 2 lines

Add snmplite driver to win32 build

------------------------------------------------------------------------
r1839 | adk0212 | 2009-10-25 15:41:40 -0400 (Sun, 25 Oct 2009) | 2 lines

Minor changes so snmplite can build for win32

------------------------------------------------------------------------
r1838 | adk0212 | 2009-10-25 15:28:28 -0400 (Sun, 25 Oct 2009) | 2 lines

Update MIB map with more CIs from old powernet driver.

------------------------------------------------------------------------
r1837 | adk0212 | 2009-10-25 14:48:34 -0400 (Sun, 25 Oct 2009) | 2 lines

Updates for compatibility with old AP960x SNMP cards.

------------------------------------------------------------------------
r1836 | adk0212 | 2009-10-25 12:14:33 -0400 (Sun, 25 Oct 2009) | 2 lines

Remove some debug

------------------------------------------------------------------------
r1835 | adk0212 | 2009-10-25 11:54:46 -0400 (Sun, 25 Oct 2009) | 5 lines

Rearrange ASN types. Although it seems like a good idea to have a strict
separation between ASN and SNMP such that the ASN layer is not polluted
with SNMP types, this isn't working very well in practice. So teach ASN
about the basic SNMP types and get rid of the Snmp::PduType.

------------------------------------------------------------------------
r1834 | adk0212 | 2009-10-25 11:03:14 -0400 (Sun, 25 Oct 2009) | 4 lines

Add SNMP Lite driver which does not depend on net-snmp library. This makes
it more portable and eliminates need to move libsnmp.so to /lib in order
to do a killpower on systems where /usr is unmounted.

------------------------------------------------------------------------
r1833 | adk0212 | 2009-10-25 10:58:35 -0400 (Sun, 25 Oct 2009) | 2 lines

Make size unsigned

------------------------------------------------------------------------
r1832 | adk0212 | 2009-10-24 15:41:10 -0400 (Sat, 24 Oct 2009) | 2 lines

Simple (and inefficient) dynamic array template class

------------------------------------------------------------------------
r1831 | adk0212 | 2009-10-24 10:04:01 -0400 (Sat, 24 Oct 2009) | 3 lines

Force use of HFS+ rather than HFSX (case-sensitive HFS+) so 10.5+ will
open the image without crying about it.

------------------------------------------------------------------------
r1830 | adk0212 | 2009-10-15 20:46:39 -0400 (Thu, 15 Oct 2009) | 4 lines

Revert snmp static lib change. This is too incompatible. Solaris only has
static versions of libnetsnmp but not libcrypto. Darwin doesn't seem to
have static versions of either of them.

------------------------------------------------------------------------
r1829 | adk0212 | 2009-10-15 18:44:47 -0400 (Thu, 15 Oct 2009) | 4 lines

Link with static snmp libs since some platforms do not have the shared
ones in /lib. Contributed by Brad King <brad.king@kitware.com> via Debian
bugtracker. http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=316932

------------------------------------------------------------------------
r1828 | adk0212 | 2009-10-15 18:13:45 -0400 (Thu, 15 Oct 2009) | 3 lines

Merge WALL fix from Justin T Pryzby <justinpryzby@users.sourceforge.net>
http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=546019

------------------------------------------------------------------------
r1827 | adk0212 | 2009-10-14 19:14:22 -0400 (Wed, 14 Oct 2009) | 2 lines

Update status window control layout to match apctray

------------------------------------------------------------------------
r1826 | adk0212 | 2009-10-12 19:22:23 -0400 (Mon, 12 Oct 2009) | 2 lines

Lowercase $(COMMA)

------------------------------------------------------------------------
r1825 | adk0212 | 2009-10-12 19:15:58 -0400 (Mon, 12 Oct 2009) | 2 lines

Patch version info into resource file on the fly

------------------------------------------------------------------------
r1824 | adk0212 | 2009-10-12 18:53:05 -0400 (Mon, 12 Oct 2009) | 2 lines

Set operating system field correctly

------------------------------------------------------------------------
r1823 | adk0212 | 2009-10-12 18:50:27 -0400 (Mon, 12 Oct 2009) | 2 lines

Update file information block. Still not sure what to do about version info

------------------------------------------------------------------------
r1822 | adk0212 | 2009-10-12 18:35:32 -0400 (Mon, 12 Oct 2009) | 2 lines

Convert all member variable names to leading underscore convention

------------------------------------------------------------------------
r1821 | adk0212 | 2009-10-12 18:27:25 -0400 (Mon, 12 Oct 2009) | 2 lines

Update for StatMgr::GetAll() changes

------------------------------------------------------------------------
r1820 | adk0212 | 2009-10-12 18:17:14 -0400 (Mon, 12 Oct 2009) | 3 lines

Change StatMgr::GetAll() to return keys and values separately instead of
combining them into a single string which the caller then has to split.

------------------------------------------------------------------------
r1819 | adk0212 | 2009-10-12 18:09:09 -0400 (Mon, 12 Oct 2009) | 2 lines

Consolidate listview update code into ListView wrapper class.

------------------------------------------------------------------------
r1818 | adk0212 | 2009-10-12 17:43:16 -0400 (Mon, 12 Oct 2009) | 6 lines

Fix issue with events and status dialogs not updating until the next poll
thread tick. Kicking the poll thread inline with window creation does not
work since new window is not yet fully created (WM_INITDIALOG has not been
processed yet). Fix is to have status and events dialogs request a refresh
when WM_INITDIALOG arrives.

------------------------------------------------------------------------
r1817 | adk0212 | 2009-10-11 18:51:04 -0400 (Sun, 11 Oct 2009) | 2 lines

Minor cleanup

------------------------------------------------------------------------
r1816 | adk0212 | 2009-10-11 18:33:05 -0400 (Sun, 11 Oct 2009) | 2 lines

Add menu item for controlling autostart

------------------------------------------------------------------------
r1815 | adk0212 | 2009-10-11 15:21:22 -0400 (Sun, 11 Oct 2009) | 4 lines

Change events and status dialogs to not use cached statmgr since it will
be replaced when user changes config. Update events window to use listview
and have resize capability.

------------------------------------------------------------------------
r1814 | adk0212 | 2009-10-11 13:04:43 -0400 (Sun, 11 Oct 2009) | 3 lines

Move reconfig to poll thread so UI is not held up when applying a new
config. This is in line with what the OS X apcagent does.

------------------------------------------------------------------------
r1813 | adk0212 | 2009-10-11 12:41:32 -0400 (Sun, 11 Oct 2009) | 2 lines

Fix redrawing icons when explorer restarts with new taskbar

------------------------------------------------------------------------
r1812 | adk0212 | 2009-10-11 12:15:48 -0400 (Sun, 11 Oct 2009) | 2 lines

Minor cleanup

------------------------------------------------------------------------
r1811 | adk0212 | 2009-10-11 12:15:04 -0400 (Sun, 11 Oct 2009) | 4 lines

Rework network error handling so Update() only retries on soft errors, not
hard errors. This helps minimize the length of time a given monitor will
ignore UI events when it is unable to connect to an apcupsd.

------------------------------------------------------------------------
r1810 | adk0212 | 2009-10-11 12:12:59 -0400 (Sun, 11 Oct 2009) | 2 lines

Fix thread hang by lengthening thread exit wait to accomodate worst case

------------------------------------------------------------------------
r1809 | adk0212 | 2009-10-11 12:12:08 -0400 (Sun, 11 Oct 2009) | 2 lines

Move runtime field onto same line as status and shrink dialog to match

------------------------------------------------------------------------
r1808 | adk0212 | 2009-10-10 13:41:21 -0400 (Sat, 10 Oct 2009) | 2 lines

About box updates: Remove old logo, fix version/date info, update copyright

------------------------------------------------------------------------
r1807 | adk0212 | 2009-10-10 11:56:25 -0400 (Sat, 10 Oct 2009) | 2 lines

Set focus to first invalid control

------------------------------------------------------------------------
r1806 | adk0212 | 2009-10-10 11:55:58 -0400 (Sat, 10 Oct 2009) | 2 lines

Restrict port and refresh fields to digits only

------------------------------------------------------------------------
r1805 | adk0212 | 2009-10-10 11:42:37 -0400 (Sat, 10 Oct 2009) | 2 lines

Add support for disabling popups. Other misc cleanup.

------------------------------------------------------------------------
r1804 | adk0212 | 2009-10-08 18:59:41 -0400 (Thu, 08 Oct 2009) | 2 lines

Fixes for config dialog. Implement basic input validation.

------------------------------------------------------------------------
r1803 | adk0212 | 2009-10-08 18:05:14 -0400 (Thu, 08 Oct 2009) | 2 lines

Fix row deletion bug when number of items decreases

------------------------------------------------------------------------
r1802 | adk0212 | 2009-10-07 20:36:54 -0400 (Wed, 07 Oct 2009) | 2 lines

First pass at config dialog

------------------------------------------------------------------------
r1801 | adk0212 | 2009-10-07 20:36:32 -0400 (Wed, 07 Oct 2009) | 2 lines

First pass at configuration dialog.

------------------------------------------------------------------------
r1800 | adk0212 | 2009-10-07 19:10:02 -0400 (Wed, 07 Oct 2009) | 3 lines

Multiple instances working again now. New 'add' menu option to add a new
monitor. Rearrange menu items to match OS X. Lots of code cleanup.

------------------------------------------------------------------------
r1799 | adk0212 | 2009-10-07 19:08:49 -0400 (Wed, 07 Oct 2009) | 2 lines

Add support for operator->() on iterator

------------------------------------------------------------------------
r1798 | adk0212 | 2009-10-07 08:02:28 -0400 (Wed, 07 Oct 2009) | 3 lines

Begin to clean up instance management by creating an InstanceManager. Basic
functions are working again, but add/remove instance needs work.

------------------------------------------------------------------------
r1797 | adk0212 | 2009-10-05 20:35:22 -0400 (Mon, 05 Oct 2009) | 3 lines

Fix possible crash if FillStatusBox() were to be called at just the wrong
instant.

------------------------------------------------------------------------
r1796 | adk0212 | 2009-10-05 20:07:05 -0400 (Mon, 05 Oct 2009) | 2 lines

Don't leak ListView wrappers

------------------------------------------------------------------------
r1795 | adk0212 | 2009-10-05 20:05:17 -0400 (Mon, 05 Oct 2009) | 2 lines

Add wrapper class for listview and use it from winstat

------------------------------------------------------------------------
r1794 | adk0212 | 2009-10-05 20:04:23 -0400 (Mon, 05 Oct 2009) | 2 lines

Add wrapper class for listview and use it in winstat.

------------------------------------------------------------------------
r1793 | adk0212 | 2009-10-05 19:35:54 -0400 (Mon, 05 Oct 2009) | 2 lines

Add/update copyright banners

------------------------------------------------------------------------
r1792 | adk0212 | 2009-10-05 19:34:49 -0400 (Mon, 05 Oct 2009) | 5 lines

Colorize load and battery meters, as per apcagent. Break meter code out
into a separate wrapper class -- a poor man's MFC essentially. Only update
controls when their values change to further reduce refresh flicker. Misc
cleanup.

------------------------------------------------------------------------
r1791 | adk0212 | 2009-10-04 13:02:11 -0400 (Sun, 04 Oct 2009) | 8 lines

Rewrite apctray status dialog to mimic apcagent on OS X. Window now updates
on the fly, is resizeable, and has summary info at the top. Also uses
ListView control for raw status info so it is in two nice columns and no
longer needs to be rendered in an ugly fixed-width font. Switch to ResEdit
(http://www.resedit.net) for GUI resource editing instead of tweaking
winres.rc by hand. This requires renaming winres.h to resource.h since
that's what ResEdit wants to generate.

------------------------------------------------------------------------
r1790 | adk0212 | 2009-10-03 13:26:41 -0400 (Sat, 03 Oct 2009) | 4 lines

Fix preferences window label text being obscured by the surrounding box.
Issue only appeared on 10.4, but probably just getting lucky with drawing
order on 10.5.

------------------------------------------------------------------------
r1789 | adk0212 | 2009-10-03 10:20:25 -0400 (Sat, 03 Oct 2009) | 3 lines

Fix issue with popups not appearing if Growl is installed while apcagent
is running.

------------------------------------------------------------------------
r1788 | adk0212 | 2009-09-30 19:15:41 -0400 (Wed, 30 Sep 2009) | 2 lines

Include apcagent in OS X installer DMG

------------------------------------------------------------------------
r1787 | adk0212 | 2009-09-29 19:20:45 -0400 (Tue, 29 Sep 2009) | 3 lines

Build apcagent automatically on OS X but let user disable it via configure
if s/he so desires.

------------------------------------------------------------------------
r1786 | adk0212 | 2009-09-29 18:58:49 -0400 (Tue, 29 Sep 2009) | 2 lines

Add support for popup notifications via Growl

------------------------------------------------------------------------
r1785 | adk0212 | 2009-09-27 19:39:29 -0400 (Sun, 27 Sep 2009) | 4 lines

Fix login item creation on 10.4. Problem and solution is nicely documented
by Jake Sprouse here:
http://jakesprouse.net/2007/03/28/debugging-apples-loginitemsaec-on-intel-macs

------------------------------------------------------------------------
r1784 | adk0212 | 2009-09-27 16:03:12 -0400 (Sun, 27 Sep 2009) | 2 lines

Overwrite dmg

------------------------------------------------------------------------
r1783 | adk0212 | 2009-09-27 15:56:02 -0400 (Sun, 27 Sep 2009) | 2 lines

Add menu item to enable/disable starting at login

------------------------------------------------------------------------
r1782 | adk0212 | 2009-09-27 14:37:10 -0400 (Sun, 27 Sep 2009) | 5 lines

Add UPS and HOST info to top of menu a'la apctray on win32. Automatically
add user login item when apcagent is started for the first time. Remove
login item when last monitor is removed. Add menu option to remove all
monitors at once. Reorder menu items slightly.

------------------------------------------------------------------------
r1781 | adk0212 | 2009-09-27 10:57:03 -0400 (Sun, 27 Sep 2009) | 2 lines

Support for multiple instances

------------------------------------------------------------------------
r1780 | adk0212 | 2009-09-23 20:14:37 -0400 (Wed, 23 Sep 2009) | 3 lines

Interpret failure to read any status items as failure of the connection
and close it. Retry Update() once in case it fails.

------------------------------------------------------------------------
r1779 | adk0212 | 2009-09-23 18:19:53 -0400 (Wed, 23 Sep 2009) | 2 lines

Fix linking of libapc.a so it is included as a dependency.

------------------------------------------------------------------------
r1778 | adk0212 | 2009-09-23 18:17:19 -0400 (Wed, 23 Sep 2009) | 4 lines

Ignore SIGPIPE, which can happen when writing to a socket where the remote
end has closed the connection. Also improve error handling in
write_nbytes().

------------------------------------------------------------------------
r1777 | adk0212 | 2009-09-23 18:16:14 -0400 (Wed, 23 Sep 2009) | 2 lines

Copy hostname so caller doesn't have to keep it valid.

------------------------------------------------------------------------
r1776 | adk0212 | 2009-09-20 19:47:01 -0400 (Sun, 20 Sep 2009) | 2 lines

Minor cleanups

------------------------------------------------------------------------
r1775 | adk0212 | 2009-09-20 19:29:37 -0400 (Sun, 20 Sep 2009) | 2 lines

Minor optimization to DataSource classes

------------------------------------------------------------------------
r1774 | adk0212 | 2009-09-20 19:07:45 -0400 (Sun, 20 Sep 2009) | 3 lines

Plumb in about panel. Expand copyright text slightly. Rename menu items
to more closely match other OS X app naming conventions.

------------------------------------------------------------------------
r1773 | adk0212 | 2009-09-20 18:23:10 -0400 (Sun, 20 Sep 2009) | 2 lines

Make icon backgrounds transparent

------------------------------------------------------------------------
r1772 | adk0212 | 2009-09-20 17:25:22 -0400 (Sun, 20 Sep 2009) | 2 lines

Add horizontal separators to the menu

------------------------------------------------------------------------
r1771 | adk0212 | 2009-09-20 17:13:22 -0400 (Sun, 20 Sep 2009) | 2 lines

Remove InfoPlist.strings dependency

------------------------------------------------------------------------
r1770 | adk0212 | 2009-09-20 17:11:53 -0400 (Sun, 20 Sep 2009) | 3 lines

Update Info.plist with copyright and version info. Version is substituted
at build time for __VERSION__. Remove unused InfoPlist.strings file.

------------------------------------------------------------------------
r1769 | adk0212 | 2009-09-20 17:11:09 -0400 (Sun, 20 Sep 2009) | 2 lines

Minor cleanup

------------------------------------------------------------------------
r1768 | adk0212 | 2009-09-20 16:39:42 -0400 (Sun, 20 Sep 2009) | 2 lines

Add apcagent, an apctray-like applet for Mac OS X

------------------------------------------------------------------------
r1767 | adk0212 | 2009-09-20 16:26:05 -0400 (Sun, 20 Sep 2009) | 2 lines

Move FetchStatus() to StatMgr class and rename to GetSummary()

------------------------------------------------------------------------
r1766 | adk0212 | 2009-09-20 16:11:13 -0400 (Sun, 20 Sep 2009) | 2 lines

Convert win32 apctray to use shared statmgr and alib classes.

------------------------------------------------------------------------
r1765 | adk0212 | 2009-09-20 15:47:47 -0400 (Sun, 20 Sep 2009) | 2 lines

Add copy of win32 statmgr with win32-isms replaced with alib equivalents

------------------------------------------------------------------------
r1764 | adk0212 | 2009-09-20 15:46:13 -0400 (Sun, 20 Sep 2009) | 2 lines

Add lightweight STL-like class library

------------------------------------------------------------------------
r1763 | adk0212 | 2009-09-20 15:41:26 -0400 (Sun, 20 Sep 2009) | 2 lines

Add support for building Objective-C files (*.m)

------------------------------------------------------------------------
r1762 | adk0212 | 2009-09-20 15:39:24 -0400 (Sun, 20 Sep 2009) | 2 lines

Forgot -arch flags for apcupsd build

------------------------------------------------------------------------
r1761 | adk0212 | 2009-09-13 18:08:58 -0400 (Sun, 13 Sep 2009) | 2 lines

And more updates to the notes. Nearly done now, I think.

------------------------------------------------------------------------
r1760 | adk0212 | 2009-09-13 17:36:46 -0400 (Sun, 13 Sep 2009) | 2 lines

More build notes updates.

------------------------------------------------------------------------
r1759 | adk0212 | 2009-09-13 17:28:20 -0400 (Sun, 13 Sep 2009) | 2 lines

More updates to Darwin build notes.

------------------------------------------------------------------------
r1758 | adk0212 | 2009-09-13 17:05:42 -0400 (Sun, 13 Sep 2009) | 5 lines

Disable PackageMaker's "suggested permissions" in favor of using our own
explicit permissions. Tweak perms on /Library to keep PackageMaker happy.
Remove permission fixups from preflight/postflight scripts. Copy the
apcupsd-uninstall script to /sbin during install.

------------------------------------------------------------------------
r1757 | adk0212 | 2009-09-13 17:02:31 -0400 (Sun, 13 Sep 2009) | 2 lines

Add uninstall script.

------------------------------------------------------------------------
r1756 | adk0212 | 2009-09-13 09:29:11 -0400 (Sun, 13 Sep 2009) | 3 lines

Work around PackageMaker bug that gets ApcupsdDummy.kext directory
permissions wrong.

------------------------------------------------------------------------
r1755 | adk0212 | 2009-09-11 20:01:58 -0400 (Fri, 11 Sep 2009) | 2 lines

Update OS X build notes with more info I've discovered.

------------------------------------------------------------------------
r1754 | adk0212 | 2009-09-08 18:03:38 -0400 (Tue, 08 Sep 2009) | 2 lines

Update apctest manpage for USB battery calibration function.

------------------------------------------------------------------------
r1753 | adk0212 | 2009-09-01 20:30:37 -0400 (Tue, 01 Sep 2009) | 4 lines

Implement battery calibration in apctest for USB models.
Thanks to James Belleau <james@belleau.net> for the original implementation
which has been modified somewhat in this commit.

------------------------------------------------------------------------
r1752 | adk0212 | 2009-08-30 11:24:04 -0400 (Sun, 30 Aug 2009) | 2 lines

Update Darwin USB section to call out libusb-0.1.12 specifically.

------------------------------------------------------------------------
r1751 | adk0212 | 2009-08-30 11:14:04 -0400 (Sun, 30 Aug 2009) | 2 lines

Fix TTY mode comms option on Win32.

------------------------------------------------------------------------
r1750 | adk0212 | 2009-08-30 10:15:39 -0400 (Sun, 30 Aug 2009) | 3 lines

Add notes about compatibility builds. Update universal binaries notes.
Rename file to 'build-notes.txt'.

------------------------------------------------------------------------
r1749 | adk0212 | 2009-08-29 14:33:23 -0400 (Sat, 29 Aug 2009) | 3 lines

Regen configure with autoconf-2.61 (Darwin XCode-3.3) to fix some warnings
when configuring on OS X.

------------------------------------------------------------------------
r1748 | adk0212 | 2009-08-29 14:27:50 -0400 (Sat, 29 Aug 2009) | 8 lines

Update OS X installer for XCode-3.x
Unable to find a simple way to create metapackages from the command line
so separate Daemon and UsbShim subpackages are gone. Everything is now in
the top-level package. On the up side, however, we can now override the
version string from the command line so we no longer need autoconf to
preprocess the plist. Additionally, packagemaker generates the plist now
and just merges in any overrides we specify. Much nicer.

------------------------------------------------------------------------
r1747 | adk0212 | 2009-08-23 15:04:31 -0400 (Sun, 23 Aug 2009) | 3 lines

Add missing NOMINV, NOMOUTV, and NOMPOWER to clients.
Reported by Luciano De Rosa <l.derosa@tiscali.it>

------------------------------------------------------------------------
r1745 | adk0212 | 2009-08-14 11:02:19 -0400 (Fri, 14 Aug 2009) | 2 lines

Introduce new download page since sf.net is so hard to navigate now.

------------------------------------------------------------------------
r1744 | adk0212 | 2009-08-07 08:15:37 -0400 (Fri, 07 Aug 2009) | 3 lines

Change ReleaseNotes links to point at versions in CVS since SF isn't
properly serving the file if you point to the downloads section.

------------------------------------------------------------------------
r1743 | adk0212 | 2009-08-02 10:36:30 -0400 (Sun, 02 Aug 2009) | 2 lines

Update for 3.14.7 release.

------------------------------------------------------------------------
r1741 | adk0212 | 2009-08-01 13:29:15 -0400 (Sat, 01 Aug 2009) | 2 lines

Final prep for 3.14.7 release.

------------------------------------------------------------------------
r1740 | fleetworks | 2009-08-01 10:41:16 -0400 (Sat, 01 Aug 2009) | 2 lines

3.14.7 spec update

------------------------------------------------------------------------
r1739 | adk0212 | 2009-08-01 08:18:35 -0400 (Sat, 01 Aug 2009) | 2 lines

Remove obsolete files

------------------------------------------------------------------------
r1738 | adk0212 | 2009-08-01 08:01:59 -0400 (Sat, 01 Aug 2009) | 2 lines

Remove remnants of powerflute

------------------------------------------------------------------------
r1737 | adk0212 | 2009-07-31 16:23:51 -0400 (Fri, 31 Jul 2009) | 2 lines

Prep for 3.14.7 release

------------------------------------------------------------------------
r1736 | adk0212 | 2009-07-31 16:19:07 -0400 (Fri, 31 Jul 2009) | 6 lines

Fix configure not noticing when C++ compiler does not exist. Annoyingly,
only the first of AC_PROG_CXX and AC_PROG_CC actually error out if the
conpiler does not exist. The second one just quietly sets a default and
keeps going. Temporary fix is to just move CXX detection to be first since
that's the compiler we really need.

------------------------------------------------------------------------
r1735 | adk0212 | 2009-07-31 15:35:55 -0400 (Fri, 31 Jul 2009) | 2 lines

Document multimon cgi programs for Windows.

------------------------------------------------------------------------
r1734 | adk0212 | 2009-07-31 11:34:27 -0400 (Fri, 31 Jul 2009) | 2 lines

Add support for formatting manpages into plain text

------------------------------------------------------------------------
r1733 | adk0212 | 2009-07-31 11:33:59 -0400 (Fri, 31 Jul 2009) | 4 lines

Include plain text manpages in windows install. Organize documentation
and provide start menu shortcuts. Also add a shortcut for editing the
config file.

------------------------------------------------------------------------
r1732 | adk0212 | 2009-07-31 11:33:10 -0400 (Fri, 31 Jul 2009) | 2 lines

Format manpages into plain text.

------------------------------------------------------------------------
r1731 | adk0212 | 2009-07-31 10:22:55 -0400 (Fri, 31 Jul 2009) | 2 lines

Add CGI scripts to Windows installer.

------------------------------------------------------------------------
r1730 | adk0212 | 2009-07-31 10:22:33 -0400 (Fri, 31 Jul 2009) | 2 lines

Build CGI programs for WIN32.

------------------------------------------------------------------------
r1729 | adk0212 | 2009-07-31 10:21:58 -0400 (Fri, 31 Jul 2009) | 2 lines

Remove manual calls to WSA_Init(). It's done automatically in libnis now.

------------------------------------------------------------------------
r1728 | adk0212 | 2009-07-31 10:20:35 -0400 (Fri, 31 Jul 2009) | 3 lines

Split network-related compat functions into their own file so users don't
have to link in all of compat.cpp.

------------------------------------------------------------------------
r1727 | adk0212 | 2009-07-31 10:18:31 -0400 (Fri, 31 Jul 2009) | 2 lines

Automatically invoke WSA_Init() during static initialization on WIN32.

------------------------------------------------------------------------
r1726 | adk0212 | 2009-07-31 10:16:42 -0400 (Fri, 31 Jul 2009) | 2 lines

Set stdout to binary mode on WIN32 to prevent corruption of image data.

------------------------------------------------------------------------
r1725 | adk0212 | 2009-07-26 10:50:59 -0400 (Sun, 26 Jul 2009) | 3 lines

Automatically add \\.\ UNC prefix to COMx device name on Windows. This
allows selection of ports above COM9.

------------------------------------------------------------------------
r1724 | adk0212 | 2009-07-26 10:42:31 -0400 (Sun, 26 Jul 2009) | 3 lines

Remove CI_BattReplaceDate because it does not seem to be populated on any
modern UPS. CI_BATTDAT works just fine.

------------------------------------------------------------------------
r1721 | adk0212 | 2009-06-07 21:15:05 -0400 (Sun, 07 Jun 2009) | 2 lines

Update to NSIS-2.45.

------------------------------------------------------------------------
r1720 | adk0212 | 2009-06-02 20:45:28 -0400 (Tue, 02 Jun 2009) | 2 lines

Fix typo.

------------------------------------------------------------------------
r1719 | adk0212 | 2009-05-31 12:18:55 -0400 (Sun, 31 May 2009) | 2 lines

Spell check.

------------------------------------------------------------------------
r1718 | adk0212 | 2009-05-31 12:14:48 -0400 (Sun, 31 May 2009) | 2 lines

Spell check.

------------------------------------------------------------------------
r1717 | adk0212 | 2009-05-31 11:13:49 -0400 (Sun, 31 May 2009) | 2 lines

Fix a few "apcupd" typos.

------------------------------------------------------------------------
r1714 | adk0212 | 2009-05-20 20:43:16 -0400 (Wed, 20 May 2009) | 2 lines

Fix UPS version in CGI stats and examples.

------------------------------------------------------------------------
r1713 | adk0212 | 2009-05-16 12:46:41 -0400 (Sat, 16 May 2009) | 2 lines

Update web site for 3.14.6 release.

------------------------------------------------------------------------
r1712 | adk0212 | 2009-05-16 12:46:21 -0400 (Sat, 16 May 2009) | 2 lines

Update script

------------------------------------------------------------------------
r1710 | adk0212 | 2009-05-16 10:07:36 -0400 (Sat, 16 May 2009) | 2 lines

Final prep for 3.14.6. Locked and loaded.

------------------------------------------------------------------------
r1709 | fleetworks | 2009-05-16 09:05:25 -0400 (Sat, 16 May 2009) | 2 lines

Comment out latex build.

------------------------------------------------------------------------
r1707 | adk0212 | 2009-05-15 20:13:20 -0400 (Fri, 15 May 2009) | 2 lines

Prep for 3.14.6 release (again).

------------------------------------------------------------------------
r1706 | adk0212 | 2009-05-15 20:13:00 -0400 (Fri, 15 May 2009) | 2 lines

Fix miscalculated length. Noticed by Stacy Millions <stacy@Millions.Ca>

------------------------------------------------------------------------
r1705 | adk0212 | 2009-05-15 19:57:59 -0400 (Fri, 15 May 2009) | 3 lines

Add --no-footnote-backlinks to RST2PDF options. It's now supported in
rst2pdf SVN trunk.

------------------------------------------------------------------------
r1704 | adk0212 | 2009-05-15 19:44:26 -0400 (Fri, 15 May 2009) | 2 lines

changes for new user manual location and format

------------------------------------------------------------------------
r1703 | adk0212 | 2009-05-15 19:32:13 -0400 (Fri, 15 May 2009) | 2 lines

Add script to publish the manual to the web site.

------------------------------------------------------------------------
r1702 | adk0212 | 2009-05-15 19:29:37 -0400 (Fri, 15 May 2009) | 2 lines

Remove old latex manual. We're all RST now!

------------------------------------------------------------------------
r1701 | adk0212 | 2009-05-15 19:23:19 -0400 (Fri, 15 May 2009) | 3 lines

Keep a preformatted copy of the user manual in CVS to ease tool
dependencies for packagers.

------------------------------------------------------------------------
r1700 | adk0212 | 2009-05-15 19:07:37 -0400 (Fri, 15 May 2009) | 2 lines

Update for new user manual location.

------------------------------------------------------------------------
r1699 | adk0212 | 2009-05-15 18:43:09 -0400 (Fri, 15 May 2009) | 2 lines

Fix Scott's name being misinterpreted as an enumerated (elettered?) list.

------------------------------------------------------------------------
r1698 | adk0212 | 2009-05-13 19:49:40 -0400 (Wed, 13 May 2009) | 2 lines

Applied updates from Trevor Roydhouse <trev@sentry.org>

------------------------------------------------------------------------
r1697 | adk0212 | 2009-05-12 19:45:39 -0400 (Tue, 12 May 2009) | 3 lines

Remove Linux /proc/bus/usb text files from appendix. They're a ton of
baggage for not much gain.

------------------------------------------------------------------------
r1696 | adk0212 | 2009-05-12 19:35:18 -0400 (Tue, 12 May 2009) | 2 lines

Minor formatting and typo fixes to smart protocol docs.

------------------------------------------------------------------------
r1695 | adk0212 | 2009-05-09 09:04:31 -0400 (Sat, 09 May 2009) | 2 lines

Fix some {} style markup I missed on the first pass.

------------------------------------------------------------------------
r1694 | adk0212 | 2009-05-09 08:50:08 -0400 (Sat, 09 May 2009) | 2 lines

Fix expansion of APC acronym.

------------------------------------------------------------------------
r1693 | adk0212 | 2009-05-07 21:10:40 -0400 (Thu, 07 May 2009) | 2 lines

Some tweaks for better compatibility with rst2pdf.

------------------------------------------------------------------------
r1692 | adk0212 | 2009-05-06 21:51:00 -0400 (Wed, 06 May 2009) | 6 lines

Several updates to the manual. Replace existing section on UPS maintenance
with a new one contributed by Trevor Roydhouse <trev@sentry.org>. Replace
old disclaimer with a new one, also from Trev. Add some hyperlinks in the
smart protocol section. Clean up some table formatting in that section
as well.

------------------------------------------------------------------------
r1691 | adk0212 | 2009-05-06 21:50:07 -0400 (Wed, 06 May 2009) | 2 lines

Noninterlaced version of logo for compatibility with rst2pdf.

------------------------------------------------------------------------
r1690 | adk0212 | 2009-05-05 17:51:26 -0400 (Tue, 05 May 2009) | 2 lines

Add allowable settings for LOWBATT. From Trevor Roydhouse <trev@sentry.org>

------------------------------------------------------------------------
r1689 | adk0212 | 2009-05-04 18:21:57 -0400 (Mon, 04 May 2009) | 3 lines

Autodetect locations of rst2pdf and rst2html. Politely skip typesetting
each format if the generator is not available.

------------------------------------------------------------------------
r1688 | adk0212 | 2009-05-04 18:20:42 -0400 (Mon, 04 May 2009) | 3 lines

Add support for QNX. Tested on QNX 6.3.2. Contributed by Mikhail Gruzdev
<michail.gruzdev@gmail.com>

------------------------------------------------------------------------
r1687 | adk0212 | 2009-05-04 18:03:06 -0400 (Mon, 04 May 2009) | 3 lines

Add support for QNX. Tested on QNX 6.3.2. Contributed by Mikhail Gruzdev
<michail.gruzdev@gmail.com>

------------------------------------------------------------------------
r1686 | adk0212 | 2009-05-04 17:56:24 -0400 (Mon, 04 May 2009) | 2 lines

s/batteryload/load/. Contributed by Mikhail Gruzdev <michail.gruzdev@gmail.com>

------------------------------------------------------------------------
r1685 | adk0212 | 2009-05-03 17:56:25 -0400 (Sun, 03 May 2009) | 2 lines

Generate PDF manual automatically.

------------------------------------------------------------------------
r1684 | adk0212 | 2009-05-03 17:55:09 -0400 (Sun, 03 May 2009) | 2 lines

Fix typo.

------------------------------------------------------------------------
r1683 | adk0212 | 2009-05-03 13:31:39 -0400 (Sun, 03 May 2009) | 2 lines

Fix broken references. Now formats cleanly with no errors or warnings.

------------------------------------------------------------------------
r1682 | adk0212 | 2009-05-03 12:31:03 -0400 (Sun, 03 May 2009) | 2 lines

Minor tweaks to spacing, etc.

------------------------------------------------------------------------
r1681 | adk0212 | 2009-05-03 12:27:18 -0400 (Sun, 03 May 2009) | 3 lines

Rejuvinate smart protocol section and add it back in. Merged with updates
from NUT site.

------------------------------------------------------------------------
r1680 | adk0212 | 2009-05-02 19:46:59 -0400 (Sat, 02 May 2009) | 3 lines

Add EEPROM configuration directives. Text stolen shamelessly from Trevor's
apcupsd.conf(5).

------------------------------------------------------------------------
r1679 | adk0212 | 2009-05-02 19:30:07 -0400 (Sat, 02 May 2009) | 2 lines

Minor fixes to apctest section. This needs major updates eventually.

------------------------------------------------------------------------
r1678 | adk0212 | 2009-05-02 19:20:42 -0400 (Sat, 02 May 2009) | 2 lines

Bring in a shortened version of the supportedupses text.

------------------------------------------------------------------------
r1677 | adk0212 | 2009-05-02 18:37:30 -0400 (Sat, 02 May 2009) | 2 lines

Add Windows 7. Split Solaris into 8/9 (no USB) and 10 (USB supported).

------------------------------------------------------------------------
r1676 | adk0212 | 2009-05-02 18:30:38 -0400 (Sat, 02 May 2009) | 2 lines

Rewrite and add in supported operating systems section.

------------------------------------------------------------------------
r1675 | adk0212 | 2009-05-02 18:29:35 -0400 (Sat, 02 May 2009) | 3 lines

Don't generate backrefs for footnotes; they make the footnotes hard to
read.

------------------------------------------------------------------------
r1674 | adk0212 | 2009-05-02 12:11:32 -0400 (Sat, 02 May 2009) | 4 lines

Surround TOC with transition dividers to help set it apart. I wish the
text for the TOC title were rendered larger. Need to investigate alternate
stylesheets.

------------------------------------------------------------------------
r1673 | adk0212 | 2009-05-02 12:00:00 -0400 (Sat, 02 May 2009) | 4 lines

Add preliminary Makefile support for rst2html. Dependencies are working.
Not tied in to top-level make yet since not everyone will have rst2html.
'make clean' not working yet. Need to figure out what to do about that.

------------------------------------------------------------------------
r1672 | adk0212 | 2009-05-02 10:30:19 -0400 (Sat, 02 May 2009) | 4 lines

Change log level of UPS self-test messages to WARNING from ALERT. Given
that self-test messages are routine, they do not belong at LOG_ALERT.
Contributed by Dave Ewart <davee@ceu.ox.ac.uk>.

------------------------------------------------------------------------
r1671 | adk0212 | 2009-05-02 10:21:20 -0400 (Sat, 02 May 2009) | 2 lines

Install manpages as part of 'make install'.

------------------------------------------------------------------------
r1670 | adk0212 | 2009-05-02 10:05:42 -0400 (Sat, 02 May 2009) | 2 lines

Remove one leftover old manpage.

------------------------------------------------------------------------
r1669 | adk0212 | 2009-05-02 10:04:35 -0400 (Sat, 02 May 2009) | 3 lines

Replace old manpages with shiny new ones, courtesy of Trevor Roydhousea
<trev@sentry.org>. Many thanks, Trev!

------------------------------------------------------------------------
r1668 | adk0212 | 2009-04-30 19:20:14 -0400 (Thu, 30 Apr 2009) | 2 lines

Minor updates plus clean up and add back in the cables section.

------------------------------------------------------------------------
r1667 | adk0212 | 2009-04-26 20:34:05 -0400 (Sun, 26 Apr 2009) | 2 lines

Revert accidental changes.

------------------------------------------------------------------------
r1666 | adk0212 | 2009-04-26 19:12:25 -0400 (Sun, 26 Apr 2009) | 4 lines

First pass at converting apcupsd user manual to reStructuredText.
Initial conversion via Pandoc, then lots of hand editing. It's in
pretty good shape now. Need to fix up external files.

------------------------------------------------------------------------
r1665 | adk0212 | 2009-04-25 11:04:25 -0400 (Sat, 25 Apr 2009) | 9 lines

Make startup success message appear in logs again.
From Trevor Roydhouse <trev@sentry.org>:
apcupsd stopped printing startup success messages at some
point. Looking through the code it is because it was decided that the
LOG_INFO facility level should only be used for data file logging and
so it filters out other uses. Unfortunately the startup message is
set to that level. Changing the startup message to LOG_WARNING works
and is consistent with the normal shutdown message facility level.

------------------------------------------------------------------------
r1664 | adk0212 | 2009-04-25 10:58:29 -0400 (Sat, 25 Apr 2009) | 5 lines

Remove EVENTFILE, EVENTFILEMAX config directives. These were replaced by
the plural versions that are in use today (EVENTSFILE, EVENTSFILEMAX)
almost 10 years ago. It's time to kill the old names.
(h/t Trevor Roydhouse <trev@sentry.org>)

------------------------------------------------------------------------
r1663 | adk0212 | 2009-04-25 10:47:50 -0400 (Sat, 25 Apr 2009) | 3 lines

Add -P,--pid-file to -h output. Update copyright.
(h/t Trevor Roydhouse <trev@sentry.org>)

------------------------------------------------------------------------
r1662 | adk0212 | 2009-04-25 10:45:04 -0400 (Sat, 25 Apr 2009) | 3 lines

RELEASE is merely a subset of VERSION. Remove RELEASE.
(h/t Trevor Roydhouse <trev@sentry.org>)

------------------------------------------------------------------------
r1661 | adk0212 | 2009-03-19 19:18:07 -0400 (Thu, 19 Mar 2009) | 2 lines

Update sf.net logo per new guidelines.

------------------------------------------------------------------------
r1660 | adk0212 | 2009-03-02 18:16:55 -0500 (Mon, 02 Mar 2009) | 2 lines

Pseudo-prep for 3.14.6

------------------------------------------------------------------------
r1659 | adk0212 | 2009-03-02 17:52:57 -0500 (Mon, 02 Mar 2009) | 3 lines

Workaround for crash during process shutdown.
Contributed by Andrey Sharandakov <ash.ashway@gmail.com>

------------------------------------------------------------------------
r1658 | adk0212 | 2009-03-02 17:48:26 -0500 (Mon, 02 Mar 2009) | 5 lines

Add support for turning the UPS off completely. This complements existing
hibernate (aka killpower) functionality. Turn-off is implemented for
apcsmart and USB drivers, subject to support for the relevant commands in
the UPS itself. Contributed by Keith Campbell <campbell@econnectix.com>.

------------------------------------------------------------------------
r1657 | adk0212 | 2009-03-01 10:03:51 -0500 (Sun, 01 Mar 2009) | 2 lines

Fix build with gcc-4.4. Contributed by Michal Hlavinka <mhlavink@redhat.com>.

------------------------------------------------------------------------
r1656 | adk0212 | 2009-02-14 16:35:16 -0500 (Sat, 14 Feb 2009) | 5 lines

Fix number of array entries which was causing a buffer overflow.
Contributed by David Fries <david@fries.net>.
Also change loop counters to unsigned, eliminating a new warning introduced
by the above change plus allowing removal of unnecessary casts to int.

------------------------------------------------------------------------
r1655 | adk0212 | 2009-02-10 18:39:30 -0500 (Tue, 10 Feb 2009) | 18 lines

Fix some deadlocks in the case of a comm failure when smart_poll() is
called without holding the UPS lock. Contributed by Keith Campbell
<campbell@econnectix.com>:

On one of our machines, apcupsd 3.14.5 (using a smart serial cable)
would occasionally not finish starting up.  Running strace revealed
that it was stuck in deadlock on a futex() system call.

I've traced this to some poorly written code inside the apcsmart
driver.  Inside smart.c there is a UPSlinkCheck() function which
according to the documentation must be called with the UPS lock held
(ugh).  smart_poll() calls the UPSlinkCheck() function (but only in a
rarely followed error handling branch), so therefore it must also be
called with the lock held.  The problem is, many things call
smart_poll() but some call it without the lock, and other with the
lock.  I've put locks around a few smart_poll() calls in smartsetup2.c
which corrected the problem I was seeing.

------------------------------------------------------------------------
r1654 | adk0212 | 2009-01-15 17:57:38 -0500 (Thu, 15 Jan 2009) | 3 lines

Year++
h/t Kirill S. Bychkov <yason@linklevel.net>

------------------------------------------------------------------------
r1653 | adk0212 | 2009-01-14 18:00:41 -0500 (Wed, 14 Jan 2009) | 2 lines

Update publish scripts for sf.net changes

------------------------------------------------------------------------
r1652 | adk0212 | 2009-01-14 17:49:26 -0500 (Wed, 14 Jan 2009) | 2 lines

Update for 3.14.5 release.

------------------------------------------------------------------------
r1650 | adk0212 | 2009-01-10 15:02:56 -0500 (Sat, 10 Jan 2009) | 2 lines

3.14.5 for real this time.

------------------------------------------------------------------------
r1649 | adk0212 | 2008-11-10 19:14:58 -0500 (Mon, 10 Nov 2008) | 3 lines

Compile fixes for nagios plugin.
Contributed by Ronald J. Yacketta <yacketrj@potsdam.edu>

------------------------------------------------------------------------
r1648 | adk0212 | 2008-11-01 11:03:26 -0400 (Sat, 01 Nov 2008) | 3 lines

Remove unused DISTVER code.
Contributed by Miloň Papežík <mmp@secure-it.cz>

------------------------------------------------------------------------
r1647 | adk0212 | 2008-10-26 10:25:41 -0400 (Sun, 26 Oct 2008) | 2 lines

Prep for 3.14.5 release (again)

------------------------------------------------------------------------
r1646 | adk0212 | 2008-10-20 18:19:10 -0400 (Mon, 20 Oct 2008) | 2 lines

Update to nsis-2.40.

------------------------------------------------------------------------
r1645 | adk0212 | 2008-10-20 18:18:32 -0400 (Mon, 20 Oct 2008) | 2 lines

Document the /refresh switch for apctray.

------------------------------------------------------------------------
r1644 | skoona | 2008-09-16 00:58:20 -0400 (Tue, 16 Sep 2008) | 8 lines

Corrected the timebase on the sockopts(0 api call.  I intended to set the timeout for
two tenths of a second, instead I set it for 200 usec.  The results
was un-stability and frequently dropped session on my quad-core; dual and
single cores didn't seem to be bothered.  Now is it set for 200000 usec
as I originally intended.

James,

------------------------------------------------------------------------
r1643 | skoona | 2008-09-16 00:34:37 -0400 (Tue, 16 Sep 2008) | 2 lines

Corrected person references, FreeBSD is the platform Jason Hale maintains

------------------------------------------------------------------------
r1642 | skoona | 2008-09-16 00:23:32 -0400 (Tue, 16 Sep 2008) | 7 lines

Applied two patches
1. eggtrayicon.c -- applies background transparency when in systray mode to systray icon.
2. gapcmon.c -- Add include for BSD sockaddr_in, no impact on other platforms.
Note: Socket timeout timers were shortened in a prior update

James,

------------------------------------------------------------------------
r1641 | adk0212 | 2008-09-10 18:34:05 -0400 (Wed, 10 Sep 2008) | 5 lines

Do not create pid file in apctest. There is little reason for it since
apctest is a command-line tool, not a daemon. Plus nothing ever deletes
the file so it interferes with apcupsd operation.
Reported by Eddie Atherton <stunnel@attglobal.net>

------------------------------------------------------------------------
r1640 | adk0212 | 2008-09-09 17:51:18 -0400 (Tue, 09 Sep 2008) | 3 lines

Change -? to -h for the sake of consistency with other software.
Contributed by Thomas Pfaff <thomas.arnesen.pfaff@gmail.com>

------------------------------------------------------------------------
r1639 | adk0212 | 2008-08-17 11:01:51 -0400 (Sun, 17 Aug 2008) | 2 lines

Work around PackageMaker bug in XCode-2.5.

------------------------------------------------------------------------
r1638 | adk0212 | 2008-08-17 10:43:13 -0400 (Sun, 17 Aug 2008) | 2 lines

Update Darwin universal binary instructions.

------------------------------------------------------------------------
r1637 | skoona | 2008-08-15 01:24:50 -0400 (Fri, 15 Aug 2008) | 4 lines

Added setsockopt() to sknet_open() to resolve timeout related issue.
I set it to 200ms initially, need to test a bet before releasing.
James,

------------------------------------------------------------------------
r1635 | adk0212 | 2008-08-03 16:24:04 -0400 (Sun, 03 Aug 2008) | 3 lines

A convenient side-effect of the flags split is that deps now work correctly
during a universal binary build.

------------------------------------------------------------------------
r1634 | adk0212 | 2008-08-03 12:51:16 -0400 (Sun, 03 Aug 2008) | 4 lines

Fix a few unsafe uses of sprintf and strcat. Although OpenBSD warns about
several more, these other instances are demonstrably correct as-written and
are therefore unchanged.

------------------------------------------------------------------------
r1633 | adk0212 | 2008-08-03 11:13:33 -0400 (Sun, 03 Aug 2008) | 2 lines

Update Darwin build instructions for CPPFLAGS/CFLAGS/CXXFLAGS split.

------------------------------------------------------------------------
r1632 | adk0212 | 2008-08-03 11:00:05 -0400 (Sun, 03 Aug 2008) | 2 lines

gapcmon build fixes for new CPPFLAGS/CFLAGS/CXXFLAGS split.

------------------------------------------------------------------------
r1631 | adk0212 | 2008-08-03 10:51:57 -0400 (Sun, 03 Aug 2008) | 3 lines

Regen configure script on Linux. OpenBSD autoconf searches for X11
differently (and possibly incorrectly).

------------------------------------------------------------------------
r1630 | adk0212 | 2008-08-03 10:48:45 -0400 (Sun, 03 Aug 2008) | 4 lines

Fix configure warnings for gd.h by properly splitting compiler flags versus
preprocessor flags. CFLAGS=C compiler flags, CXXFLAGS=C++ compiler flags,
CPPFLAGS=C preprocessor flags.

------------------------------------------------------------------------
r1629 | adk0212 | 2008-08-02 19:13:28 -0400 (Sat, 02 Aug 2008) | 2 lines

Regen configure script from configure.in.

------------------------------------------------------------------------
r1628 | adk0212 | 2008-08-02 19:11:29 -0400 (Sat, 02 Aug 2008) | 3 lines

Fix cgi build on OpenBSD. libgd on OpenBSD requires X_LIBS for libfreetype
and libfontconfig.

------------------------------------------------------------------------
r1627 | adk0212 | 2008-07-25 10:17:51 -0400 (Fri, 25 Jul 2008) | 2 lines

Update ChangeLog after win32 exit fix.

------------------------------------------------------------------------
r1626 | adk0212 | 2008-07-25 09:18:03 -0400 (Fri, 25 Jul 2008) | 4 lines

Fix handling of old-style exit requests (WM_QUIT message to hidden window).
Apparently PeekMessage() is not sufficient, so go back to using GetMessage
and spawn a separate thread to watch for the global exit event.

------------------------------------------------------------------------
r1625 | adk0212 | 2008-07-24 16:29:33 -0400 (Thu, 24 Jul 2008) | 2 lines

Prep for 3.14.5 release.

------------------------------------------------------------------------
r1624 | adk0212 | 2008-07-24 16:12:58 -0400 (Thu, 24 Jul 2008) | 3 lines

Save $INSTDIR in registry for future use. Also remove examples/ directory
from install package since almost nothing in there applies to win32.

------------------------------------------------------------------------
r1623 | adk0212 | 2008-07-24 16:10:58 -0400 (Thu, 24 Jul 2008) | 2 lines

Remove another obsolete sample config.

------------------------------------------------------------------------
r1622 | adk0212 | 2008-07-24 16:08:18 -0400 (Thu, 24 Jul 2008) | 2 lines

Remove obsolete configuration examples.

------------------------------------------------------------------------
r1621 | skoona | 2008-07-12 22:51:13 -0400 (Sat, 12 Jul 2008) | 2 lines

Update the ChangeLog

------------------------------------------------------------------------
r1620 | skoona | 2008-07-12 22:32:21 -0400 (Sat, 12 Jul 2008) | 16 lines

Fix two of two: KDE issue,
because of the _iconify() api issue, _hide() was chosen.  _
hide() presents a useability issue where its possible hide all windows
in such a way that no artifact is visible for you to use to restore a window.

This is caused by the use of gtk_widget_hide() instead of gtk_window_iconify();
thus the only solution is to remove the close buttons off both the
main window and all monitor windows.  Its the close button that presents
the active-but-no-window effect.

Problem Cause: KDE Window Manager Behaviour Changed -- gtk_window_iconify() ignored.
Problem Resolved: Removed Close Button from all windows.
                 Switched to gtk_widget_hide() to manage window visibility.

James,

------------------------------------------------------------------------
r1619 | skoona | 2008-07-12 20:23:35 -0400 (Sat, 12 Jul 2008) | 2 lines

Part two of the kde fix failed.  Icon-mode works fine.  Window mode can find itself without a takslist entry and effecctively invisible with no way to recall the active program.

------------------------------------------------------------------------
r1618 | adk0212 | 2008-07-12 15:13:56 -0400 (Sat, 12 Jul 2008) | 2 lines

Update to nsis-2.38

------------------------------------------------------------------------
r1617 | skoona | 2008-07-12 13:53:54 -0400 (Sat, 12 Jul 2008) | 2 lines

Part two of two parts -- kde iconify fix

------------------------------------------------------------------------
r1616 | skoona | 2008-07-12 12:54:17 -0400 (Sat, 12 Jul 2008) | 2 lines

Part one of two parts -- kde iconify fix

------------------------------------------------------------------------
r1607 | adk0212 | 2008-06-29 11:12:10 -0400 (Sun, 29 Jun 2008) | 5 lines

Fix bug in LOWBATT glitch handling. We must examine LOWBATT for changes
every time thru the status loop, not just during the OnBattery state.
Otherwise we can miss the initial LOWBATT assertion, which defeats the
glitch rejection logic.

------------------------------------------------------------------------
r1606 | adk0212 | 2008-06-24 19:24:43 -0400 (Tue, 24 Jun 2008) | 2 lines

Silly spacing fix.

------------------------------------------------------------------------
r1605 | adk0212 | 2008-06-24 19:23:18 -0400 (Tue, 24 Jun 2008) | 3 lines

Fail configure if required tools are not found. Fix targets.mak to
reference a few more tools by variable instead of hardcoded name.

------------------------------------------------------------------------
r1604 | adk0212 | 2008-06-21 17:04:15 -0400 (Sat, 21 Jun 2008) | 3 lines

Clean up win32 compat. Remove unused functions and files. Remove wide char
support. Organize compat.h.

------------------------------------------------------------------------
r1603 | adk0212 | 2008-06-21 14:43:56 -0400 (Sat, 21 Jun 2008) | 6 lines

Improve apctray multiple instance behavior for /add, /del, and /kill on
modern platforms (Win2K and newer). Monitor registry for changes caused
by /add and /del and automatically reset when a change is detected. Also
ensure /kill will terminate all apctray instances, even those running in
other sessions.

------------------------------------------------------------------------
r1602 | adk0212 | 2008-06-19 18:23:50 -0400 (Thu, 19 Jun 2008) | 3 lines

Support shutting down apcupsd instances running in other sessions (such
as terminal services or remote desktop sessions).

------------------------------------------------------------------------
r1601 | adk0212 | 2008-06-15 14:11:06 -0400 (Sun, 15 Jun 2008) | 2 lines

Use 'tr' to strip trailing newline from 'echo' instead of 'echo -n'.

------------------------------------------------------------------------
r1600 | adk0212 | 2008-06-15 09:15:07 -0400 (Sun, 15 Jun 2008) | 2 lines

Update install to use new CHKCFG macro.

------------------------------------------------------------------------
r1599 | adk0212 | 2008-06-15 09:10:47 -0400 (Sun, 15 Jun 2008) | 2 lines

Update redhat to use new CHKCFG macro.

------------------------------------------------------------------------
r1598 | adk0212 | 2008-06-15 09:04:31 -0400 (Sun, 15 Jun 2008) | 2 lines

Fix harmless but annoying compiler warning on suse.

------------------------------------------------------------------------
r1597 | adk0212 | 2008-06-15 09:03:19 -0400 (Sun, 15 Jun 2008) | 7 lines

Fix 'make install' on suse. Sadly, suse's chkconfig always returns success
for --list even when the service does not exist. So we add a more
sophisticated chkconfig handler which tests for existence of the init
script manually, then invokes chkconfig. The whole thing is hidden behind
a macro. Also add CHKCONFIG definition (currently always /sbin/chkconfig)
in case we someday encounter a distro that hides it elsewhere.

------------------------------------------------------------------------
r1596 | adk0212 | 2008-06-11 07:47:13 -0400 (Wed, 11 Jun 2008) | 3 lines

Update PCNET info: minimum password length is 15 chars, default username
is 'apc', no known way to change the username.

------------------------------------------------------------------------
r1595 | adk0212 | 2008-06-11 07:39:43 -0400 (Wed, 11 Jun 2008) | 3 lines

Add a hex dump function and use it from pcnet and usb drivers instead of
manually coding ugly loops.

------------------------------------------------------------------------
r1594 | adk0212 | 2008-06-11 07:20:30 -0400 (Wed, 11 Jun 2008) | 2 lines

Add captured packets for testing PCNET driver.

------------------------------------------------------------------------
r1593 | adk0212 | 2008-06-09 21:22:47 -0400 (Mon, 09 Jun 2008) | 4 lines

Use $(ECHO). Important for 'echo -n' on some platforms, and we might as
well use it everywhere we use 'echo'. Thanks to Jeremy Daniel
<Jeremy.Daniel@brunel.ac.uk> for finding and fixing this on Mac OS X.

------------------------------------------------------------------------
r1592 | adk0212 | 2008-06-09 21:16:48 -0400 (Mon, 09 Jun 2008) | 3 lines

Remove conditional HAVE_NISLIB settings. HAVE_NISLIB is set already set
unconditionally.

------------------------------------------------------------------------
r1591 | adk0212 | 2008-06-01 17:57:56 -0400 (Sun, 01 Jun 2008) | 7 lines

Fix first install failure on redhat and suse. We were unconditionally
running 'chkconfig --del apcupsd' which failed if apcupsd was not already
installed. Now we check 'chkconfig --list apcupsd' first to see if
chkconfig believes apcupsd is installed. Make same fix in uninstall. Also
change most uninstall steps to allow failure. This facilitates the best-
effort uninstall of an aborted or otherwise botched install.

------------------------------------------------------------------------
r1590 | fleetworks | 2008-05-31 08:42:50 -0400 (Sat, 31 May 2008) | 2 lines

Add restart of daemon on upgrade.

------------------------------------------------------------------------
r1583 | adk0212 | 2008-05-25 14:46:34 -0400 (Sun, 25 May 2008) | 2 lines

Update for 3.14.4 release.

------------------------------------------------------------------------
r1581 | adk0212 | 2008-05-18 14:21:27 -0400 (Sun, 18 May 2008) | 2 lines

Update ChangeLog.

------------------------------------------------------------------------
r1580 | adk0212 | 2008-05-18 14:18:54 -0400 (Sun, 18 May 2008) | 3 lines

Fix init script location on SuSE. It should be /etc/rc.d, but we were
placing the file in /etc/rc.d/init.d.

------------------------------------------------------------------------
r1579 | adk0212 | 2008-05-18 13:16:48 -0400 (Sun, 18 May 2008) | 2 lines

Fix release date.

------------------------------------------------------------------------
r1578 | adk0212 | 2008-05-18 13:15:34 -0400 (Sun, 18 May 2008) | 2 lines

Prep for 3.14.4 release.

------------------------------------------------------------------------
r1577 | adk0212 | 2008-05-18 13:12:30 -0400 (Sun, 18 May 2008) | 2 lines

Add 'make install' support for man pages.

------------------------------------------------------------------------
r1576 | adk0212 | 2008-05-12 20:09:47 -0400 (Mon, 12 May 2008) | 2 lines

Remove obsolete files.

------------------------------------------------------------------------
r1575 | adk0212 | 2008-05-12 20:06:49 -0400 (Mon, 12 May 2008) | 2 lines

Update contributors list. This is probably still way out of date.

------------------------------------------------------------------------
r1574 | adk0212 | 2008-05-12 20:01:25 -0400 (Mon, 12 May 2008) | 2 lines

Remove references to powerflute.

------------------------------------------------------------------------
r1573 | adk0212 | 2008-05-11 18:34:37 -0400 (Sun, 11 May 2008) | 2 lines

Remove --with-powerflute flag from specs.

------------------------------------------------------------------------
r1572 | adk0212 | 2008-05-11 18:18:53 -0400 (Sun, 11 May 2008) | 2 lines

Remove old changelog.

------------------------------------------------------------------------
r1571 | adk0212 | 2008-05-11 17:00:55 -0400 (Sun, 11 May 2008) | 2 lines

Prep for 3.14.4 test release.

------------------------------------------------------------------------
r1570 | adk0212 | 2008-05-11 16:23:17 -0400 (Sun, 11 May 2008) | 2 lines

Remove unused file.

------------------------------------------------------------------------
r1569 | adk0212 | 2008-05-11 10:24:13 -0400 (Sun, 11 May 2008) | 2 lines

Update Mac OS X universal binary build instructions.

------------------------------------------------------------------------
r1568 | adk0212 | 2008-05-11 10:10:35 -0400 (Sun, 11 May 2008) | 2 lines

Remove unnecessary dependency includes.

------------------------------------------------------------------------
r1567 | adk0212 | 2008-05-11 09:56:51 -0400 (Sun, 11 May 2008) | 2 lines

Remove some obsolete Makefile.in

------------------------------------------------------------------------
r1566 | adk0212 | 2008-05-11 09:56:16 -0400 (Sun, 11 May 2008) | 2 lines

New Makefile for examples/ and source fixes to build with C++ compiler.

------------------------------------------------------------------------
r1565 | adk0212 | 2008-05-10 20:10:48 -0400 (Sat, 10 May 2008) | 2 lines

Micor cleanups: Rename 'INST' to 'COPY'. Remove extraneous semicolons.

------------------------------------------------------------------------
r1564 | adk0212 | 2008-05-10 20:07:52 -0400 (Sat, 10 May 2008) | 5 lines

Better solution for install ordering. Invoke make explicitly to build
targets and then again to perform the install. This is just an extension
of the same trick used to force 'all' to build subdirs before local
targets.

------------------------------------------------------------------------
r1563 | adk0212 | 2008-05-10 13:54:40 -0400 (Sat, 10 May 2008) | 4 lines

Fix parallel 'make install' from an unbuilt tree. Requires manually making
install-* depend on all-targets. I'd prefer this be done automatically but
I cannot find a way that works (yet).

------------------------------------------------------------------------
r1562 | adk0212 | 2008-05-10 11:19:09 -0400 (Sat, 10 May 2008) | 2 lines

Do not perform platform install in parallel.

------------------------------------------------------------------------
r1561 | adk0212 | 2008-05-10 11:18:43 -0400 (Sat, 10 May 2008) | 2 lines

Recurse into platforms/ after src/.

------------------------------------------------------------------------
r1560 | adk0212 | 2008-05-10 10:52:46 -0400 (Sat, 10 May 2008) | 2 lines

Install banners for alpha.

------------------------------------------------------------------------
r1559 | adk0212 | 2008-05-10 10:51:15 -0400 (Sat, 10 May 2008) | 2 lines

Add banners to 'make install'.

------------------------------------------------------------------------
r1558 | adk0212 | 2008-05-10 10:47:37 -0400 (Sat, 10 May 2008) | 2 lines

Tweak install/uninstall banner spacing.

------------------------------------------------------------------------
r1557 | adk0212 | 2008-05-10 10:47:19 -0400 (Sat, 10 May 2008) | 2 lines

'make install' support for unifix and yellowdog.

------------------------------------------------------------------------
r1556 | adk0212 | 2008-05-09 20:04:45 -0400 (Fri, 09 May 2008) | 3 lines

'make install' support for SuSE. Plus remove some bitrotted platform
files for SuSE 8.x.

------------------------------------------------------------------------
r1555 | adk0212 | 2008-05-09 19:39:56 -0400 (Fri, 09 May 2008) | 2 lines

'make install' support for sun.

------------------------------------------------------------------------
r1554 | adk0212 | 2008-05-08 19:37:16 -0400 (Thu, 08 May 2008) | 2 lines

Do not autogenerate platform/*/Makefile any more.

------------------------------------------------------------------------
r1553 | adk0212 | 2008-05-08 19:36:45 -0400 (Thu, 08 May 2008) | 2 lines

Add install/uninstall banner macros.

------------------------------------------------------------------------
r1552 | adk0212 | 2008-05-08 19:36:07 -0400 (Thu, 08 May 2008) | 2 lines

Add some path variables needed by platform install scripts.

------------------------------------------------------------------------
r1551 | adk0212 | 2008-05-08 19:35:21 -0400 (Thu, 08 May 2008) | 2 lines

'make install' support for gentoo, hpux, mandrake, slackware.

------------------------------------------------------------------------
r1550 | adk0212 | 2008-05-08 18:57:15 -0400 (Thu, 08 May 2008) | 2 lines

'make install' support for *BSD

------------------------------------------------------------------------
r1549 | skoona | 2008-05-06 20:16:56 -0400 (Tue, 06 May 2008) | 2 lines

Corrected the use of NOMPOWER and the calc of current usage amount

------------------------------------------------------------------------
r1548 | adk0212 | 2008-05-04 11:30:42 -0400 (Sun, 04 May 2008) | 3 lines

Remove powerflute option from configure. Powerflute has been broken for
several releases after the removal of rawupsstats support from NIS

------------------------------------------------------------------------
r1547 | adk0212 | 2008-05-04 11:13:57 -0400 (Sun, 04 May 2008) | 4 lines

Add a heuristic to fix up incorrect NOMINV or NOMOUTV. Some UPSes (RS 500)
report decivolts instead of volts. Reported by Kirill S. Bychkov
<yason@linklevel.net>.

------------------------------------------------------------------------
r1546 | adk0212 | 2008-05-04 10:43:27 -0400 (Sun, 04 May 2008) | 2 lines

Update to NSIS 2.37.

------------------------------------------------------------------------
r1545 | adk0212 | 2008-05-04 10:43:12 -0400 (Sun, 04 May 2008) | 3 lines

Add win32/Makefile to generate list. Necessary since we're not rewriting
the win32 Makefile stuff yet.

------------------------------------------------------------------------
r1544 | skoona | 2008-04-20 19:03:10 -0400 (Sun, 20 Apr 2008) | 13 lines


- Removed close() fron sknet_net_close() api.  g_io_channel_shutdown()
  handled the close and shutdown of the socket.  second close was
  actually closing an active socket from another thread (i.e. reuse #)
  discovered on a quad-core platform.

- Added ICON_DIR to compiler makefiles to support _load_icons
  ability to find icons at run-time.  $(datadir) is passed into
  ICON_DIR; its assumed datadir include $(DISTDIR).  This change
  was pointed out by Kirill S. Bychkov in Feb/2008.

James,

------------------------------------------------------------------------
r1543 | adk0212 | 2008-04-19 10:12:46 -0400 (Sat, 19 Apr 2008) | 2 lines

Remove mention of serial port since there are many other comms types now.

------------------------------------------------------------------------
r1542 | adk0212 | 2008-04-07 19:03:13 -0400 (Mon, 07 Apr 2008) | 3 lines

Add 'make install' support for alpha, darwin, debian, engarde, and unknown.
Also misc fixes to existing install support.

------------------------------------------------------------------------
r1541 | adk0212 | 2008-04-06 20:24:38 -0400 (Sun, 06 Apr 2008) | 2 lines

Don't autogenerate redhat Makefile.

------------------------------------------------------------------------
r1540 | adk0212 | 2008-04-06 19:35:52 -0400 (Sun, 06 Apr 2008) | 2 lines

Remove unused files: Various Makefile.in, gd1.2/, intl/, po/.

------------------------------------------------------------------------
r1539 | adk0212 | 2008-04-06 19:09:02 -0400 (Sun, 06 Apr 2008) | 2 lines

Remove unused file.

------------------------------------------------------------------------
r1538 | adk0212 | 2008-04-06 19:07:43 -0400 (Sun, 06 Apr 2008) | 3 lines

First round of 'make install' implementation. Basic install/uninstall is
working. Only platform implemented so far is redhat.

------------------------------------------------------------------------
r1537 | adk0212 | 2008-04-04 19:11:15 -0400 (Fri, 04 Apr 2008) | 2 lines

Fix clean output on Solaris.

------------------------------------------------------------------------
r1536 | adk0212 | 2008-04-04 19:01:03 -0400 (Fri, 04 Apr 2008) | 5 lines

Fix gapcmon build on OpenSolaris. On OpenSolaris, gethostbyname_r() is in
libnsl. Also fix up some tests in configure to use AC_SEARCH_LIBS. Thanks
to James Dean <jgmdean@gmail.com> for loaning me an ssh login on his
OpenSolaris box.

------------------------------------------------------------------------
r1535 | adk0212 | 2008-04-02 18:55:31 -0400 (Wed, 02 Apr 2008) | 7 lines

Add new make system
- configure and build works (including dependencies and parallel make)
- 'make install' not yet implemented
- i18n support removed
- included libgd support removed
- obsolete Makefile.in files will remain until 'make install' is complete

------------------------------------------------------------------------
r1533 | adk0212 | 2008-02-06 17:53:36 -0500 (Wed, 06 Feb 2008) | 4 lines

Fix hal policy file syntax. For some reason this blatantly incorrect file
actually works on RHEL5 (hal-0.5.8). Thanks to Andrew Telford
<a.telford@ieee.org> for correcting it.

------------------------------------------------------------------------
r1532 | adk0212 | 2008-02-03 16:37:01 -0500 (Sun, 03 Feb 2008) | 2 lines

Revert ctime_r() change. It is not actually necessary.

------------------------------------------------------------------------
r1531 | adk0212 | 2008-02-03 15:48:14 -0500 (Sun, 03 Feb 2008) | 2 lines

Fix gapcmon compile error on Solaris: Multiple variants of ctime_r().

------------------------------------------------------------------------
r1530 | adk0212 | 2008-02-03 15:32:25 -0500 (Sun, 03 Feb 2008) | 2 lines

Fix libapcnis.c compile error on Solaris.

------------------------------------------------------------------------
r1529 | fleetworks | 2008-02-03 12:22:31 -0500 (Sun, 03 Feb 2008) | 2 lines

Add debug package to strip suse.

------------------------------------------------------------------------
r1528 | adk0212 | 2008-01-29 19:01:20 -0500 (Tue, 29 Jan 2008) | 2 lines

Fix build on OpenBSD: Need to include netinet/in.h for struct sockaddr_in.

------------------------------------------------------------------------
r1527 | adk0212 | 2008-01-28 21:14:57 -0500 (Mon, 28 Jan 2008) | 3 lines

Add fake (not thread-safe) gethostbyname_r() for platforms that don't have
it. I'm looking at you, OpenBSD.

------------------------------------------------------------------------
r1526 | adk0212 | 2008-01-27 12:00:32 -0500 (Sun, 27 Jan 2008) | 3 lines

Add POLLTIME directive to control UPS polling interval. NETTIME is accepted
as a synonym for compatibility with old config files.

------------------------------------------------------------------------
r1525 | adk0212 | 2008-01-27 11:22:58 -0500 (Sun, 27 Jan 2008) | 4 lines

Sanify net error handling. All net library functions now return -errno on
failure. Kill off global net_errno and net_errmsg. Improve apcaccess error
messages.

------------------------------------------------------------------------
r1523 | adk0212 | 2008-01-27 09:56:56 -0500 (Sun, 27 Jan 2008) | 2 lines

Another missing update.

------------------------------------------------------------------------
r1522 | adk0212 | 2008-01-27 09:49:42 -0500 (Sun, 27 Jan 2008) | 2 lines

Fix compile errors from incomplete input vs feature report conversion.

------------------------------------------------------------------------
r1514 | adk0212 | 2008-01-22 20:10:08 -0500 (Tue, 22 Jan 2008) | 3 lines

Debian is now using the standard NIS port, 3551.
Contributed by imacat <imacat@mail.imacat.idv.tw>

------------------------------------------------------------------------
r1513 | adk0212 | 2008-01-20 14:58:56 -0500 (Sun, 20 Jan 2008) | 2 lines

Update web site for 3.14.3.

------------------------------------------------------------------------
r1511 | adk0212 | 2008-01-19 16:48:36 -0500 (Sat, 19 Jan 2008) | 2 lines

Updates for 3.14.3 release.

------------------------------------------------------------------------
r1510 | adk0212 | 2008-01-19 13:43:52 -0500 (Sat, 19 Jan 2008) | 2 lines

Merge gapcmon changes from HEAD 1.41.

------------------------------------------------------------------------
r1509 | adk0212 | 2007-12-02 11:38:02 -0500 (Sun, 02 Dec 2007) | 2 lines

Fix compile warning.

------------------------------------------------------------------------
r1508 | adk0212 | 2007-11-29 19:49:02 -0500 (Thu, 29 Nov 2007) | 3 lines

Update build instructions for XCode3/Leopard. Many thanks to Dennis Wurster
<dwurster@gmail.com> for loaning me a Leopard-capable G4 to develop on.

------------------------------------------------------------------------
r1507 | adk0212 | 2007-11-21 17:09:30 -0500 (Wed, 21 Nov 2007) | 7 lines

Fix bugs that could cause NIS-net driver to get stuck waiting for comms
to be restored instead of shutting down. This included adding a timeout
for connection attempts in net_open() and removing a wait-for-comms loop
from the net driver. Also fix up fallout from apclibnis cleanups in
apcaccess. Thanks to Daniel Born <born_daniel@yahoo.com> for reporting
the issue and testing fixes.

------------------------------------------------------------------------
r1506 | adk0212 | 2007-11-21 17:05:03 -0500 (Wed, 21 Nov 2007) | 7 lines

Add configure parameter to control location of HAL policy file. Install
policy file to this path. By default, the policy file is only installed on
Linux systems. Other platforms need to specify --with-halpolicydir=DIR to
configure. Linux systems can use this same switch to change the default
install path.
(Files missed in last commit.)

------------------------------------------------------------------------
r1504 | fleetworks | 2007-11-18 10:25:13 -0500 (Sun, 18 Nov 2007) | 2 lines

Add halpolicydir to configure statement.

------------------------------------------------------------------------
r1503 | fleetworks | 2007-11-18 10:18:49 -0500 (Sun, 18 Nov 2007) | 2 lines

Make installs the hal policy file now.

------------------------------------------------------------------------
r1502 | adk0212 | 2007-11-17 14:09:23 -0500 (Sat, 17 Nov 2007) | 6 lines

Add configure parameter to control location of HAL policy file. Install
policy file to this path. By default, the policy file is only installed on
Linux systems. Other platforms need to specify --with-halpolicydir=DIR to
configure. Linux systems can use this same switch to change the default
install path.

------------------------------------------------------------------------
r1501 | adk0212 | 2007-11-17 14:06:38 -0500 (Sat, 17 Nov 2007) | 2 lines

Revert HAL policy file change. We'll do this at a higher level instead.

------------------------------------------------------------------------
r1500 | fleetworks | 2007-11-17 10:48:06 -0500 (Sat, 17 Nov 2007) | 2 lines

Add hal policy file.

------------------------------------------------------------------------
r1499 | fleetworks | 2007-11-17 10:46:35 -0500 (Sat, 17 Nov 2007) | 2 lines

Add hal policy file.

------------------------------------------------------------------------
r1498 | adk0212 | 2007-11-17 10:00:27 -0500 (Sat, 17 Nov 2007) | 2 lines

Upgrade to nsis-2.33.

------------------------------------------------------------------------
r1497 | adk0212 | 2007-11-17 09:48:25 -0500 (Sat, 17 Nov 2007) | 2 lines

Remove extraneous comment close tag.

------------------------------------------------------------------------
r1496 | adk0212 | 2007-11-17 09:34:46 -0500 (Sat, 17 Nov 2007) | 3 lines

Add policy file to disable hald-addon-hid-ups. Automatically install and
uninstall this policy on Redhat systems.

------------------------------------------------------------------------
r1495 | adk0212 | 2007-11-13 18:23:15 -0500 (Tue, 13 Nov 2007) | 2 lines

Fix debian package URLs. Found by Chris Reeves <chris@astro.ex.ac.uk>.

------------------------------------------------------------------------
r1494 | fleetworks | 2007-11-10 08:17:46 -0500 (Sat, 10 Nov 2007) | 2 lines

Update for suse 10.3

------------------------------------------------------------------------
r1493 | adk0212 | 2007-11-09 18:34:48 -0500 (Fri, 09 Nov 2007) | 2 lines

Update to nsis-2.32.

------------------------------------------------------------------------
r1492 | adk0212 | 2007-10-30 18:46:49 -0400 (Tue, 30 Oct 2007) | 2 lines

Fix changelog links for 3.14.2.

------------------------------------------------------------------------
r1491 | adk0212 | 2007-10-27 13:15:14 -0400 (Sat, 27 Oct 2007) | 2 lines

Missed part of write report conversion.

------------------------------------------------------------------------
r1490 | adk0212 | 2007-10-27 13:14:24 -0400 (Sat, 27 Oct 2007) | 2 lines

Add support for reading/writing transfer voltage on USB models.

------------------------------------------------------------------------
r1489 | adk0212 | 2007-10-27 13:13:15 -0400 (Sat, 27 Oct 2007) | 5 lines

When reading, use INPUT or FEATURE report (prefer INPUT).
When writing, use FEATURE report only.
This is necessary to properly support writes on UPSes that offer the same
usage in both types of reports.

------------------------------------------------------------------------
r1481 | adk0212 | 2007-10-06 10:54:23 -0400 (Sat, 06 Oct 2007) | 4 lines

Eliminate "warning: deprecated conversion from string constant to 'char*'"
warnings emitted from gcc-4.2.1 (earlier versions with -Wwrite-strings).
Contributed by Steve Yarmie <tribhuvanji@gmail.com>.

------------------------------------------------------------------------
r1475 | adk0212 | 2007-09-30 15:45:37 -0400 (Sun, 30 Sep 2007) | 2 lines

Merge gapcmon changes from HEAD.

------------------------------------------------------------------------
r1472 | adk0212 | 2007-09-22 13:35:27 -0400 (Sat, 22 Sep 2007) | 2 lines

Add units to NOMINV, NOMOUTV, and NOMBATTV stats.

------------------------------------------------------------------------
r1471 | adk0212 | 2007-09-22 13:33:29 -0400 (Sat, 22 Sep 2007) | 3 lines

Add support for Nominal Power (aka Configured Active Power) reading.
Credit to Lars Randers <lars@nstec.dk> for most of the code.

------------------------------------------------------------------------
r1470 | adk0212 | 2007-09-22 13:10:16 -0400 (Sat, 22 Sep 2007) | 2 lines

Convert eleventy skillion CI_* defines to an enumeration.

------------------------------------------------------------------------
r1469 | adk0212 | 2007-09-22 08:48:35 -0400 (Sat, 22 Sep 2007) | 2 lines

Update web site for 3.14.2 release.

------------------------------------------------------------------------
r1467 | adk0212 | 2007-09-15 17:07:10 -0400 (Sat, 15 Sep 2007) | 2 lines

Update ChangeLog, ReleaseNotes, and date for 3.14.2 release.

------------------------------------------------------------------------
r1466 | adk0212 | 2007-09-15 10:48:35 -0400 (Sat, 15 Sep 2007) | 2 lines

Remove commented-out code.

------------------------------------------------------------------------
r1465 | adk0212 | 2007-09-15 10:48:16 -0400 (Sat, 15 Sep 2007) | 2 lines

Misc cleanup.

------------------------------------------------------------------------
r1464 | adk0212 | 2007-09-15 10:48:00 -0400 (Sat, 15 Sep 2007) | 2 lines

Fix handle leaks when adding/deleting instances.

------------------------------------------------------------------------
r1463 | adk0212 | 2007-09-10 19:35:00 -0400 (Mon, 10 Sep 2007) | 2 lines

Update NSIS to 2.30.

------------------------------------------------------------------------
r1462 | adk0212 | 2007-09-10 19:31:16 -0400 (Mon, 10 Sep 2007) | 2 lines

Bump version to 3.14.2.

------------------------------------------------------------------------
r1461 | adk0212 | 2007-09-10 19:09:49 -0400 (Mon, 10 Sep 2007) | 5 lines

Prefer FEATURE reports over INPUT reports when searching for usages. This
will fix compatiblity with BackUPS LCD models which have present but non-
functional INPUT reports. It may break compatibility with other models, so
fingers are crossed.

------------------------------------------------------------------------
r1460 | adk0212 | 2007-09-10 19:08:12 -0400 (Mon, 10 Sep 2007) | 2 lines

Minor cleanup and spelling fix.

------------------------------------------------------------------------
r1459 | adk0212 | 2007-08-28 19:57:51 -0400 (Tue, 28 Aug 2007) | 5 lines

Address g++ linker vs. libsupc++ differently: Default linker to gcc if
none is specified. This avoids overriding LD= passed to configure since if
the user asks for an explicit LD we really should honor it (and it's needed
for building universal binaries on OS X).

------------------------------------------------------------------------
r1458 | adk0212 | 2007-08-28 19:02:22 -0400 (Tue, 28 Aug 2007) | 3 lines

Remove dependency on libc++ (again). Must use gcc as linker when using
libsupc++ since g++ automatically links against full libc++.

------------------------------------------------------------------------
r1457 | adk0212 | 2007-08-25 15:01:34 -0400 (Sat, 25 Aug 2007) | 5 lines

Fix race between attach_ups() and detach_ups() which could result in the
UPSINFO structure being freed prematurely. Thanks to James Abbott
<j.abbott@imperial.ac.uk> for running many tests to help me find this
bug.

------------------------------------------------------------------------
r1456 | adk0212 | 2007-08-23 18:43:08 -0400 (Thu, 23 Aug 2007) | 4 lines

Correct multimon.conf humidity monitoring.
Problem fixed by Patrick Frei.
Reference: https://bugzilla.novell.com/show_bug.cgi?id=199834

------------------------------------------------------------------------
r1455 | adk0212 | 2007-08-06 20:17:20 -0400 (Mon, 06 Aug 2007) | 2 lines

Exit apctray if GetMessage() returns an error.

------------------------------------------------------------------------
r1454 | adk0212 | 2007-08-06 20:16:37 -0400 (Mon, 06 Aug 2007) | 2 lines

Use enum for application-defined messages.

------------------------------------------------------------------------
r1453 | adk0212 | 2007-08-06 20:16:15 -0400 (Mon, 06 Aug 2007) | 2 lines

Redraw tray icons politely after an Explorer crash.

------------------------------------------------------------------------
r1452 | adk0212 | 2007-08-05 17:31:56 -0400 (Sun, 05 Aug 2007) | 5 lines

Fix bug with multi-threaded net_open() calls. net_open() was using a global
buffer for the destination address. Yikes! Bug manifestied itself in
apctray with multiple monitors occasionally (and timing-dependently)
pointing to the wrong UPS.

------------------------------------------------------------------------
r1451 | adk0212 | 2007-08-03 15:08:59 -0400 (Fri, 03 Aug 2007) | 2 lines

More argvalue to its primary user, apcconfig.c.

------------------------------------------------------------------------
r1450 | adk0212 | 2007-08-03 15:08:26 -0400 (Fri, 03 Aug 2007) | 4 lines

Remove SO_REUSEADDR; we'd only need this for TCP. Set SO_BROADCAST since
some platforms (Windows) seem to require it in order to receive broadcast
packets. (Most platforms use it only to enable *sending* broadcasts.)

------------------------------------------------------------------------
r1449 | adk0212 | 2007-08-03 14:41:05 -0400 (Fri, 03 Aug 2007) | 2 lines

Don't leak unnecessary descriptors to child when execing apccontrol.

------------------------------------------------------------------------
r1448 | adk0212 | 2007-08-03 13:52:05 -0400 (Fri, 03 Aug 2007) | 3 lines

Documentation updates: Fix up udev info for modern Linux distros. Update
Windows section for apctray.

------------------------------------------------------------------------
r1447 | adk0212 | 2007-08-03 11:49:24 -0400 (Fri, 03 Aug 2007) | 5 lines

Wait 20 seconds before declaring COMMLOST. This is necessary when using
a smart serial cable on an UPS with an SNMP monitoring card installed. The
SNMP card appears to disrupt serial comms for several seconds when
interesting events are in progress.

------------------------------------------------------------------------
r1446 | adk0212 | 2007-08-03 11:47:22 -0400 (Fri, 03 Aug 2007) | 2 lines

Add command help key since I can never remember what the keycodes are.

------------------------------------------------------------------------
r1445 | adk0212 | 2007-08-03 11:20:29 -0400 (Fri, 03 Aug 2007) | 4 lines

apccontrol cleanups: powerout and mainsback should not wall; that is done
by onbattery/offbattery under the control of ONBATTERYDELAY. Also remove
obsolete 'restartme' event from scripts and documentation.

------------------------------------------------------------------------
r1444 | adk0212 | 2007-08-03 11:17:38 -0400 (Fri, 03 Aug 2007) | 2 lines

Remove lots of obsolete code. 'status' is now the only supported option.

------------------------------------------------------------------------
r1443 | adk0212 | 2007-08-01 19:05:51 -0400 (Wed, 01 Aug 2007) | 3 lines

Enable SO_REUSEADDR on pcnet socket to prevent false EADDRINUSE after quick
restarts.

------------------------------------------------------------------------
r1442 | adk0212 | 2007-07-26 16:36:28 -0400 (Thu, 26 Jul 2007) | 2 lines

Remove duplicate line. Noticed by David P. Mott <dpmott@sep.com>.

------------------------------------------------------------------------
r1441 | adk0212 | 2007-07-20 12:17:34 -0400 (Fri, 20 Jul 2007) | 2 lines

Add support for simulating comm failure.

------------------------------------------------------------------------
r1440 | adk0212 | 2007-07-17 18:54:25 -0400 (Tue, 17 Jul 2007) | 2 lines

Include /dev in hiddev search.

------------------------------------------------------------------------
r1439 | adk0212 | 2007-07-17 18:50:25 -0400 (Tue, 17 Jul 2007) | 3 lines

Report time delta from start of program when displaying events.
Contributed by David Fries <david@fries.net>.

------------------------------------------------------------------------
r1438 | adk0212 | 2007-07-16 20:28:09 -0400 (Mon, 16 Jul 2007) | 3 lines

Add workaround for broken BackUPS Pro model that returns certain reports
encoded in ASCII. Based on a patch from David Fries <David@Fries.net>.

------------------------------------------------------------------------
r1437 | adk0212 | 2007-07-14 13:26:26 -0400 (Sat, 14 Jul 2007) | 2 lines

Add/remove tray icons on the fly as instances are added or deleted.

------------------------------------------------------------------------
r1436 | adk0212 | 2007-07-14 13:05:22 -0400 (Sat, 14 Jul 2007) | 2 lines

Add HOST field showing hostname:port to context menu.

------------------------------------------------------------------------
r1435 | adk0212 | 2007-07-14 13:04:52 -0400 (Sat, 14 Jul 2007) | 2 lines

Update NSIS to version 2.29.

------------------------------------------------------------------------
r1434 | adk0212 | 2007-07-14 12:53:31 -0400 (Sat, 14 Jul 2007) | 2 lines

Disable autorun when last instance removed.

------------------------------------------------------------------------
r1433 | adk0212 | 2007-07-01 14:30:32 -0400 (Sun, 01 Jul 2007) | 4 lines

Fix SNMP port selection. Newer versions of Net-SNMP appear to ignore the
session remote_port setting. The only way to override the default port is
to include it in the peername string.

------------------------------------------------------------------------
r1432 | adk0212 | 2007-06-29 18:18:41 -0400 (Fri, 29 Jun 2007) | 4 lines

Fix linux-usb device detection bug when multiple hiddev nodes are present.
Fixes Fedora Bugzilla #245864:
<https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=245864>

------------------------------------------------------------------------
r1431 | adk0212 | 2007-06-19 20:43:23 -0400 (Tue, 19 Jun 2007) | 2 lines

Update for 3.14.2-win32beta2 release.

------------------------------------------------------------------------
r1429 | adk0212 | 2007-06-18 20:23:41 -0400 (Mon, 18 Jun 2007) | 2 lines

Regen ChangeLog after committing forgotten files.

------------------------------------------------------------------------
r1428 | adk0212 | 2007-06-18 19:49:45 -0400 (Mon, 18 Jun 2007) | 2 lines

Change CMD* definitions to enumeration.

------------------------------------------------------------------------
r1427 | adk0212 | 2007-06-18 19:49:20 -0400 (Mon, 18 Jun 2007) | 2 lines

Remove unused CMDDOREBOOT.

------------------------------------------------------------------------
r1426 | adk0212 | 2007-06-18 19:47:13 -0400 (Mon, 18 Jun 2007) | 2 lines

Remove unused code.

------------------------------------------------------------------------
r1425 | adk0212 | 2007-06-18 19:45:52 -0400 (Mon, 18 Jun 2007) | 2 lines

Regen ChangeLog for 3.14.2-win32beta2.

------------------------------------------------------------------------
r1424 | adk0212 | 2007-06-18 19:38:34 -0400 (Mon, 18 Jun 2007) | 2 lines

Update for 3.14.2-win32beta2 release.

------------------------------------------------------------------------
r1423 | adk0212 | 2007-06-17 20:19:24 -0400 (Sun, 17 Jun 2007) | 2 lines

Change StatMgr::Get() to return a managed string.

------------------------------------------------------------------------
r1422 | adk0212 | 2007-06-17 20:14:20 -0400 (Sun, 17 Jun 2007) | 2 lines

Clean up apctray needless inlining and memory management.

------------------------------------------------------------------------
r1421 | adk0212 | 2007-06-17 19:49:45 -0400 (Sun, 17 Jun 2007) | 2 lines

Cleanup.

------------------------------------------------------------------------
r1420 | adk0212 | 2007-06-17 19:47:08 -0400 (Sun, 17 Jun 2007) | 2 lines

Gracefully handle unexpected return values from WaitForMultipleObjects().

------------------------------------------------------------------------
r1419 | adk0212 | 2007-06-17 16:07:23 -0400 (Sun, 17 Jun 2007) | 5 lines

Remove balloon notice support from popup utility. Furthermore, only display
popup if we're on an ancient OS, apctray is not running, or balloon tips
are disabled via a group policy. This way win98 and NT users will still
get notifications of events, as will users not running apctray.

------------------------------------------------------------------------
r1418 | adk0212 | 2007-06-17 15:54:06 -0400 (Sun, 17 Jun 2007) | 4 lines

Misc improvements: Detect self-test and set status string accordingly.
Include UPS name in tool tip, when we know it. Change status string for
NIS connection errors to distinguish that state from COMMLOST.

------------------------------------------------------------------------
r1417 | adk0212 | 2007-06-17 15:19:56 -0400 (Sun, 17 Jun 2007) | 2 lines

Windows NT doesn't like the "Global\\" prefix on semaphore names.

------------------------------------------------------------------------
r1416 | adk0212 | 2007-06-17 13:19:54 -0400 (Sun, 17 Jun 2007) | 2 lines

Fix bug where COMMLOST status transition was not reflected by icon.

------------------------------------------------------------------------
r1415 | adk0212 | 2007-06-17 13:15:08 -0400 (Sun, 17 Jun 2007) | 2 lines

Suppress initial status balloon.

------------------------------------------------------------------------
r1414 | adk0212 | 2007-06-17 13:12:33 -0400 (Sun, 17 Jun 2007) | 2 lines

Misc cleanup.

------------------------------------------------------------------------
r1413 | adk0212 | 2007-06-17 12:14:39 -0400 (Sun, 17 Jun 2007) | 10 lines

Completely rewrite balloon tip handling. Balloon tips are posted
automatically when the status text changes. This eliminates the need for
the clunky "Receive local notifications" setting and allows us to post
balloons for state changes on remote Apcupsd instances. Introduce the
BalloonMgr to work around Windows one-balloon-at-a-time limitation. When
monitoring multiple Apcupsd instances it will be common to need to post
multiple balloon tips at once. The BalloonMgr handles posting the tips
one at a time and timing the active balloon out early if new ones are
waiting. This way all balloons will be shown, one after another.

------------------------------------------------------------------------
r1412 | adk0212 | 2007-06-17 09:42:54 -0400 (Sun, 17 Jun 2007) | 2 lines

Add support for simulating battery attach/detach.

------------------------------------------------------------------------
r1411 | adk0212 | 2007-06-17 08:54:10 -0400 (Sun, 17 Jun 2007) | 2 lines

Fix indentation.

------------------------------------------------------------------------
r1410 | adk0212 | 2007-06-13 20:07:45 -0400 (Wed, 13 Jun 2007) | 2 lines

Reverse order of events in listbox so most recent is always at the top.

------------------------------------------------------------------------
r1409 | adk0212 | 2007-06-13 18:35:57 -0400 (Wed, 13 Jun 2007) | 3 lines

Use NotifyUser when notifying about multiple instances so it obeys the
/quiet flag.

------------------------------------------------------------------------
r1408 | adk0212 | 2007-06-13 18:34:08 -0400 (Wed, 13 Jun 2007) | 2 lines

Prevent multiple instances of Apctray.

------------------------------------------------------------------------
r1407 | adk0212 | 2007-06-13 18:29:08 -0400 (Wed, 13 Jun 2007) | 2 lines

Use some STL to simplify GetAll() and GetEvents() calls.

------------------------------------------------------------------------
r1406 | adk0212 | 2007-06-10 16:05:56 -0400 (Sun, 10 Jun 2007) | 2 lines

Fix indentation.

------------------------------------------------------------------------
r1405 | adk0212 | 2007-06-10 16:05:43 -0400 (Sun, 10 Jun 2007) | 2 lines

Add refresh button to events box.

------------------------------------------------------------------------
r1404 | adk0212 | 2007-06-10 16:04:55 -0400 (Sun, 10 Jun 2007) | 2 lines

Add refresh button list stats now has.

------------------------------------------------------------------------
r1403 | adk0212 | 2007-06-10 14:03:31 -0400 (Sun, 10 Jun 2007) | 2 lines

Update web site for 3.14.2-beta1 release.

------------------------------------------------------------------------
r1401 | adk0212 | 2007-06-10 10:13:19 -0400 (Sun, 10 Jun 2007) | 2 lines

Final updates for apcupsd-3.14.2-win32beta1 release.

------------------------------------------------------------------------
r1400 | adk0212 | 2007-06-10 09:34:26 -0400 (Sun, 10 Jun 2007) | 2 lines

Misc updates and small bug fixes.

------------------------------------------------------------------------
r1399 | adk0212 | 2007-06-10 09:33:18 -0400 (Sun, 10 Jun 2007) | 3 lines

Updates for multi-instance apctray. Remove apctray parameter customization
option for now.

------------------------------------------------------------------------
r1398 | adk0212 | 2007-06-09 21:34:12 -0400 (Sat, 09 Jun 2007) | 3 lines

More multiple instance improvements. Also add refresh button to detailed
status dialog.

------------------------------------------------------------------------
r1397 | adk0212 | 2007-06-09 20:02:35 -0400 (Sat, 09 Jun 2007) | 2 lines

More changes for better multiple monitor support.

------------------------------------------------------------------------
r1396 | adk0212 | 2007-06-09 15:47:08 -0400 (Sat, 09 Jun 2007) | 4 lines

Major rework to support monitoring multiple apcupsds with a single apctray
instantiation. Includes basic management of monitoring instances. More
fancy stuff to come.

------------------------------------------------------------------------
r1395 | adk0212 | 2007-06-07 19:43:08 -0400 (Thu, 07 Jun 2007) | 3 lines

Updates for running multiple apctray instances simultaneously and properly
shutting them down.

------------------------------------------------------------------------
r1394 | adk0212 | 2007-06-06 22:11:31 -0400 (Wed, 06 Jun 2007) | 2 lines

Fix timeout bug.

------------------------------------------------------------------------
r1393 | adk0212 | 2007-06-06 22:06:47 -0400 (Wed, 06 Jun 2007) | 2 lines

Shutdown status polling thread cleanly.

------------------------------------------------------------------------
r1392 | adk0212 | 2007-06-06 22:05:36 -0400 (Wed, 06 Jun 2007) | 3 lines

Grab lock during destruction to prevent further operations.
Also add copyright blocks.

------------------------------------------------------------------------
r1391 | adk0212 | 2007-06-06 21:26:12 -0400 (Wed, 06 Jun 2007) | 3 lines

Reuse sockets in StatMgr. This prevents build-up of large numbers of
sockets in the TIME_WAIT state. Also implement proper locking.

------------------------------------------------------------------------
r1390 | adk0212 | 2007-06-06 19:53:11 -0400 (Wed, 06 Jun 2007) | 2 lines

Kill FillEventsBox function and associated grunge that is no longer used.

------------------------------------------------------------------------
r1389 | adk0212 | 2007-06-06 19:49:32 -0400 (Wed, 06 Jun 2007) | 2 lines

Remove unused file.

------------------------------------------------------------------------
r1388 | adk0212 | 2007-06-06 19:48:05 -0400 (Wed, 06 Jun 2007) | 2 lines

Remove unused files.

------------------------------------------------------------------------
r1387 | adk0212 | 2007-06-06 19:44:03 -0400 (Wed, 06 Jun 2007) | 2 lines

Build object files in obj/ to reduce source dir clutter.

------------------------------------------------------------------------
r1386 | adk0212 | 2007-06-06 18:53:44 -0400 (Wed, 06 Jun 2007) | 3 lines

Move installer files to installer/ directory. There are enough of them now
that we should stop cluttering the main win32 source dir.

------------------------------------------------------------------------
r1385 | adk0212 | 2007-06-06 18:29:10 -0400 (Wed, 06 Jun 2007) | 2 lines

Add back in the finish page with ReleaseNotes and apcupsd.org link.

------------------------------------------------------------------------
r1384 | adk0212 | 2007-06-06 18:28:46 -0400 (Wed, 06 Jun 2007) | 2 lines

Increase sleep time to 2 seconds. 1 second was borderline.

------------------------------------------------------------------------
r1383 | adk0212 | 2007-06-05 20:42:45 -0400 (Tue, 05 Jun 2007) | 3 lines

More start/stop rework. Add new common.nsh file to be shared between
normal and uninstall context.

------------------------------------------------------------------------
r1382 | adk0212 | 2007-06-05 20:41:41 -0400 (Tue, 05 Jun 2007) | 3 lines

Fix refresh again. Pretty soon I am going to run out of ways to screw this
up.

------------------------------------------------------------------------
r1381 | adk0212 | 2007-06-05 18:43:24 -0400 (Tue, 05 Jun 2007) | 3 lines

Many more installer updates. Move static text to page .ini files. Add code
to handle polite start/stop of apcupsd and apctray.

------------------------------------------------------------------------
r1380 | adk0212 | 2007-06-05 18:39:37 -0400 (Tue, 05 Jun 2007) | 4 lines

Maintain a registry flag to indicate if apcupsd is installed as a service.
This used to be done by the installer, but would get out of sync if the
user ran 'apcupsd /install' by hand.

------------------------------------------------------------------------
r1379 | adk0212 | 2007-06-05 18:34:29 -0400 (Tue, 05 Jun 2007) | 4 lines

Maintain a registry flag to indicate if apcupsd is installed as a service.
This used to be done by the installer, but would get out of sync if the
user ran 'apcupsd /install' by hand.

------------------------------------------------------------------------
r1378 | adk0212 | 2007-06-05 18:33:06 -0400 (Tue, 05 Jun 2007) | 4 lines

When installing, only add command line parameters if they were supplied by
the user. Do not add them when using default settings. Also fix bug where
default refresh was 1000 seconds (should be 1 second).

------------------------------------------------------------------------
r1377 | adk0212 | 2007-06-03 22:38:26 -0400 (Sun, 03 Jun 2007) | 2 lines

Add custom page for installing Apctray and configuring its parameters.

------------------------------------------------------------------------
r1376 | adk0212 | 2007-06-03 13:05:20 -0400 (Sun, 03 Jun 2007) | 3 lines

Add custom page for installing apcupsd as a service and optionally
starting it instead of using popup dialogs during file install.

------------------------------------------------------------------------
r1375 | adk0212 | 2007-06-03 13:04:28 -0400 (Sun, 03 Jun 2007) | 2 lines

Add definition for edit apcupsd.conf custom page.

------------------------------------------------------------------------
r1374 | adk0212 | 2007-06-03 12:38:26 -0400 (Sun, 03 Jun 2007) | 2 lines

Suppress service-already-exists errors when in quiet mode.

------------------------------------------------------------------------
r1373 | adk0212 | 2007-06-03 12:31:53 -0400 (Sun, 03 Jun 2007) | 3 lines

Move GetArg() to common library and use it from winmain and apctray.
Add /quiet switch to winmain to suppress /install and /remove dialogs.

------------------------------------------------------------------------
r1372 | adk0212 | 2007-06-03 11:35:21 -0400 (Sun, 03 Jun 2007) | 3 lines

Add custom installer page for editing apcupsd.conf instead of using a
popup during file installation.

------------------------------------------------------------------------
r1371 | adk0212 | 2007-06-02 23:48:54 -0400 (Sat, 02 Jun 2007) | 2 lines

Update NSIS to 2.27 for better x64 compatibility.

------------------------------------------------------------------------
r1370 | adk0212 | 2007-06-02 23:48:23 -0400 (Sat, 02 Jun 2007) | 3 lines

Updates for apctray. Create -Startup and -Finish hidden sections for
common operations.

------------------------------------------------------------------------
r1369 | adk0212 | 2007-06-02 23:45:27 -0400 (Sat, 02 Jun 2007) | 2 lines

Tweak spacing in GetAll() to match apcaccess format for longer keys.

------------------------------------------------------------------------
r1368 | adk0212 | 2007-06-02 23:24:15 -0400 (Sat, 02 Jun 2007) | 2 lines

Add /kill command line option for shutting down apctray instance.

------------------------------------------------------------------------
r1367 | adk0212 | 2007-06-02 19:07:11 -0400 (Sat, 02 Jun 2007) | 2 lines

Update window name used by popup.exe so it finds apctray now.

------------------------------------------------------------------------
r1366 | adk0212 | 2007-06-02 18:57:02 -0400 (Sat, 02 Jun 2007) | 5 lines

Rework sprintf_realloc_append() to account for the fact that on Win98
vsnprintf() returns -1 if the string will not fit rather than the number
of characters required. Argh. Also remove unnecessary UpdateTrayIcon()
calls from wintray.c.

------------------------------------------------------------------------
r1365 | adk0212 | 2007-06-02 18:22:48 -0400 (Sat, 02 Jun 2007) | 3 lines

Add menu option to remove apctray from registry. All well-behaved tray
applets should have this!

------------------------------------------------------------------------
r1364 | adk0212 | 2007-06-02 18:04:10 -0400 (Sat, 02 Jun 2007) | 3 lines

Add command line options to install and remove apctray from autorun list
in the registry.

------------------------------------------------------------------------
r1363 | adk0212 | 2007-06-02 17:34:04 -0400 (Sat, 02 Jun 2007) | 2 lines

Add support for setting host, port, and refresh interval via command line.

------------------------------------------------------------------------
r1362 | adk0212 | 2007-06-02 16:28:46 -0400 (Sat, 02 Jun 2007) | 2 lines

Update about box.

------------------------------------------------------------------------
r1361 | adk0212 | 2007-06-02 15:22:41 -0400 (Sat, 02 Jun 2007) | 4 lines

Move status polling to a thread instead of a timer so we don't block the
message loop while updating status. This fixes the annoying pauses in GUI
response. More misc cleanups and small bug fixes.

------------------------------------------------------------------------
r1360 | adk0212 | 2007-06-02 13:46:29 -0400 (Sat, 02 Jun 2007) | 2 lines

Misc fixes. apctray is working now.

------------------------------------------------------------------------
r1359 | adk0212 | 2007-06-02 13:23:00 -0400 (Sat, 02 Jun 2007) | 4 lines

More refactoring. Add StatMgr class to handle fetching stats from the UPS
using NIS. Kill global variables and move global stats and events code to
their proper classes.

------------------------------------------------------------------------
r1358 | adk0212 | 2007-06-02 11:12:44 -0400 (Sat, 02 Jun 2007) | 2 lines

Move modified tray menu code back to wintray.cpp. Misc cleanups to wintray.

------------------------------------------------------------------------
r1357 | adk0212 | 2007-06-01 20:12:56 -0400 (Fri, 01 Jun 2007) | 2 lines

Cleanup of winabout, winevents, and winstat. Everthing compiles again.

------------------------------------------------------------------------
r1356 | adk0212 | 2007-05-31 20:11:52 -0400 (Thu, 31 May 2007) | 7 lines

First step of major win32 service and tray icon code refactor/rewrite.
This is part of the changes necessary for tray icon support on Vista.
Clean up winservice and winmain. Eliminate lots of unused code.
Simplify code where possible. Remove tray icon code from apcupsd itself.
Add apctray.cpp for standalone tray icon module designed to gather status
via NIS.

------------------------------------------------------------------------
r1355 | adk0212 | 2007-05-31 20:11:26 -0400 (Thu, 31 May 2007) | 2 lines

Remove OpenGL and DirectX libraries, as they are not needed for Apcupsd.

------------------------------------------------------------------------
r1353 | fleetworks | 2007-05-28 07:03:11 -0400 (Mon, 28 May 2007) | 2 lines

RHEL5 update.

------------------------------------------------------------------------
r1352 | adk0212 | 2007-05-27 13:20:34 -0400 (Sun, 27 May 2007) | 2 lines

Add rhel5 to contrib-rpm.

------------------------------------------------------------------------
r1351 | adk0212 | 2007-05-27 13:17:02 -0400 (Sun, 27 May 2007) | 2 lines

Fix changelog copy-n-paste error.

------------------------------------------------------------------------
r1350 | adk0212 | 2007-05-27 13:15:59 -0400 (Sun, 27 May 2007) | 2 lines

Add rhel5 support in spec.

------------------------------------------------------------------------
r1349 | adk0212 | 2007-05-26 15:07:12 -0400 (Sat, 26 May 2007) | 2 lines

Update website for 3.14.1 release.

------------------------------------------------------------------------
r1347 | adk0212 | 2007-05-04 19:18:47 -0400 (Fri, 04 May 2007) | 2 lines

Update ChangeLog.

------------------------------------------------------------------------
r1346 | adk0212 | 2007-05-04 19:17:00 -0400 (Fri, 04 May 2007) | 2 lines

Maybe this time...

------------------------------------------------------------------------
r1345 | adk0212 | 2007-05-03 18:31:47 -0400 (Thu, 03 May 2007) | 5 lines

Do not attempt to cancel shutdowns. Once a shutdown has been started there
is no way to cleanly stop it and recover. Plus deleting the powerfail file
causes killpower to be skipped, leaving the server shutdown and not
restarted. Reported by Yvon Lafaille <yvon.lafaille@yahoo.fr>.

------------------------------------------------------------------------
r1344 | adk0212 | 2007-05-01 20:26:52 -0400 (Tue, 01 May 2007) | 10 lines

Rewrite device opening logic. The new logic works as follows:
   - If user specifies a DEVICE, we will open that device and that device
     only. There is no fallback to autodetect. This is generaly what users
     expect when they explicitly give DEVICE.
   - If no DEVICE is specified, we autodetect as before. Furthermore, if
     we lose the connection to the device, we prefer to re-open the same
     device again, but will restart autodetection if that fails.
   - If DEVICE is specified using the deprecated '[]' syntax, just do
     normal autodetection as if DEVICE had not been specified at all.

------------------------------------------------------------------------
r1343 | adk0212 | 2007-04-30 22:14:13 -0400 (Mon, 30 Apr 2007) | 2 lines

Disable a few CIs that SNMP cards do not support.

------------------------------------------------------------------------
r1342 | adk0212 | 2007-04-30 21:37:55 -0400 (Mon, 30 Apr 2007) | 3 lines

Increase self-test timeout to 40 seconds to accomodate the RS 800.
Contributed by Lars Randers <lars@nstec.dk>.

------------------------------------------------------------------------
r1341 | adk0212 | 2007-04-27 19:30:31 -0400 (Fri, 27 Apr 2007) | 5 lines

Fix apctest crash. When in the EEPROM programming section of apctest, if
you try to print EEPROM values (item 1) more than once during the same
session, the program segfaults.
Contributed by Ivaylo Haratcherev <I.J.Haratcherev@tudelft.nl>.

------------------------------------------------------------------------
r1340 | adk0212 | 2007-04-27 19:25:40 -0400 (Fri, 27 Apr 2007) | 2 lines

Normalize shut remote message.

------------------------------------------------------------------------
r1339 | adk0212 | 2007-04-27 19:24:26 -0400 (Fri, 27 Apr 2007) | 4 lines

Add support for PCNET remote shutdown (SD) signal. Contributed by Ivaylo
Haratcherev <I.J.Haratcherev@tudelft.nl> and Moshe Hyzon
<moshe.hyzon@grantstreet.com>.

------------------------------------------------------------------------
r1338 | adk0212 | 2007-04-23 19:47:58 -0400 (Mon, 23 Apr 2007) | 2 lines

Rev ChangeLog.

------------------------------------------------------------------------
r1337 | adk0212 | 2007-04-23 19:45:24 -0400 (Mon, 23 Apr 2007) | 2 lines

Did I say "final"?

------------------------------------------------------------------------
r1336 | adk0212 | 2007-04-23 19:37:52 -0400 (Mon, 23 Apr 2007) | 3 lines

Fix typo in error message.
Reported by Ashley M. Kirchner <ashley@pcraft.com>

------------------------------------------------------------------------
r1335 | adk0212 | 2007-04-23 19:35:33 -0400 (Mon, 23 Apr 2007) | 7 lines

Update to match Fedora Extras packaging:
  - Add "force-reload" aliased to "restart"
  - "reload" outputs a not implemented error
  - "status" uses the status() function to return the proper LSB status
     code and runs apcaccess only if the daemon is running.
Contributed by Orion Poplawski <orion@cora.nwra.com>.

------------------------------------------------------------------------
r1334 | adk0212 | 2007-04-21 20:37:23 -0400 (Sat, 21 Apr 2007) | 2 lines

Update ChangeLog for 3.14.1 (again).

------------------------------------------------------------------------
r1333 | adk0212 | 2007-04-21 20:35:15 -0400 (Sat, 21 Apr 2007) | 2 lines

Final updates for 3.14.1.

------------------------------------------------------------------------
r1332 | adk0212 | 2007-04-21 20:24:56 -0400 (Sat, 21 Apr 2007) | 2 lines

Clarify FreeBSD versions in USB kernel section.

------------------------------------------------------------------------
r1331 | adk0212 | 2007-04-21 19:59:46 -0400 (Sat, 21 Apr 2007) | 3 lines

Add USB info for NetBSD 4.x (ugen binding can be forced on a particular
port). Contributed by Curt Sampson <cjs@starling-software.com>.

------------------------------------------------------------------------
r1330 | adk0212 | 2007-04-21 19:27:47 -0400 (Sat, 21 Apr 2007) | 3 lines

Fix link error with --disable-apcsmart (getline missing).
Reported by Ashley M. Kirchner <ashley@pcraft.com>

------------------------------------------------------------------------
r1329 | adk0212 | 2007-04-18 19:33:19 -0400 (Wed, 18 Apr 2007) | 2 lines

Updated changelog for 3.14.1.

------------------------------------------------------------------------
r1328 | adk0212 | 2007-04-18 19:30:48 -0400 (Wed, 18 Apr 2007) | 2 lines

Prep for 3.14.1 release.

------------------------------------------------------------------------
r1327 | adk0212 | 2007-03-25 15:38:39 -0400 (Sun, 25 Mar 2007) | 4 lines

Prevent infinite hang in read_nbytes() when server disappears.
Many thanks to Jan Ceuleers <jan.ceuleers@computer.org> for reporting the
hanging and gathering data to track down the cause.

------------------------------------------------------------------------
r1326 | adk0212 | 2007-03-25 15:34:02 -0400 (Sun, 25 Mar 2007) | 2 lines

Remove references to int8_t and int16_t.

------------------------------------------------------------------------
r1325 | adk0212 | 2007-03-05 22:41:46 -0500 (Mon, 05 Mar 2007) | 2 lines

Kill stdint.h include since OpenBSD does not appear to have it.

------------------------------------------------------------------------
r1324 | adk0212 | 2007-03-03 16:40:44 -0500 (Sat, 03 Mar 2007) | 2 lines

Hey, genius... Archive foo.bar.in, not foo.bar.

------------------------------------------------------------------------
r1323 | adk0212 | 2007-03-03 16:28:03 -0500 (Sat, 03 Mar 2007) | 2 lines

Regen with Mac OS X installer changes.

------------------------------------------------------------------------
r1322 | adk0212 | 2007-03-03 16:23:42 -0500 (Sat, 03 Mar 2007) | 2 lines

Add binary installer support for Mac OS X.

------------------------------------------------------------------------
r1321 | adk0212 | 2007-02-17 12:02:00 -0500 (Sat, 17 Feb 2007) | 3 lines

Add missing newline at end of file.
Discovered by Sergey Y. Afonin <asy@kraft-s.ru>.

------------------------------------------------------------------------
r1320 | adk0212 | 2007-02-17 12:00:50 -0500 (Sat, 17 Feb 2007) | 3 lines

Fix typo: "%sbindir\%popup" -> "%sbindir%\popup"
Discovered by Stefan.Hegnauer@elektrobit.com.

------------------------------------------------------------------------
r1319 | adk0212 | 2007-02-13 19:02:55 -0500 (Tue, 13 Feb 2007) | 3 lines

Detect when balloon tips have been disabled via a group policy and fall
back on the standard popup message box.

------------------------------------------------------------------------
r1318 | (no author) | 2007-02-11 10:33:33 -0500 (Sun, 11 Feb 2007) | 1 line

This commit was manufactured by cvs2svn to create branch 'Branch-3_14'.
------------------------------------------------------------------------
